{
  "address": "0x7Da3E054DDf73071889A43ce22bcB714b6623dac",
  "abi": [
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "available",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "required",
          "type": "uint256"
        }
      ],
      "name": "InsufficientBalance",
      "type": "error"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "participant",
          "type": "address"
        },
        {
          "indexed": true,
          "internalType": "bool",
          "name": "enabled",
          "type": "bool"
        }
      ],
      "name": "OnAutoPayToggled",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "beneficiary",
          "type": "address"
        }
      ],
      "name": "OnBeneficiaryAwarded",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "currentCycle",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "expellant",
          "type": "address"
        }
      ],
      "name": "OnDefaulterExpelled",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "currentCycle",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "enum LibFundStorage.FundStates",
          "name": "newState",
          "type": "uint8"
        }
      ],
      "name": "OnFundStateChanged",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "claimant",
          "type": "address"
        },
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "amount",
          "type": "uint256"
        }
      ],
      "name": "OnFundWithdrawn",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "payer",
          "type": "address"
        },
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "currentCycle",
          "type": "uint256"
        }
      ],
      "name": "OnPaidContribution",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "currentCycle",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "defaulter",
          "type": "address"
        }
      ],
      "name": "OnParticipantDefaulted",
      "type": "event"
    },
    {
      "inputs": [],
      "name": "FUND_VERSION",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        }
      ],
      "name": "closeFundingPeriod",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        }
      ],
      "name": "emptyFundAfterEnd",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "internalType": "address",
          "name": "beneficiary",
          "type": "address"
        }
      ],
      "name": "isBeneficiary",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        }
      ],
      "name": "payContribution",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "internalType": "address",
          "name": "participant",
          "type": "address"
        }
      ],
      "name": "payContributionOnBehalfOf",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        }
      ],
      "name": "startNewCycle",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        }
      ],
      "name": "toggleAutoPay",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        }
      ],
      "name": "withdrawFund",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    }
  ],
  "transactionHash": "0x992ce9bac07b10a5a0c1784e594d2b4c652b89a06b93f7b9321f859b1076f19e",
  "receipt": {
    "to": "0x4e59b44847b379578588920cA78FbF26c0B4956C",
    "from": "0x3904F59DF9199e0d6dC3800af9f6794c9D037eb1",
    "contractAddress": null,
    "transactionIndex": 2,
    "gasUsed": "2261777",
    "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    "blockHash": "0x7ee85b12665f130669a37bf31e09844114a1d5d50852c1b8701a7f7fc607459e",
    "transactionHash": "0x992ce9bac07b10a5a0c1784e594d2b4c652b89a06b93f7b9321f859b1076f19e",
    "logs": [],
    "blockNumber": 46031563,
    "cumulativeGasUsed": "2333853",
    "status": 1,
    "byzantium": true
  },
  "args": [],
  "numDeployments": 6,
  "solcInputHash": "547ed487077baaa27d0cf9646aec8b31",
  "metadata": "{\"compiler\":{\"version\":\"0.8.18+commit.87f61d96\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"available\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"required\",\"type\":\"uint256\"}],\"name\":\"InsufficientBalance\",\"type\":\"error\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"participant\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"bool\",\"name\":\"enabled\",\"type\":\"bool\"}],\"name\":\"OnAutoPayToggled\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"beneficiary\",\"type\":\"address\"}],\"name\":\"OnBeneficiaryAwarded\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"currentCycle\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"expellant\",\"type\":\"address\"}],\"name\":\"OnDefaulterExpelled\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"currentCycle\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"enum LibFundStorage.FundStates\",\"name\":\"newState\",\"type\":\"uint8\"}],\"name\":\"OnFundStateChanged\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"claimant\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"OnFundWithdrawn\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"payer\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"currentCycle\",\"type\":\"uint256\"}],\"name\":\"OnPaidContribution\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"currentCycle\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"defaulter\",\"type\":\"address\"}],\"name\":\"OnParticipantDefaulted\",\"type\":\"event\"},{\"inputs\":[],\"name\":\"FUND_VERSION\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"}],\"name\":\"closeFundingPeriod\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"}],\"name\":\"emptyFundAfterEnd\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"beneficiary\",\"type\":\"address\"}],\"name\":\"isBeneficiary\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"}],\"name\":\"payContribution\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"participant\",\"type\":\"address\"}],\"name\":\"payContributionOnBehalfOf\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"}],\"name\":\"startNewCycle\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"}],\"name\":\"toggleAutoPay\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"}],\"name\":\"withdrawFund\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}],\"devdoc\":{\"author\":\"Mohammed Haddouti\",\"details\":\"v3.0 (Diamond)\",\"errors\":{\"InsufficientBalance(uint256,uint256)\":[{\"params\":{\"available\":\"balance available.\",\"required\":\"requested amount to transfer.\"}}]},\"kind\":\"dev\",\"methods\":{\"closeFundingPeriod(uint256)\":{\"params\":{\"termId\":\"the id of the term\"}},\"emptyFundAfterEnd(uint256)\":{\"params\":{\"termId\":\"the id of the term\"}},\"isBeneficiary(uint256,address)\":{\"params\":{\"beneficiary\":\"the address of the participant to check\",\"termId\":\"the id of the term\"},\"returns\":{\"_0\":\"true if the participant is a beneficiary\"}},\"payContribution(uint256)\":{\"params\":{\"termId\":\"the id of the term\"}},\"payContributionOnBehalfOf(uint256,address)\":{\"params\":{\"participant\":\"the address the msg.sender is paying for, the address must be part of the fund\",\"termId\":\"the id of the term\"}},\"startNewCycle(uint256)\":{\"params\":{\"termId\":\"the id of the term\"}},\"toggleAutoPay(uint256)\":{\"params\":{\"termId\":\"the id of the term\"}},\"withdrawFund(uint256)\":{\"details\":\"This follows the pull-over-push pattern.\",\"params\":{\"termId\":\"the id of the term\"}}},\"title\":\"Takaturn Fund\",\"version\":1},\"userdoc\":{\"errors\":{\"InsufficientBalance(uint256,uint256)\":[{\"notice\":\"Insufficient balance for transfer. Needed `required` but only `available` available.\"}]},\"kind\":\"user\",\"methods\":{\"closeFundingPeriod(uint256)\":{\"notice\":\"Must be called at the end of the contribution period after the time has passed by the owner\"},\"emptyFundAfterEnd(uint256)\":{\"notice\":\"allow the owner to empty the fund if there's any excess fund left after 180 days,         this with the assumption that beneficiaries can't claim it themselves due to losing their keys for example,         and prevent the fund to be stuck in limbo\"},\"payContribution(uint256)\":{\"notice\":\"This is the function participants call to pay the contribution\"},\"payContributionOnBehalfOf(uint256,address)\":{\"notice\":\"This function is here to give the possibility to pay using a different wallet\"},\"startNewCycle(uint256)\":{\"notice\":\"starts a new cycle manually called by the owner. Only the first cycle starts automatically upon deploy\"},\"toggleAutoPay(uint256)\":{\"notice\":\"function to enable/disable autopay\"},\"withdrawFund(uint256)\":{\"notice\":\"Called by the beneficiary to withdraw the fund\"}},\"notice\":\"This is used to operate the Takaturn fund\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/facets/FundFacet.sol\":\"FundFacet\"},\"evmVersion\":\"paris\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\",\"useLiteralContent\":true},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[]},\"sources\":{\"@openzeppelin/contracts/token/ERC20/IERC20.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/IERC20.sol)\\n\\npragma solidity ^0.8.0;\\n\\n/**\\n * @dev Interface of the ERC20 standard as defined in the EIP.\\n */\\ninterface IERC20 {\\n    /**\\n     * @dev Emitted when `value` tokens are moved from one account (`from`) to\\n     * another (`to`).\\n     *\\n     * Note that `value` may be zero.\\n     */\\n    event Transfer(address indexed from, address indexed to, uint256 value);\\n\\n    /**\\n     * @dev Emitted when the allowance of a `spender` for an `owner` is set by\\n     * a call to {approve}. `value` is the new allowance.\\n     */\\n    event Approval(address indexed owner, address indexed spender, uint256 value);\\n\\n    /**\\n     * @dev Returns the amount of tokens in existence.\\n     */\\n    function totalSupply() external view returns (uint256);\\n\\n    /**\\n     * @dev Returns the amount of tokens owned by `account`.\\n     */\\n    function balanceOf(address account) external view returns (uint256);\\n\\n    /**\\n     * @dev Moves `amount` tokens from the caller's account to `to`.\\n     *\\n     * Returns a boolean value indicating whether the operation succeeded.\\n     *\\n     * Emits a {Transfer} event.\\n     */\\n    function transfer(address to, uint256 amount) external returns (bool);\\n\\n    /**\\n     * @dev Returns the remaining number of tokens that `spender` will be\\n     * allowed to spend on behalf of `owner` through {transferFrom}. This is\\n     * zero by default.\\n     *\\n     * This value changes when {approve} or {transferFrom} are called.\\n     */\\n    function allowance(address owner, address spender) external view returns (uint256);\\n\\n    /**\\n     * @dev Sets `amount` as the allowance of `spender` over the caller's tokens.\\n     *\\n     * Returns a boolean value indicating whether the operation succeeded.\\n     *\\n     * IMPORTANT: Beware that changing an allowance with this method brings the risk\\n     * that someone may use both the old and the new allowance by unfortunate\\n     * transaction ordering. One possible solution to mitigate this race\\n     * condition is to first reduce the spender's allowance to 0 and set the\\n     * desired value afterwards:\\n     * https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729\\n     *\\n     * Emits an {Approval} event.\\n     */\\n    function approve(address spender, uint256 amount) external returns (bool);\\n\\n    /**\\n     * @dev Moves `amount` tokens from `from` to `to` using the\\n     * allowance mechanism. `amount` is then deducted from the caller's\\n     * allowance.\\n     *\\n     * Returns a boolean value indicating whether the operation succeeded.\\n     *\\n     * Emits a {Transfer} event.\\n     */\\n    function transferFrom(address from, address to, uint256 amount) external returns (bool);\\n}\\n\",\"keccak256\":\"0x287b55befed2961a7eabd7d7b1b2839cbca8a5b80ef8dcbb25ed3d4c2002c305\",\"license\":\"MIT\"},\"@openzeppelin/contracts/utils/structs/EnumerableSet.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n// OpenZeppelin Contracts (last updated v4.9.0) (utils/structs/EnumerableSet.sol)\\n// This file was procedurally generated from scripts/generate/templates/EnumerableSet.js.\\n\\npragma solidity ^0.8.0;\\n\\n/**\\n * @dev Library for managing\\n * https://en.wikipedia.org/wiki/Set_(abstract_data_type)[sets] of primitive\\n * types.\\n *\\n * Sets have the following properties:\\n *\\n * - Elements are added, removed, and checked for existence in constant time\\n * (O(1)).\\n * - Elements are enumerated in O(n). No guarantees are made on the ordering.\\n *\\n * ```solidity\\n * contract Example {\\n *     // Add the library methods\\n *     using EnumerableSet for EnumerableSet.AddressSet;\\n *\\n *     // Declare a set state variable\\n *     EnumerableSet.AddressSet private mySet;\\n * }\\n * ```\\n *\\n * As of v3.3.0, sets of type `bytes32` (`Bytes32Set`), `address` (`AddressSet`)\\n * and `uint256` (`UintSet`) are supported.\\n *\\n * [WARNING]\\n * ====\\n * Trying to delete such a structure from storage will likely result in data corruption, rendering the structure\\n * unusable.\\n * See https://github.com/ethereum/solidity/pull/11843[ethereum/solidity#11843] for more info.\\n *\\n * In order to clean an EnumerableSet, you can either remove all elements one by one or create a fresh instance using an\\n * array of EnumerableSet.\\n * ====\\n */\\nlibrary EnumerableSet {\\n    // To implement this library for multiple types with as little code\\n    // repetition as possible, we write it in terms of a generic Set type with\\n    // bytes32 values.\\n    // The Set implementation uses private functions, and user-facing\\n    // implementations (such as AddressSet) are just wrappers around the\\n    // underlying Set.\\n    // This means that we can only create new EnumerableSets for types that fit\\n    // in bytes32.\\n\\n    struct Set {\\n        // Storage of set values\\n        bytes32[] _values;\\n        // Position of the value in the `values` array, plus 1 because index 0\\n        // means a value is not in the set.\\n        mapping(bytes32 => uint256) _indexes;\\n    }\\n\\n    /**\\n     * @dev Add a value to a set. O(1).\\n     *\\n     * Returns true if the value was added to the set, that is if it was not\\n     * already present.\\n     */\\n    function _add(Set storage set, bytes32 value) private returns (bool) {\\n        if (!_contains(set, value)) {\\n            set._values.push(value);\\n            // The value is stored at length-1, but we add 1 to all indexes\\n            // and use 0 as a sentinel value\\n            set._indexes[value] = set._values.length;\\n            return true;\\n        } else {\\n            return false;\\n        }\\n    }\\n\\n    /**\\n     * @dev Removes a value from a set. O(1).\\n     *\\n     * Returns true if the value was removed from the set, that is if it was\\n     * present.\\n     */\\n    function _remove(Set storage set, bytes32 value) private returns (bool) {\\n        // We read and store the value's index to prevent multiple reads from the same storage slot\\n        uint256 valueIndex = set._indexes[value];\\n\\n        if (valueIndex != 0) {\\n            // Equivalent to contains(set, value)\\n            // To delete an element from the _values array in O(1), we swap the element to delete with the last one in\\n            // the array, and then remove the last element (sometimes called as 'swap and pop').\\n            // This modifies the order of the array, as noted in {at}.\\n\\n            uint256 toDeleteIndex = valueIndex - 1;\\n            uint256 lastIndex = set._values.length - 1;\\n\\n            if (lastIndex != toDeleteIndex) {\\n                bytes32 lastValue = set._values[lastIndex];\\n\\n                // Move the last value to the index where the value to delete is\\n                set._values[toDeleteIndex] = lastValue;\\n                // Update the index for the moved value\\n                set._indexes[lastValue] = valueIndex; // Replace lastValue's index to valueIndex\\n            }\\n\\n            // Delete the slot where the moved value was stored\\n            set._values.pop();\\n\\n            // Delete the index for the deleted slot\\n            delete set._indexes[value];\\n\\n            return true;\\n        } else {\\n            return false;\\n        }\\n    }\\n\\n    /**\\n     * @dev Returns true if the value is in the set. O(1).\\n     */\\n    function _contains(Set storage set, bytes32 value) private view returns (bool) {\\n        return set._indexes[value] != 0;\\n    }\\n\\n    /**\\n     * @dev Returns the number of values on the set. O(1).\\n     */\\n    function _length(Set storage set) private view returns (uint256) {\\n        return set._values.length;\\n    }\\n\\n    /**\\n     * @dev Returns the value stored at position `index` in the set. O(1).\\n     *\\n     * Note that there are no guarantees on the ordering of values inside the\\n     * array, and it may change when more values are added or removed.\\n     *\\n     * Requirements:\\n     *\\n     * - `index` must be strictly less than {length}.\\n     */\\n    function _at(Set storage set, uint256 index) private view returns (bytes32) {\\n        return set._values[index];\\n    }\\n\\n    /**\\n     * @dev Return the entire set in an array\\n     *\\n     * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed\\n     * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that\\n     * this function has an unbounded cost, and using it as part of a state-changing function may render the function\\n     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.\\n     */\\n    function _values(Set storage set) private view returns (bytes32[] memory) {\\n        return set._values;\\n    }\\n\\n    // Bytes32Set\\n\\n    struct Bytes32Set {\\n        Set _inner;\\n    }\\n\\n    /**\\n     * @dev Add a value to a set. O(1).\\n     *\\n     * Returns true if the value was added to the set, that is if it was not\\n     * already present.\\n     */\\n    function add(Bytes32Set storage set, bytes32 value) internal returns (bool) {\\n        return _add(set._inner, value);\\n    }\\n\\n    /**\\n     * @dev Removes a value from a set. O(1).\\n     *\\n     * Returns true if the value was removed from the set, that is if it was\\n     * present.\\n     */\\n    function remove(Bytes32Set storage set, bytes32 value) internal returns (bool) {\\n        return _remove(set._inner, value);\\n    }\\n\\n    /**\\n     * @dev Returns true if the value is in the set. O(1).\\n     */\\n    function contains(Bytes32Set storage set, bytes32 value) internal view returns (bool) {\\n        return _contains(set._inner, value);\\n    }\\n\\n    /**\\n     * @dev Returns the number of values in the set. O(1).\\n     */\\n    function length(Bytes32Set storage set) internal view returns (uint256) {\\n        return _length(set._inner);\\n    }\\n\\n    /**\\n     * @dev Returns the value stored at position `index` in the set. O(1).\\n     *\\n     * Note that there are no guarantees on the ordering of values inside the\\n     * array, and it may change when more values are added or removed.\\n     *\\n     * Requirements:\\n     *\\n     * - `index` must be strictly less than {length}.\\n     */\\n    function at(Bytes32Set storage set, uint256 index) internal view returns (bytes32) {\\n        return _at(set._inner, index);\\n    }\\n\\n    /**\\n     * @dev Return the entire set in an array\\n     *\\n     * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed\\n     * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that\\n     * this function has an unbounded cost, and using it as part of a state-changing function may render the function\\n     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.\\n     */\\n    function values(Bytes32Set storage set) internal view returns (bytes32[] memory) {\\n        bytes32[] memory store = _values(set._inner);\\n        bytes32[] memory result;\\n\\n        /// @solidity memory-safe-assembly\\n        assembly {\\n            result := store\\n        }\\n\\n        return result;\\n    }\\n\\n    // AddressSet\\n\\n    struct AddressSet {\\n        Set _inner;\\n    }\\n\\n    /**\\n     * @dev Add a value to a set. O(1).\\n     *\\n     * Returns true if the value was added to the set, that is if it was not\\n     * already present.\\n     */\\n    function add(AddressSet storage set, address value) internal returns (bool) {\\n        return _add(set._inner, bytes32(uint256(uint160(value))));\\n    }\\n\\n    /**\\n     * @dev Removes a value from a set. O(1).\\n     *\\n     * Returns true if the value was removed from the set, that is if it was\\n     * present.\\n     */\\n    function remove(AddressSet storage set, address value) internal returns (bool) {\\n        return _remove(set._inner, bytes32(uint256(uint160(value))));\\n    }\\n\\n    /**\\n     * @dev Returns true if the value is in the set. O(1).\\n     */\\n    function contains(AddressSet storage set, address value) internal view returns (bool) {\\n        return _contains(set._inner, bytes32(uint256(uint160(value))));\\n    }\\n\\n    /**\\n     * @dev Returns the number of values in the set. O(1).\\n     */\\n    function length(AddressSet storage set) internal view returns (uint256) {\\n        return _length(set._inner);\\n    }\\n\\n    /**\\n     * @dev Returns the value stored at position `index` in the set. O(1).\\n     *\\n     * Note that there are no guarantees on the ordering of values inside the\\n     * array, and it may change when more values are added or removed.\\n     *\\n     * Requirements:\\n     *\\n     * - `index` must be strictly less than {length}.\\n     */\\n    function at(AddressSet storage set, uint256 index) internal view returns (address) {\\n        return address(uint160(uint256(_at(set._inner, index))));\\n    }\\n\\n    /**\\n     * @dev Return the entire set in an array\\n     *\\n     * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed\\n     * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that\\n     * this function has an unbounded cost, and using it as part of a state-changing function may render the function\\n     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.\\n     */\\n    function values(AddressSet storage set) internal view returns (address[] memory) {\\n        bytes32[] memory store = _values(set._inner);\\n        address[] memory result;\\n\\n        /// @solidity memory-safe-assembly\\n        assembly {\\n            result := store\\n        }\\n\\n        return result;\\n    }\\n\\n    // UintSet\\n\\n    struct UintSet {\\n        Set _inner;\\n    }\\n\\n    /**\\n     * @dev Add a value to a set. O(1).\\n     *\\n     * Returns true if the value was added to the set, that is if it was not\\n     * already present.\\n     */\\n    function add(UintSet storage set, uint256 value) internal returns (bool) {\\n        return _add(set._inner, bytes32(value));\\n    }\\n\\n    /**\\n     * @dev Removes a value from a set. O(1).\\n     *\\n     * Returns true if the value was removed from the set, that is if it was\\n     * present.\\n     */\\n    function remove(UintSet storage set, uint256 value) internal returns (bool) {\\n        return _remove(set._inner, bytes32(value));\\n    }\\n\\n    /**\\n     * @dev Returns true if the value is in the set. O(1).\\n     */\\n    function contains(UintSet storage set, uint256 value) internal view returns (bool) {\\n        return _contains(set._inner, bytes32(value));\\n    }\\n\\n    /**\\n     * @dev Returns the number of values in the set. O(1).\\n     */\\n    function length(UintSet storage set) internal view returns (uint256) {\\n        return _length(set._inner);\\n    }\\n\\n    /**\\n     * @dev Returns the value stored at position `index` in the set. O(1).\\n     *\\n     * Note that there are no guarantees on the ordering of values inside the\\n     * array, and it may change when more values are added or removed.\\n     *\\n     * Requirements:\\n     *\\n     * - `index` must be strictly less than {length}.\\n     */\\n    function at(UintSet storage set, uint256 index) internal view returns (uint256) {\\n        return uint256(_at(set._inner, index));\\n    }\\n\\n    /**\\n     * @dev Return the entire set in an array\\n     *\\n     * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed\\n     * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that\\n     * this function has an unbounded cost, and using it as part of a state-changing function may render the function\\n     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.\\n     */\\n    function values(UintSet storage set) internal view returns (uint256[] memory) {\\n        bytes32[] memory store = _values(set._inner);\\n        uint256[] memory result;\\n\\n        /// @solidity memory-safe-assembly\\n        assembly {\\n            result := store\\n        }\\n\\n        return result;\\n    }\\n}\\n\",\"keccak256\":\"0x9f4357008a8f7d8c8bf5d48902e789637538d8c016be5766610901b4bba81514\",\"license\":\"MIT\"},\"contracts/facets/FundFacet.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0\\r\\n\\r\\npragma solidity 0.8.18;\\r\\n\\r\\nimport {IERC20} from \\\"@openzeppelin/contracts/token/ERC20/IERC20.sol\\\";\\r\\nimport {IFund} from \\\"../interfaces/IFund.sol\\\";\\r\\nimport {ICollateral} from \\\"../interfaces/ICollateral.sol\\\";\\r\\nimport {IGetters} from \\\"../interfaces/IGetters.sol\\\";\\r\\n\\r\\nimport {EnumerableSet} from \\\"@openzeppelin/contracts/utils/structs/EnumerableSet.sol\\\";\\r\\nimport {LibCollateralStorage} from \\\"../libraries/LibCollateralStorage.sol\\\";\\r\\nimport {LibFundStorage} from \\\"../libraries/LibFundStorage.sol\\\";\\r\\nimport {LibTermStorage} from \\\"../libraries/LibTermStorage.sol\\\";\\r\\nimport {LibCollateral} from \\\"../libraries/LibCollateral.sol\\\";\\r\\nimport {LibTermOwnership} from \\\"../libraries/LibTermOwnership.sol\\\";\\r\\nimport {LibFund} from \\\"../libraries/LibFund.sol\\\";\\r\\n\\r\\n/// @title Takaturn Fund\\r\\n/// @author Mohammed Haddouti\\r\\n/// @notice This is used to operate the Takaturn fund\\r\\n/// @dev v3.0 (Diamond)\\r\\ncontract FundFacet is IFund {\\r\\n    using EnumerableSet for EnumerableSet.AddressSet;\\r\\n\\r\\n    uint public constant FUND_VERSION = 2; // The version of the contract\\r\\n\\r\\n    event OnFundStateChanged(\\r\\n        uint indexed termId,\\r\\n        uint indexed currentCycle,\\r\\n        LibFundStorage.FundStates indexed newState\\r\\n    ); // Emits when state has updated\\r\\n    event OnPaidContribution(uint indexed termId, address indexed payer, uint indexed currentCycle); // Emits when participant pays the contribution\\r\\n    event OnBeneficiaryAwarded(uint indexed termId, address indexed beneficiary); // Emits when beneficiary is selected for this cycle\\r\\n    event OnFundWithdrawn(uint indexed termId, address indexed claimant, uint indexed amount); // Emits when a chosen beneficiary claims their fund\\r\\n    event OnParticipantDefaulted(\\r\\n        uint indexed termId,\\r\\n        uint indexed currentCycle,\\r\\n        address indexed defaulter\\r\\n    ); // Emits when a participant didn't pay this cycle's contribution\\r\\n    event OnDefaulterExpelled(\\r\\n        uint indexed termId,\\r\\n        uint indexed currentCycle,\\r\\n        address indexed expellant\\r\\n    ); // Emits when a defaulter can't compensate with the collateral\\r\\n    event OnAutoPayToggled(uint indexed termId, address indexed participant, bool indexed enabled); // Emits when a participant succesfully toggles autopay\\r\\n\\r\\n    modifier onlyTermOwner(uint termId) {\\r\\n        LibTermOwnership._ensureTermOwner(termId);\\r\\n        _;\\r\\n    }\\r\\n\\r\\n    /// Insufficient balance for transfer. Needed `required` but only\\r\\n    /// `available` available.\\r\\n    /// @param available balance available.\\r\\n    /// @param required requested amount to transfer.\\r\\n    error InsufficientBalance(uint available, uint required);\\r\\n\\r\\n    /// @notice starts a new cycle manually called by the owner. Only the first cycle starts automatically upon deploy\\r\\n    /// @param termId the id of the term\\r\\n    function startNewCycle(uint termId) external {\\r\\n        LibFund._startNewCycle(termId);\\r\\n    }\\r\\n\\r\\n    /// @notice Must be called at the end of the contribution period after the time has passed by the owner\\r\\n    /// @param termId the id of the term\\r\\n    function closeFundingPeriod(uint termId) external {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[termId];\\r\\n        LibTermStorage.Term storage term = LibTermStorage._termStorage().terms[termId];\\r\\n        // Current cycle minus 1 because we use the previous cycle time as start point then  add contribution period\\r\\n        require(\\r\\n            block.timestamp >\\r\\n                term.cycleTime * (fund.currentCycle - 1) + fund.fundStart + term.contributionPeriod,\\r\\n            \\\"Still time to contribute\\\"\\r\\n        );\\r\\n        require(\\r\\n            fund.currentState == LibFundStorage.FundStates.AcceptingContributions,\\r\\n            \\\"Wrong state\\\"\\r\\n        );\\r\\n\\r\\n        address currentBeneficiary = IGetters(address(this)).getCurrentBeneficiary(termId);\\r\\n\\r\\n        // We attempt to make the autopayers pay their contribution right away\\r\\n        LibFund._autoPay(termId);\\r\\n\\r\\n        // Only then award the beneficiary\\r\\n        LibFund._setState(termId, LibFundStorage.FundStates.AwardingBeneficiary);\\r\\n\\r\\n        // We must check who hasn't paid and default them, check all participants based on beneficiariesOrder\\r\\n        address[] memory participants = fund.beneficiariesOrder;\\r\\n\\r\\n        uint participantsLength = participants.length;\\r\\n        uint currentCycle = fund.currentCycle;\\r\\n        for (uint i; i < participantsLength; ) {\\r\\n            address p = participants[i];\\r\\n\\r\\n            // The current beneficiary or someone who is exempt doesn't pay neither gets defaulted\\r\\n            if (p == currentBeneficiary || fund.isExemptedOnCycle[currentCycle].exempted[p]) {\\r\\n                unchecked {\\r\\n                    ++i;\\r\\n                }\\r\\n                continue;\\r\\n            }\\r\\n\\r\\n            if (fund.paidThisCycle[p]) {\\r\\n                // check where to restore the defaulter to, participants or beneficiaries\\r\\n                if (fund.isBeneficiary[p]) {\\r\\n                    EnumerableSet.add(fund._beneficiaries, p);\\r\\n                } else {\\r\\n                    EnumerableSet.add(fund._participants, p);\\r\\n                }\\r\\n\\r\\n                EnumerableSet.remove(fund._defaulters, p);\\r\\n            } else if (!EnumerableSet.contains(fund._defaulters, p)) {\\r\\n                // And we make sure that existing defaulters are ignored\\r\\n                // If the current beneficiary is an expelled participant, only check previous beneficiaries\\r\\n                if (IGetters(address(this)).wasExpelled(termId, currentBeneficiary)) {\\r\\n                    if (fund.isBeneficiary[p]) {\\r\\n                        _defaultParticipant(termId, p);\\r\\n                    }\\r\\n                } else {\\r\\n                    _defaultParticipant(termId, p);\\r\\n                }\\r\\n            }\\r\\n            unchecked {\\r\\n                ++i;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        // Once we decided who defaulted and who paid, we can award the beneficiary for this cycle\\r\\n        _awardBeneficiary(fund, term);\\r\\n        if (!(fund.currentCycle < fund.totalAmountOfCycles)) {\\r\\n            // If all cycles have passed, and the last cycle's time has passed, close the fund\\r\\n            _closeFund(termId);\\r\\n            return;\\r\\n        }\\r\\n    }\\r\\n\\r\\n    /// @notice allow the owner to empty the fund if there's any excess fund left after 180 days,\\r\\n    ///         this with the assumption that beneficiaries can't claim it themselves due to losing their keys for example,\\r\\n    ///         and prevent the fund to be stuck in limbo\\r\\n    /// @param termId the id of the term\\r\\n    function emptyFundAfterEnd(uint termId) external onlyTermOwner(termId) {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[termId];\\r\\n        require(\\r\\n            fund.currentState == LibFundStorage.FundStates.FundClosed &&\\r\\n                block.timestamp > fund.fundEnd + 180 days,\\r\\n            \\\"Can't empty yet\\\"\\r\\n        );\\r\\n\\r\\n        uint balance;\\r\\n        uint beneficiariesLength = fund.beneficiariesOrder.length;\\r\\n\\r\\n        for (uint i; i < beneficiariesLength; ) {\\r\\n            if (fund.beneficiariesPool[fund.beneficiariesOrder[i]] > 0) {\\r\\n                balance += fund.beneficiariesPool[fund.beneficiariesOrder[i]];\\r\\n                fund.beneficiariesPool[fund.beneficiariesOrder[i]] = 0;\\r\\n            }\\r\\n            unchecked {\\r\\n                ++i;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        if (balance > 0) {\\r\\n            bool success = fund.stableToken.transfer(msg.sender, balance);\\r\\n            require(success, \\\"Transfer failed\\\");\\r\\n        }\\r\\n    }\\r\\n\\r\\n    /// @notice function to enable/disable autopay\\r\\n    /// @param termId the id of the term\\r\\n    function toggleAutoPay(uint termId) external {\\r\\n        LibCollateralStorage.Collateral storage collateral = LibCollateralStorage\\r\\n            ._collateralStorage()\\r\\n            .collaterals[termId];\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[termId];\\r\\n        require(collateral.isCollateralMember[msg.sender], \\\"Pay collateral security first\\\");\\r\\n        bool enabled = !fund.autoPayEnabled[msg.sender];\\r\\n        fund.autoPayEnabled[msg.sender] = enabled;\\r\\n\\r\\n        emit OnAutoPayToggled(termId, msg.sender, enabled);\\r\\n    }\\r\\n\\r\\n    /// @notice This is the function participants call to pay the contribution\\r\\n    /// @param termId the id of the term\\r\\n    function payContribution(uint termId) external {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[termId];\\r\\n\\r\\n        // Get the beneficiary for this cycle\\r\\n        address currentBeneficiary = IGetters(address(this)).getCurrentBeneficiary(termId);\\r\\n\\r\\n        require(\\r\\n            fund.currentState == LibFundStorage.FundStates.AcceptingContributions,\\r\\n            \\\"Wrong state\\\"\\r\\n        );\\r\\n        require(fund.isParticipant[msg.sender], \\\"Not a participant\\\");\\r\\n        require(currentBeneficiary != msg.sender, \\\"Beneficiary doesn't pay\\\");\\r\\n        require(!fund.paidThisCycle[msg.sender], \\\"Already paid for cycle\\\");\\r\\n        require(\\r\\n            !fund.isExemptedOnCycle[fund.currentCycle].exempted[msg.sender],\\r\\n            \\\"Participant is exempted this cycle\\\"\\r\\n        );\\r\\n\\r\\n        _payContribution(termId, msg.sender, msg.sender);\\r\\n    }\\r\\n\\r\\n    /// @notice This function is here to give the possibility to pay using a different wallet\\r\\n    /// @param termId the id of the term\\r\\n    /// @param participant the address the msg.sender is paying for, the address must be part of the fund\\r\\n    function payContributionOnBehalfOf(uint termId, address participant) external {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[termId];\\r\\n\\r\\n        address currentBeneficiary = IGetters(address(this)).getCurrentBeneficiary(termId);\\r\\n\\r\\n        require(\\r\\n            fund.currentState == LibFundStorage.FundStates.AcceptingContributions,\\r\\n            \\\"Wrong state\\\"\\r\\n        );\\r\\n        require(fund.isParticipant[participant], \\\"Not a participant\\\");\\r\\n        require(currentBeneficiary != participant, \\\"Beneficiary doesn't pay\\\");\\r\\n        require(!fund.paidThisCycle[participant], \\\"Already paid for cycle\\\");\\r\\n        require(\\r\\n            !fund.isExemptedOnCycle[fund.currentCycle].exempted[participant],\\r\\n            \\\"Participant is exempted this cycle\\\"\\r\\n        );\\r\\n\\r\\n        _payContribution(termId, msg.sender, participant);\\r\\n    }\\r\\n\\r\\n    /// @notice Called by the beneficiary to withdraw the fund\\r\\n    /// @dev This follows the pull-over-push pattern.\\r\\n    /// @param termId the id of the term\\r\\n    function withdrawFund(uint termId) external {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[termId];\\r\\n        LibCollateralStorage.Collateral storage collateral = LibCollateralStorage\\r\\n            ._collateralStorage()\\r\\n            .collaterals[termId];\\r\\n        // To withdraw the fund, the fund must be closed or the participant must be a beneficiary on\\r\\n        // any of the past cycles.\\r\\n\\r\\n        require(\\r\\n            fund.currentState == LibFundStorage.FundStates.FundClosed ||\\r\\n                fund.isBeneficiary[msg.sender],\\r\\n            \\\"You must be a beneficiary\\\"\\r\\n        );\\r\\n\\r\\n        bool hasFundPool = fund.beneficiariesPool[msg.sender] > 0;\\r\\n        bool hasFrozenPool = fund.beneficiariesFrozenPool[msg.sender];\\r\\n        bool hasCollateralPool = collateral.collateralPaymentBank[msg.sender] > 0;\\r\\n\\r\\n        require(hasFundPool || hasFrozenPool || hasCollateralPool, \\\"Nothing to withdraw\\\");\\r\\n\\r\\n        if (hasFundPool) {\\r\\n            _transferPoolToBeneficiary(termId, msg.sender);\\r\\n        }\\r\\n\\r\\n        if (hasCollateralPool) {\\r\\n            ICollateral(address(this)).withdrawReimbursement(termId, msg.sender);\\r\\n        }\\r\\n\\r\\n        if (hasFrozenPool) {\\r\\n            bool freeze = _freezePot(LibTermStorage._termStorage().terms[termId], fund, msg.sender);\\r\\n\\r\\n            if (fund.currentState != LibFundStorage.FundStates.FundClosed) {\\r\\n                require(!freeze, \\\"Need at least 1.1RCC collateral to unfreeze your fund\\\");\\r\\n            }\\r\\n\\r\\n            _transferPoolToBeneficiary(termId, msg.sender);\\r\\n        }\\r\\n    }\\r\\n\\r\\n    /// @param termId the id of the term\\r\\n    /// @param beneficiary the address of the participant to check\\r\\n    /// @return true if the participant is a beneficiary\\r\\n    function isBeneficiary(uint termId, address beneficiary) external view returns (bool) {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[termId];\\r\\n        return fund.isBeneficiary[beneficiary];\\r\\n    }\\r\\n\\r\\n    /// @notice function to pay the actual contribution for the cycle\\r\\n    /// @param _termId the id of the term\\r\\n    /// @param _payer the address that's paying\\r\\n    /// @param _participant the (participant) address that's being paid for\\r\\n    function _payContribution(uint _termId, address _payer, address _participant) internal {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[_termId];\\r\\n        LibTermStorage.Term storage term = LibTermStorage._termStorage().terms[_termId];\\r\\n\\r\\n        // Get the amount and do the actual transfer\\r\\n        // This will only succeed if the sender approved this contract address beforehand\\r\\n        uint amount = term.contributionAmount * 10 ** 6; // Deducted from user's wallet, six decimals\\r\\n\\r\\n        bool success = fund.stableToken.transferFrom(_payer, address(this), amount);\\r\\n        require(success, \\\"Contribution failed, did you approve stable token?\\\");\\r\\n\\r\\n        // Finish up, set that the participant paid for this cycle and emit an event that it's been done\\r\\n        fund.paidThisCycle[_participant] = true;\\r\\n        emit OnPaidContribution(_termId, _participant, fund.currentCycle);\\r\\n    }\\r\\n\\r\\n    /// @notice Default the participant/beneficiary by checking the mapping first, then remove them from the appropriate array\\r\\n    /// @param _termId The id of the term\\r\\n    /// @param _defaulter The participant to default\\r\\n    function _defaultParticipant(uint _termId, address _defaulter) internal {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[_termId];\\r\\n        // Try removing from participants first\\r\\n        bool success = EnumerableSet.remove(fund._participants, _defaulter);\\r\\n\\r\\n        // If that fails, we try removing from beneficiaries\\r\\n        if (!success) {\\r\\n            success = EnumerableSet.remove(fund._beneficiaries, _defaulter);\\r\\n        }\\r\\n\\r\\n        require(success, \\\"Can't remove defaulter\\\");\\r\\n        EnumerableSet.add(fund._defaulters, _defaulter);\\r\\n\\r\\n        emit OnParticipantDefaulted(_termId, fund.currentCycle, _defaulter);\\r\\n    }\\r\\n\\r\\n    /// @notice The beneficiary will be awarded here based on the beneficiariesOrder array.\\r\\n    /// @notice It will loop through the array and choose the first in line to be eligible to be beneficiary.\\r\\n    function _awardBeneficiary(\\r\\n        LibFundStorage.Fund storage _fund,\\r\\n        LibTermStorage.Term storage _term\\r\\n    ) internal {\\r\\n        address beneficiary = IGetters(address(this)).getCurrentBeneficiary(_term.termId);\\r\\n\\r\\n        // Request contribution from the collateral for those who have to pay this cycle and haven't paid\\r\\n        if (EnumerableSet.length(_fund._defaulters) > 0) {\\r\\n            address[] memory expellants = ICollateral(address(this)).requestContribution(\\r\\n                _term,\\r\\n                EnumerableSet.values(_fund._defaulters)\\r\\n            );\\r\\n\\r\\n            uint expellantsLength = expellants.length;\\r\\n            for (uint i; i < expellantsLength; ) {\\r\\n                if (expellants[i] == address(0)) {\\r\\n                    unchecked {\\r\\n                        ++i;\\r\\n                    }\\r\\n                    continue;\\r\\n                }\\r\\n                _expelDefaulter(_fund, _term, expellants[i]);\\r\\n                unchecked {\\r\\n                    ++i;\\r\\n                }\\r\\n            }\\r\\n        }\\r\\n\\r\\n        // Remove participant from participants set..\\r\\n        if (EnumerableSet.remove(_fund._participants, beneficiary)) {\\r\\n            // ..Then add them to the benificiaries set\\r\\n            EnumerableSet.add(_fund._beneficiaries, beneficiary);\\r\\n        } // If this if-statement fails, this means we're dealing with a graced defaulter\\r\\n\\r\\n        // Update the mapping to track who's been beneficiary\\r\\n        _fund.isBeneficiary[beneficiary] = true;\\r\\n\\r\\n        // Get the amount of participants that paid this cycle, and add that amount to the beneficiary's pool\\r\\n        uint paidCount;\\r\\n        address[] memory participants = _fund.beneficiariesOrder; // Use beneficiariesOrder here because it contains all active participants in a single array\\r\\n        uint participantsLength = participants.length;\\r\\n        for (uint i; i < participantsLength; ) {\\r\\n            if (_fund.paidThisCycle[participants[i]]) {\\r\\n                paidCount++;\\r\\n            }\\r\\n            unchecked {\\r\\n                ++i;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        // Award the beneficiary with the pool or freeze the pot\\r\\n        _freezePot(_term, _fund, beneficiary);\\r\\n\\r\\n        _fund.beneficiariesPool[beneficiary] += _term.contributionAmount * paidCount * 10 ** 6; // Six decimals\\r\\n\\r\\n        emit OnBeneficiaryAwarded(_term.termId, beneficiary);\\r\\n        LibFund._setState(_term.termId, LibFundStorage.FundStates.CycleOngoing);\\r\\n    }\\r\\n\\r\\n    /// @notice called internally to expel a participant. It should not be possible to expel non-defaulters, so those arrays are not checked.\\r\\n    /// @param _expellant The address of the defaulter that will be expelled\\r\\n    function _expelDefaulter(\\r\\n        LibFundStorage.Fund storage _fund,\\r\\n        LibTermStorage.Term storage _term,\\r\\n        address _expellant\\r\\n    ) internal {\\r\\n        // Expellants should only be in the defauters set so no need to touch the other sets\\r\\n        require(\\r\\n            _fund.isParticipant[_expellant] && EnumerableSet.remove(_fund._defaulters, _expellant),\\r\\n            \\\"Expellant not found\\\"\\r\\n        );\\r\\n\\r\\n        _fund.isParticipant[_expellant] = false;\\r\\n\\r\\n        // Lastly, lower the amount of participants\\r\\n        --_term.totalParticipants;\\r\\n        // collateral.isCollateralMember[_expellant] = false; // todo: needed? it is set also on whoExpelled\\r\\n        ++_fund.expelledParticipants;\\r\\n\\r\\n        emit OnDefaulterExpelled(_term.termId, _fund.currentCycle, _expellant);\\r\\n    }\\r\\n\\r\\n    /// @notice Internal function for close fund which is used by _startNewCycle & _chooseBeneficiary to cover some edge-cases\\r\\n    /// @param _termId The id of the term\\r\\n    function _closeFund(uint _termId) internal {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[_termId];\\r\\n        LibTermStorage.Term storage term = LibTermStorage._termStorage().terms[_termId];\\r\\n        fund.fundEnd = block.timestamp;\\r\\n        term.state = LibTermStorage.TermStates.ClosedTerm;\\r\\n        LibFund._setState(_termId, LibFundStorage.FundStates.FundClosed);\\r\\n        ICollateral(address(this)).releaseCollateral(_termId);\\r\\n    }\\r\\n\\r\\n    /// @notice Internal function to transfer the pool to the beneficiary\\r\\n    /// @param _termId The id of the term\\r\\n    /// @param _beneficiary The address of the beneficiary\\r\\n    function _transferPoolToBeneficiary(uint _termId, address _beneficiary) internal {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[_termId];\\r\\n\\r\\n        // Get the amount this beneficiary can withdraw\\r\\n        uint transferAmount = fund.beneficiariesPool[_beneficiary];\\r\\n        uint contractBalance = fund.stableToken.balanceOf(address(this));\\r\\n        if (contractBalance < transferAmount) {\\r\\n            revert InsufficientBalance({available: contractBalance, required: transferAmount});\\r\\n        } else {\\r\\n            fund.beneficiariesPool[_beneficiary] = 0;\\r\\n            bool success = fund.stableToken.transfer(_beneficiary, transferAmount);\\r\\n            require(success, \\\"Transfer failed\\\");\\r\\n        }\\r\\n        emit OnFundWithdrawn(_termId, _beneficiary, transferAmount);\\r\\n    }\\r\\n\\r\\n    /// @notice Internal function to freeze the pot for the beneficiary\\r\\n    function _freezePot(\\r\\n        LibTermStorage.Term memory _term,\\r\\n        LibFundStorage.Fund storage _fund,\\r\\n        address _user\\r\\n    ) internal returns (bool) {\\r\\n        LibCollateralStorage.Collateral storage collateral = LibCollateralStorage\\r\\n            ._collateralStorage()\\r\\n            .collaterals[_term.termId];\\r\\n\\r\\n        uint remainingCyclesContribution = IGetters(address(this))\\r\\n            .getRemainingCyclesContributionWei(_term.termId);\\r\\n\\r\\n        uint neededCollateral = (110 * remainingCyclesContribution) / 100; // 1.1 x RCC\\r\\n\\r\\n        if (collateral.collateralMembersBank[_user] < neededCollateral) {\\r\\n            _fund.beneficiariesFrozenPool[_user] = true;\\r\\n        } else {\\r\\n            _fund.beneficiariesFrozenPool[_user] = false;\\r\\n        }\\r\\n\\r\\n        return _fund.beneficiariesFrozenPool[_user];\\r\\n    }\\r\\n}\\r\\n\",\"keccak256\":\"0x2b13f3eaaddbeb1d383d8ab51c405023455b4ecff54dd6883afbeb67151bc6d6\",\"license\":\"GPL-3.0\"},\"contracts/interfaces/ICollateral.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0\\r\\n\\r\\npragma solidity 0.8.18;\\r\\n\\r\\n/// @title Takaturn Collateral Interface\\r\\n/// @author Aisha EL Allam\\r\\n/// @notice This is used to allow fund to easily communicate with collateral\\r\\n/// @dev v2.0 (post-deploy)\\r\\n\\r\\nimport {LibCollateralStorage} from \\\"../libraries/LibCollateralStorage.sol\\\";\\r\\nimport {LibTermStorage} from \\\"../libraries/LibTermStorage.sol\\\";\\r\\n\\r\\ninterface ICollateral {\\r\\n    // Function cannot be called at this time.\\r\\n    error FunctionInvalidAtThisState();\\r\\n\\r\\n    /// @notice Called from Fund contract when someone defaults\\r\\n    /// @dev Check EnumerableMap (openzeppelin) for arrays that are being accessed from Fund contract\\r\\n    /// @param term the term object\\r\\n    /// @param defaulters Address that was randomly selected for the current cycle\\r\\n    function requestContribution(\\r\\n        LibTermStorage.Term memory term,\\r\\n        address[] calldata defaulters\\r\\n    ) external returns (address[] memory);\\r\\n\\r\\n    /// @notice Called by each member after the end of the cycle to withraw collateral\\r\\n    /// @dev This follows the pull-over-push pattern.\\r\\n    /// @param termId The term id\\r\\n    function withdrawCollateral(uint termId) external;\\r\\n\\r\\n    /// @param termId The term id\\r\\n    /// @param participant The participant address\\r\\n    function withdrawReimbursement(uint termId, address participant) external;\\r\\n\\r\\n    /// @param termId The term id\\r\\n    function releaseCollateral(uint termId) external;\\r\\n\\r\\n    /// @notice Checks if a user has a collateral below 1.0x of total contribution amount\\r\\n    /// @dev This will revert if called during ReleasingCollateral or after\\r\\n    /// @param termId The term id\\r\\n    /// @param member The user to check for\\r\\n    /// @return Bool check if member is below 1.0x of collateralDeposit\\r\\n    function isUnderCollaterized(uint termId, address member) external view returns (bool);\\r\\n\\r\\n    /// @notice allow the owner to empty the Collateral after 180 days\\r\\n    function emptyCollateralAfterEnd(uint termId) external;\\r\\n}\\r\\n\",\"keccak256\":\"0x11dc1fecb867506a1d4558fbe852b96fc8a7aae5614fd6d3960833305a1242a3\",\"license\":\"GPL-3.0\"},\"contracts/interfaces/IFund.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0\\r\\n\\r\\npragma solidity 0.8.18;\\r\\n\\r\\n/// @title Takaturn Fund Interface\\r\\n/// @author Mohammed Haddouti\\r\\n/// @notice This is used to allow collateral to easily communicate with fund\\r\\n/// @dev v2.0 (post-deploy)\\r\\n\\r\\nimport {LibFund} from \\\"../libraries/LibFund.sol\\\";\\r\\n\\r\\ninterface IFund {\\r\\n    // function initFund(uint termId) external;\\r\\n\\r\\n    /// @notice starts a new cycle manually called by the owner. Only the first cycle starts automatically upon deploy\\r\\n    function startNewCycle(uint termId) external;\\r\\n\\r\\n    /// @notice Must be called at the end of the contribution period after the time has passed by the owner\\r\\n    function closeFundingPeriod(uint termId) external;\\r\\n\\r\\n    // @notice allow the owner to empty the fund if there's any excess fund left after 180 days,\\r\\n    //         this with the assumption that beneficiaries can't claim it themselves due to losing their keys for example,\\r\\n    //         and prevent the fund to be stuck in limbo\\r\\n    function emptyFundAfterEnd(uint termId) external;\\r\\n\\r\\n    /// @notice function to enable/disable autopay\\r\\n    function toggleAutoPay(uint termId) external;\\r\\n\\r\\n    /// @notice This is the function participants call to pay the contribution\\r\\n    function payContribution(uint termId) external;\\r\\n\\r\\n    /// @notice This function is here to give the possibility to pay using a different wallet\\r\\n    /// @param participant the address the msg.sender is paying for, the address must be part of the fund\\r\\n    function payContributionOnBehalfOf(uint termId, address participant) external;\\r\\n\\r\\n    /// @notice Called by the beneficiary to withdraw the fund\\r\\n    /// @dev This follows the pull-over-push pattern.\\r\\n    function withdrawFund(uint termId) external;\\r\\n\\r\\n    function isBeneficiary(uint termId, address beneficiary) external view returns (bool);\\r\\n}\\r\\n\",\"keccak256\":\"0x7a77207295230fa8dc287d39b4a8c28a176ea7c4524098d615fd43657917fa0d\",\"license\":\"GPL-3.0\"},\"contracts/interfaces/IGetters.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0\\r\\n\\r\\npragma solidity 0.8.18;\\r\\n\\r\\nimport {IERC20} from \\\"@openzeppelin/contracts/token/ERC20/IERC20.sol\\\";\\r\\n\\r\\nimport {LibTermStorage} from \\\"../libraries/LibTermStorage.sol\\\";\\r\\nimport {LibCollateralStorage} from \\\"../libraries/LibCollateralStorage.sol\\\";\\r\\nimport {LibFundStorage} from \\\"../libraries/LibFundStorage.sol\\\";\\r\\n\\r\\ninterface IGetters {\\r\\n    // TERM GETTERS\\r\\n\\r\\n    /// @notice Gets the current and next term id\\r\\n    /// @return current termID\\r\\n    /// @return next termID\\r\\n    function getTermsId() external view returns (uint, uint);\\r\\n\\r\\n    /// @notice Must return 0 before starting the fund\\r\\n    /// @param termId the id of the term\\r\\n    /// @return remaining registration time in seconds\\r\\n    function getRemainingRegistrationTime(uint termId) external view returns (uint);\\r\\n\\r\\n    /// @notice Get current information of a term\\r\\n    /// @param termId the id of the term\\r\\n    /// @return Term Struct, see LibTermStorage.sol\\r\\n    function getTermSummary(uint termId) external view returns (LibTermStorage.Term memory);\\r\\n\\r\\n    /// @notice Gets all terms a user has previously joined\\r\\n    /// @param participant address\\r\\n    /// @return List of termIDs\\r\\n    function getAllJoinedTerms(address participant) external view returns (uint[] memory);\\r\\n\\r\\n    /// @notice Gets all terms a user has previously joined based on the specefied term state\\r\\n    /// @param participant address\\r\\n    /// @param state, can be InitializingTerm, ActiveTerm, ExpiredTerm, ClosedTerm\\r\\n    /// @return List of termIDs\\r\\n    function getJoinedTermsByState(\\r\\n        address participant,\\r\\n        LibTermStorage.TermStates state\\r\\n    ) external view returns (uint[] memory);\\r\\n\\r\\n    /// @notice Gets all terms a user was previously expelled from\\r\\n    /// @param participant address\\r\\n    /// @return List of termIDs\\r\\n    function getExpelledTerms(address participant) external view returns (uint[] memory);\\r\\n\\r\\n    /// @notice Gets all remaining cycles of a term\\r\\n    /// @param termId the id of the term\\r\\n    /// @return remaining cycles\\r\\n    function getRemainingCycles(uint termId) external view returns (uint);\\r\\n\\r\\n    /// @notice Must be 0 before starting a new cycle\\r\\n    /// @param termId the id of the term\\r\\n    /// @return remaining cycle time in seconds\\r\\n    function getRemainingCycleTime(uint termId) external view returns (uint);\\r\\n\\r\\n    /// @notice Gets the expected remaining contribution amount for users in a term\\r\\n    /// @param termId the id of the term\\r\\n    /// @return total remaining contribution in wei\\r\\n    function getRemainingCyclesContributionWei(uint termId) external view returns (uint);\\r\\n\\r\\n    // COLLATERAL GETTERS\\r\\n\\r\\n    /// @notice Gets a users collateral summary\\r\\n    /// @param depositor address\\r\\n    /// @param termId the id of the term\\r\\n    /// @return if the user is a true member of the term\\r\\n    /// @return current users locked collateral balance in wei\\r\\n    /// @return current users unlocked collateral balance in wei\\r\\n    /// @return initial users deposit in wei\\r\\n    /// @return expulsion limit\\r\\n    function getDepositorCollateralSummary(\\r\\n        address depositor,\\r\\n        uint termId\\r\\n    ) external view returns (bool, uint, uint, uint, uint);\\r\\n\\r\\n    /// @notice Gets the collateral summary of a term\\r\\n    /// @param termId the id of the term\\r\\n    /// @return if collateral is initialized\\r\\n    /// @return current state of the collateral, see States struct in LibCollateralStorage.sol\\r\\n    /// @return time of first deposit in seconds, 0 if no deposit occured yet\\r\\n    /// @return current member count\\r\\n    /// @return list of depositors\\r\\n    function getCollateralSummary(\\r\\n        uint termId\\r\\n    )\\r\\n        external\\r\\n        view\\r\\n        returns (bool, LibCollateralStorage.CollateralStates, uint, uint, address[] memory);\\r\\n\\r\\n    /// @notice Gets the required minimum collateral deposit based on the position\\r\\n    /// @param termId the term id\\r\\n    /// @param depositorIndex the index of the depositor\\r\\n    /// @return required minimum in wei\\r\\n    function minCollateralToDeposit(uint termId, uint depositorIndex) external view returns (uint);\\r\\n\\r\\n    /// @notice Called to check how much collateral a user can withdraw\\r\\n    /// @param termId term id\\r\\n    /// @param user depositor address\\r\\n    /// @return allowedWithdrawal amount the amount of collateral the depositor can withdraw\\r\\n    function getWithdrawableUserBalance(\\r\\n        uint termId,\\r\\n        address user\\r\\n    ) external view returns (uint allowedWithdrawal);\\r\\n\\r\\n    // FUND GETTERS\\r\\n    /// @notice Gets the fund summary of a term\\r\\n    /// @param termId the id of the term\\r\\n    /// @return if fund is initialized\\r\\n    /// @return current state of the fund, see States struct in LibFund.sol\\r\\n    /// @return stablecoin address used\\r\\n    /// @return list for order of beneficiaries\\r\\n    /// @return when the fund started in seconds\\r\\n    /// @return when the fund ended in seconds, 0 otherwise\\r\\n    /// @return current cycle of fund\\r\\n    /// @return total amount of cycles in this fund/term\\r\\n    function getFundSummary(\\r\\n        uint termId\\r\\n    )\\r\\n        external\\r\\n        view\\r\\n        returns (bool, LibFundStorage.FundStates, IERC20, address[] memory, uint, uint, uint, uint);\\r\\n\\r\\n    /// @notice Gets the current beneficiary of a term\\r\\n    /// @param termId the id of the term\\r\\n    /// @return user address\\r\\n    function getCurrentBeneficiary(uint termId) external view returns (address);\\r\\n\\r\\n    /// @notice Gets if a user is expelled from a specefic term\\r\\n    /// @param termId the id of the term\\r\\n    /// @param user address\\r\\n    /// @return true or false\\r\\n    function wasExpelled(uint termId, address user) external view returns (bool);\\r\\n\\r\\n    /// @notice Gets if a user is exempted from paying for a specefic cycle\\r\\n    /// @param termId the id of the term\\r\\n    /// @param cycle number\\r\\n    /// @param user address\\r\\n    /// @return true or false\\r\\n    function isExempted(uint termId, uint cycle, address user) external view returns (bool);\\r\\n\\r\\n    /// @notice Gets a user information of in a fund\\r\\n    /// @param participant address\\r\\n    /// @param termId the id of the term\\r\\n    /// @return if the user is a true member of the fund/term\\r\\n    /// @return if the user was beneficiary in the past\\r\\n    /// @return if the user paid for the current cycle\\r\\n    /// @return if the user has autopay enabled\\r\\n    /// @return users money pot balance\\r\\n    function getParticipantFundSummary(\\r\\n        address participant,\\r\\n        uint termId\\r\\n    ) external view returns (bool, bool, bool, bool, uint, bool);\\r\\n\\r\\n    /// @notice Must return 0 before closing a contribution period\\r\\n    /// @param termId the id of the term\\r\\n    /// @return remaining contribution time in seconds\\r\\n    function getRemainingContributionTime(uint termId) external view returns (uint);\\r\\n\\r\\n    // CONVERSION GETTERS\\r\\n\\r\\n    function getToCollateralConversionRate(uint USDAmount) external view returns (uint);\\r\\n\\r\\n    function getToStableConversionRate(uint ethAmount) external view returns (uint);\\r\\n\\r\\n    // YIELD GENERATION GETTERS\\r\\n\\r\\n    function userHasoptedInYG(uint termId, address user) external view returns (bool);\\r\\n\\r\\n    function userAPY(uint termId, address user) external returns (uint256);\\r\\n\\r\\n    function termAPY(uint termId) external returns (uint256);\\r\\n\\r\\n    function yieldDistributionRatio(uint termId, address user) external view returns (uint256);\\r\\n\\r\\n    function totalYieldGenerated(uint termId) external returns (uint);\\r\\n\\r\\n    function userYieldGenerated(uint termId, address user) external returns (uint);\\r\\n}\\r\\n\",\"keccak256\":\"0xeb18545c0d636e05a75ddd4f777ddb1a57860fe7d94ffd4985feddba3abfaadc\",\"license\":\"GPL-3.0\"},\"contracts/libraries/LibCollateral.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\r\\npragma solidity 0.8.18;\\r\\n\\r\\nimport {LibCollateralStorage} from \\\"./LibCollateralStorage.sol\\\";\\r\\n\\r\\nlibrary LibCollateral {\\r\\n    event OnCollateralStateChanged(\\r\\n        uint indexed termId,\\r\\n        LibCollateralStorage.CollateralStates indexed oldState,\\r\\n        LibCollateralStorage.CollateralStates indexed newState\\r\\n    );\\r\\n\\r\\n    /// @param _termId term id\\r\\n    /// @param _newState collateral state\\r\\n    function _setState(uint _termId, LibCollateralStorage.CollateralStates _newState) internal {\\r\\n        LibCollateralStorage.Collateral storage collateral = LibCollateralStorage\\r\\n            ._collateralStorage()\\r\\n            .collaterals[_termId];\\r\\n        LibCollateralStorage.CollateralStates oldState = collateral.state;\\r\\n        collateral.state = _newState;\\r\\n        emit OnCollateralStateChanged(_termId, oldState, _newState);\\r\\n    }\\r\\n}\\r\\n\",\"keccak256\":\"0x174faa9c9172ab1b440e41471a2164d9920b2ecb36f9999d44d6ab2f0e6f0708\",\"license\":\"MIT\"},\"contracts/libraries/LibCollateralStorage.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\r\\npragma solidity 0.8.18;\\r\\n\\r\\nlibrary LibCollateralStorage {\\r\\n    uint public constant COLLATERAL_VERSION = 1;\\r\\n    bytes32 constant COLLATERAL_STORAGE_POSITION = keccak256(\\\"diamond.standard.collateral.storage\\\");\\r\\n\\r\\n    enum CollateralStates {\\r\\n        AcceptingCollateral, // Initial state where collateral are deposited\\r\\n        CycleOngoing, // Triggered when a fund instance is created, no collateral can be accepted\\r\\n        ReleasingCollateral, // Triggered when the fund closes\\r\\n        Closed // Triggered when all depositors withdraw their collaterals\\r\\n    }\\r\\n\\r\\n    struct DefaulterState {\\r\\n        bool payWithCollateral;\\r\\n        bool payWithFrozenPool;\\r\\n        bool gettingExpelled;\\r\\n        bool isBeneficiary;\\r\\n    }\\r\\n\\r\\n    struct Collateral {\\r\\n        bool initialized;\\r\\n        CollateralStates state;\\r\\n        uint firstDepositTime;\\r\\n        uint counterMembers;\\r\\n        address[] depositors;\\r\\n        mapping(address => bool) isCollateralMember; // Determines if a depositor is a valid user\\r\\n        mapping(address => uint) collateralMembersBank; // Users main balance\\r\\n        mapping(address => uint) collateralPaymentBank; // Users reimbursement balance after someone defaults\\r\\n        mapping(address => uint) collateralDepositByUser; // Depends on the depositors index\\r\\n    }\\r\\n\\r\\n    struct CollateralStorage {\\r\\n        mapping(uint => Collateral) collaterals; // termId => Collateral struct\\r\\n    }\\r\\n\\r\\n    function _collateralExists(uint termId) internal view returns (bool) {\\r\\n        return _collateralStorage().collaterals[termId].initialized;\\r\\n    }\\r\\n\\r\\n    function _collateralStorage()\\r\\n        internal\\r\\n        pure\\r\\n        returns (CollateralStorage storage collateralStorage)\\r\\n    {\\r\\n        bytes32 position = COLLATERAL_STORAGE_POSITION;\\r\\n        assembly {\\r\\n            collateralStorage.slot := position\\r\\n        }\\r\\n    }\\r\\n}\\r\\n\",\"keccak256\":\"0x5533a3634ad11b156b9db4c2ffc1a114c2dbad0e6ca96b0239807b365b2d090e\",\"license\":\"MIT\"},\"contracts/libraries/LibFund.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\r\\npragma solidity 0.8.18;\\r\\n\\r\\nimport {IGetters} from \\\"../interfaces/IGetters.sol\\\";\\r\\n\\r\\nimport {EnumerableSet} from \\\"@openzeppelin/contracts/utils/structs/EnumerableSet.sol\\\";\\r\\nimport {LibTermStorage} from \\\"./LibTermStorage.sol\\\";\\r\\nimport {LibFundStorage} from \\\"./LibFundStorage.sol\\\";\\r\\n\\r\\nlibrary LibFund {\\r\\n    using EnumerableSet for EnumerableSet.AddressSet;\\r\\n\\r\\n    event OnTermStart(uint indexed termId); // Emits when a new term starts, this also marks the start of the first cycle\\r\\n    event OnFundStateChanged(\\r\\n        uint indexed termId,\\r\\n        uint indexed currentCycle,\\r\\n        LibFundStorage.FundStates indexed newState\\r\\n    ); // Emits when state has updated\\r\\n    event OnPaidContribution(uint indexed termId, address indexed payer, uint indexed currentCycle); // Emits when participant pays the contribution\\r\\n\\r\\n    /// @notice called by the term to init the fund\\r\\n    /// @param termId the id of the term\\r\\n    function _initFund(uint termId) internal {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[termId];\\r\\n        uint participantsArrayLength = fund.beneficiariesOrder.length;\\r\\n        // Set and track participants\\r\\n        for (uint i; i < participantsArrayLength; ) {\\r\\n            EnumerableSet.add(fund._participants, fund.beneficiariesOrder[i]);\\r\\n            fund.isParticipant[fund.beneficiariesOrder[i]] = true;\\r\\n            unchecked {\\r\\n                ++i;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        // Starts the first cycle\\r\\n        _startNewCycle(termId);\\r\\n\\r\\n        // Set timestamp of deployment, which will be used to determine cycle times\\r\\n        // We do this after starting the first cycle to make sure the first cycle starts smoothly\\r\\n        fund.fundStart = block.timestamp;\\r\\n        //emit LibFund.OnTermStart(termId);\\r\\n        emit OnTermStart(termId);\\r\\n    }\\r\\n\\r\\n    /// @notice This starts the new cycle and can only be called internally. Used upon deploy\\r\\n    /// @param _termId The id of the term\\r\\n    function _startNewCycle(uint _termId) internal {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[_termId];\\r\\n        LibTermStorage.Term storage term = LibTermStorage._termStorage().terms[_termId];\\r\\n        // currentCycle is 0 when this is called for the first time\\r\\n        require(\\r\\n            block.timestamp > term.cycleTime * fund.currentCycle + fund.fundStart,\\r\\n            \\\"Too early to start new cycle\\\"\\r\\n        );\\r\\n        require(\\r\\n            fund.currentState == LibFundStorage.FundStates.InitializingFund ||\\r\\n                fund.currentState == LibFundStorage.FundStates.CycleOngoing,\\r\\n            \\\"Wrong state\\\"\\r\\n        );\\r\\n\\r\\n        ++fund.currentCycle;\\r\\n        uint length = fund.beneficiariesOrder.length;\\r\\n        for (uint i; i < length; ) {\\r\\n            fund.paidThisCycle[fund.beneficiariesOrder[i]] = false;\\r\\n            unchecked {\\r\\n                ++i;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        _setState(_termId, LibFundStorage.FundStates.AcceptingContributions);\\r\\n\\r\\n        // We attempt to make the autopayers pay their contribution right away\\r\\n        _autoPay(_termId);\\r\\n    }\\r\\n\\r\\n    /// @notice updates the state according to the input and makes sure the state can't be changed if the fund is closed. Also emits an event that this happened\\r\\n    /// @param _termId The id of the term\\r\\n    /// @param _newState The new state of the fund\\r\\n    function _setState(uint _termId, LibFundStorage.FundStates _newState) internal {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[_termId];\\r\\n        require(fund.currentState != LibFundStorage.FundStates.FundClosed, \\\"Fund closed\\\");\\r\\n        fund.currentState = _newState;\\r\\n        emit OnFundStateChanged(_termId, fund.currentCycle, _newState);\\r\\n    }\\r\\n\\r\\n    /// @notice function to attempt to make autopayers pay their contribution\\r\\n    /// @param _termId the id of the term\\r\\n    function _autoPay(uint _termId) internal {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[_termId];\\r\\n\\r\\n        // Get the beneficiary for this cycle\\r\\n        address currentBeneficiary = IGetters(address(this)).getCurrentBeneficiary(_termId);\\r\\n\\r\\n        address[] memory autoPayers = fund.beneficiariesOrder; // use beneficiariesOrder because it is a single array with all participants\\r\\n        uint autoPayersArray = autoPayers.length;\\r\\n\\r\\n        for (uint i; i < autoPayersArray; ) {\\r\\n            address autoPayer = autoPayers[i];\\r\\n            // The beneficiary doesn't pay\\r\\n            if (currentBeneficiary == autoPayer) {\\r\\n                unchecked {\\r\\n                    ++i;\\r\\n                }\\r\\n                continue;\\r\\n            }\\r\\n\\r\\n            if (\\r\\n                fund.autoPayEnabled[autoPayer] &&\\r\\n                !fund.paidThisCycle[autoPayer] &&\\r\\n                !fund.isExemptedOnCycle[fund.currentCycle].exempted[autoPayer]\\r\\n            ) {\\r\\n                _payContributionSafe(_termId, autoPayer, autoPayer);\\r\\n            }\\r\\n\\r\\n            unchecked {\\r\\n                ++i;\\r\\n            }\\r\\n        }\\r\\n    }\\r\\n\\r\\n    /// @notice function to pay the actual contribution for the cycle, used for autopay to prevent reverts\\r\\n    /// @param _termId the id of the term\\r\\n    /// @param _payer the address that's paying\\r\\n    /// @param _participant the (participant) address that's being paid for\\r\\n    function _payContributionSafe(uint _termId, address _payer, address _participant) internal {\\r\\n        LibFundStorage.Fund storage fund = LibFundStorage._fundStorage().funds[_termId];\\r\\n        LibTermStorage.Term storage term = LibTermStorage._termStorage().terms[_termId];\\r\\n\\r\\n        // Get the amount and do the actual transfer\\r\\n        // This will only succeed if the sender approved this contract address beforehand\\r\\n        uint amount = term.contributionAmount * 10 ** 6; // Deducted from user's wallet, six decimals\\r\\n        try fund.stableToken.transferFrom(_payer, address(this), amount) returns (bool success) {\\r\\n            if (success) {\\r\\n                // Finish up, set that the participant paid for this cycle and emit an event that it's been done\\r\\n                fund.paidThisCycle[_participant] = true;\\r\\n                emit OnPaidContribution(_termId, _participant, fund.currentCycle);\\r\\n            }\\r\\n        } catch {}\\r\\n    }\\r\\n}\\r\\n\",\"keccak256\":\"0xa12c43223f7c2589adfe7f1ef1a867392a9671d5132f855a3b3d53f3400053b3\",\"license\":\"MIT\"},\"contracts/libraries/LibFundStorage.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\r\\npragma solidity 0.8.18;\\r\\n\\r\\nimport {IERC20} from \\\"@openzeppelin/contracts/token/ERC20/IERC20.sol\\\";\\r\\n\\r\\nimport {EnumerableSet} from \\\"@openzeppelin/contracts/utils/structs/EnumerableSet.sol\\\";\\r\\n\\r\\nlibrary LibFundStorage {\\r\\n    using EnumerableSet for EnumerableSet.AddressSet;\\r\\n\\r\\n    uint public constant FUND_VERSION = 1;\\r\\n    bytes32 constant FUND_POSITION = keccak256(\\\"diamond.standard.fund\\\");\\r\\n    bytes32 constant FUND_STORAGE_POSITION = keccak256(\\\"diamond.standard.fund.storage\\\");\\r\\n\\r\\n    enum FundStates {\\r\\n        InitializingFund, // Time before the first cycle has started\\r\\n        AcceptingContributions, // Triggers at the start of a cycle\\r\\n        AwardingBeneficiary, // Contributions are closed, beneficiary is chosen, people default etc.\\r\\n        CycleOngoing, // Time after beneficiary is chosen, up till the start of the next cycle\\r\\n        FundClosed // Triggers at the end of the last contribution period, no state changes after this\\r\\n    }\\r\\n\\r\\n    struct PayExemption {\\r\\n        mapping(address => bool) exempted; // Mapping to keep track of if someone is exempted from paying\\r\\n    }\\r\\n\\r\\n    struct Fund {\\r\\n        bool initialized;\\r\\n        FundStates currentState; // Variable to keep track of the different FundStates\\r\\n        IERC20 stableToken; // Instance of the stable token\\r\\n        address[] beneficiariesOrder; // The correct order of who gets to be next beneficiary, determined by collateral contract\\r\\n        uint fundStart; // Timestamp of the start of the fund\\r\\n        uint fundEnd; // Timestamp of the end of the fund\\r\\n        uint currentCycle; // Index of current cycle\\r\\n        mapping(address => bool) isParticipant; // Mapping to keep track of who's a participant or not\\r\\n        mapping(address => bool) isBeneficiary; // Mapping to keep track of who's a beneficiary or not\\r\\n        mapping(address => bool) paidThisCycle; // Mapping to keep track of who paid for this cycle\\r\\n        mapping(address => bool) autoPayEnabled; // Wheter to attempt to automate payments at the end of the contribution period\\r\\n        mapping(address => uint) beneficiariesPool; // Mapping to keep track on how much each beneficiary can claim. Six decimals\\r\\n        mapping(address => bool) beneficiariesFrozenPool; // Frozen pool by beneficiaries, it can claim when his collateral is at least 1.1 X RCC\\r\\n        mapping(address => uint) cycleOfExpulsion; // Mapping to keep track on which cycle a user was expelled\\r\\n        mapping(uint => PayExemption) isExemptedOnCycle; // Mapping to keep track of if someone is exempted from paying this cycle\\r\\n        EnumerableSet.AddressSet _participants; // Those who have not been beneficiaries yet and have not defaulted this cycle\\r\\n        EnumerableSet.AddressSet _beneficiaries; // Those who have been beneficiaries and have not defaulted this cycle\\r\\n        EnumerableSet.AddressSet _defaulters; // Both participants and beneficiaries who have defaulted this cycle\\r\\n        uint expelledParticipants; // Total amount of participants that have been expelled so far\\r\\n        uint totalAmountOfCycles;\\r\\n    }\\r\\n\\r\\n    struct FundStorage {\\r\\n        mapping(uint => Fund) funds; // termId => Fund struct\\r\\n    }\\r\\n\\r\\n    function _fundExists(uint termId) internal view returns (bool) {\\r\\n        return _fundStorage().funds[termId].initialized;\\r\\n    }\\r\\n\\r\\n    function _fundStorage() internal pure returns (FundStorage storage fundStorage) {\\r\\n        bytes32 position = FUND_STORAGE_POSITION;\\r\\n        assembly {\\r\\n            fundStorage.slot := position\\r\\n        }\\r\\n    }\\r\\n}\\r\\n\",\"keccak256\":\"0x8e573ed3954c974c93379f2624c66f11bfc5140bacae56e964f7940ef9ef9d51\",\"license\":\"MIT\"},\"contracts/libraries/LibTermOwnership.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\r\\n\\r\\npragma solidity 0.8.18;\\r\\n\\r\\nimport {LibTermStorage} from \\\"../libraries/LibTermStorage.sol\\\";\\r\\n\\r\\nlibrary LibTermOwnership {\\r\\n    /**\\r\\n     * @dev Throws if the sender is not the term owner.\\r\\n     * @dev Used for internal calls\\r\\n     */\\r\\n    function _ensureTermOwner(uint termId) internal view {\\r\\n        require(\\r\\n            LibTermStorage._termStorage().terms[termId].termOwner == msg.sender,\\r\\n            \\\"TermOwnable: caller is not the owner\\\"\\r\\n        );\\r\\n    }\\r\\n}\\r\\n\",\"keccak256\":\"0x279ab99b10f4c6cb59261bdc6a55dd3d2a788335a581c34249f30c43eec0cb81\",\"license\":\"MIT\"},\"contracts/libraries/LibTermStorage.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\r\\npragma solidity 0.8.18;\\r\\n\\r\\nlibrary LibTermStorage {\\r\\n    uint public constant TERM_VERSION = 2;\\r\\n    bytes32 constant TERM_CONSTS_POSITION = keccak256(\\\"diamond.standard.term.consts\\\");\\r\\n    bytes32 constant TERM_STORAGE_POSITION = keccak256(\\\"diamond.standard.term.storage\\\");\\r\\n\\r\\n    enum TermStates {\\r\\n        InitializingTerm,\\r\\n        ActiveTerm,\\r\\n        ExpiredTerm,\\r\\n        ClosedTerm\\r\\n    }\\r\\n\\r\\n    struct TermConsts {\\r\\n        uint sequencerStartupTime;\\r\\n        address sequencerUptimeFeedAddress;\\r\\n        mapping(string => address) aggregatorsAddresses; // \\\"ETH/USD\\\" => address , \\\"USDC/USD\\\" => address\\r\\n    }\\r\\n\\r\\n    struct Term {\\r\\n        bool initialized;\\r\\n        TermStates state;\\r\\n        address termOwner;\\r\\n        uint creationTime;\\r\\n        uint termId;\\r\\n        uint registrationPeriod; // Time for registration (seconds)\\r\\n        uint totalParticipants; // Max number of participants\\r\\n        uint cycleTime; // Time for single cycle (seconds)\\r\\n        uint contributionAmount; // Amount user must pay per cycle (USD)\\r\\n        uint contributionPeriod; // The portion of cycle user must make payment\\r\\n        address stableTokenAddress;\\r\\n    }\\r\\n\\r\\n    struct TermStorage {\\r\\n        uint nextTermId;\\r\\n        mapping(uint => Term) terms; // termId => Term struct\\r\\n        mapping(address => uint[]) participantToTermId; // userAddress => [termId1, termId2, ...]\\r\\n    }\\r\\n\\r\\n    function _termExists(uint termId) internal view returns (bool) {\\r\\n        return _termStorage().terms[termId].initialized;\\r\\n    }\\r\\n\\r\\n    function _termConsts() internal pure returns (TermConsts storage termConsts) {\\r\\n        bytes32 position = TERM_CONSTS_POSITION;\\r\\n        assembly {\\r\\n            termConsts.slot := position\\r\\n        }\\r\\n    }\\r\\n\\r\\n    function _termStorage() internal pure returns (TermStorage storage termStorage) {\\r\\n        bytes32 position = TERM_STORAGE_POSITION;\\r\\n        assembly {\\r\\n            termStorage.slot := position\\r\\n        }\\r\\n    }\\r\\n}\\r\\n\",\"keccak256\":\"0x59797d2ec64c1b7728ecc2de17b3c6d462738a1ab3126a0a624246a1e39da032\",\"license\":\"MIT\"}},\"version\":1}",
  "bytecode": "0x608060405234801561001057600080fd5b506127e3806100206000396000f3fe608060405234801561001057600080fd5b50600436106100935760003560e01c80637be2ecea116100665780637be2ecea146100e657806384431629146100f9578063e9783e601461010c578063ea28b9bb14610134578063f7af18f61461014757600080fd5b80630cee1725146100985780632009844b146100ad5780634b5c9c80146100c057806358733dec146100d3575b600080fd5b6100ab6100a636600461236c565b61015d565b005b6100ab6100bb36600461236c565b6104a7565b6100ab6100ce36600461236c565b6106b9565b6100ab6100e136600461236c565b610911565b6100ab6100f436600461236c565b610cd2565b6100ab61010736600461239a565b610cde565b61011f61011a36600461239a565b610f15565b60405190151581526020015b60405180910390f35b6100ab61014236600461236c565b610f52565b61014f600281565b60405190815260200161012b565b600081815260008051602061276e833981519152602090815260408083207f35fa70a6f9ae8a4d427ebe0c1be62ffd2870fecc1df41c6fda0bf5803e5628889092529091208154600490610100900460ff16818111156101bf576101bf6123ca565b14806101dc575033600090815260068301602052604090205460ff165b61022d5760405162461bcd60e51b815260206004820152601960248201527f596f75206d75737420626520612062656e65666963696172790000000000000060448201526064015b60405180910390fd5b336000908152600983016020908152604080832054600a8601835281842054600686019093529220549115159160ff909116901515828061026b5750815b806102735750805b6102b55760405162461bcd60e51b81526020600482015260136024820152724e6f7468696e6720746f20776974686472617760681b6044820152606401610224565b82156102c5576102c58633611049565b80156103235760405163ae483d0760e01b815260048101879052336024820152309063ae483d0790604401600060405180830381600087803b15801561030a57600080fd5b505af115801561031e573d6000803e3d6000fd5b505050505b811561049f57600086815260008051602061278e8339815191526020908152604080832081516101608101909252805460ff8082161515845261040394840191610100900416600381111561037a5761037a6123ca565b600381111561038b5761038b6123ca565b815281546001600160a01b036201000090910481166020830152600183015460408301526002830154606083015260038301546080830152600483015460a0830152600583015460c0830152600683015460e0830152600783015461010083015260089092015490911661012090910152873361122f565b905060048654610100900460ff166004811115610422576104226123ca565b146104935780156104935760405162461bcd60e51b815260206004820152603560248201527f4e656564206174206c6561737420312e3152434320636f6c6c61746572616c206044820152741d1bc81d5b999c99595e99481e5bdd5c88199d5b99605a1b6064820152608401610224565b61049d8733611049565b505b505050505050565b600060008051602061276e83398151915260008381526020919091526040808220905163d8f8e99160e01b815260048101859052909250309063d8f8e99190602401602060405180830381865afa158015610506573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061052a91906123f0565b905060018254610100900460ff166004811115610549576105496123ca565b146105665760405162461bcd60e51b81526004016102249061240d565b33600090815260058301602052604090205460ff166105bb5760405162461bcd60e51b8152602060048201526011602482015270139bdd0818481c185c9d1a58da5c185b9d607a1b6044820152606401610224565b336001600160a01b0382160361060d5760405162461bcd60e51b815260206004820152601760248201527642656e656669636961727920646f65736e27742070617960481b6044820152606401610224565b33600090815260078301602052604090205460ff16156106685760405162461bcd60e51b8152602060048201526016602482015275416c7265616479207061696420666f72206379636c6560501b6044820152606401610224565b60048201546000908152600c83016020908152604080832033845290915290205460ff16156106a95760405162461bcd60e51b815260040161022490612432565b6106b483333361137f565b505050565b806106c381611519565b600082815260008051602061276e833981519152602052604090208054600490610100900460ff16818111156106fb576106fb6123ca565b148015610718575060038101546107159062ed4e0061248a565b42115b6107565760405162461bcd60e51b815260206004820152600f60248201526e10d85b89dd08195b5c1d1e481e595d608a1b6044820152606401610224565b6001810154600090815b818110156108475760008460090160008660010184815481106107855761078561249d565b60009182526020808320909101546001600160a01b03168352820192909252604001902054111561083f578360090160008560010183815481106107cb576107cb61249d565b60009182526020808320909101546001600160a01b031683528201929092526040019020546107fa908461248a565b925060008460090160008660010184815481106108195761081961249d565b60009182526020808320909101546001600160a01b031683528201929092526040019020555b600101610760565b50811561090a57825460405163a9059cbb60e01b8152336004820152602481018490526000916201000090046001600160a01b03169063a9059cbb906044016020604051808303816000875af11580156108a5573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906108c991906124b3565b90508061049f5760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b6044820152606401610224565b5050505050565b600081815260008051602061276e8339815191526020908152604080832060008051602061278e83398151915290925290912060078101546002830154600484015461095f906001906124d5565b836005015461096e91906124e8565b610978919061248a565b610982919061248a565b42116109d05760405162461bcd60e51b815260206004820152601860248201527f5374696c6c2074696d6520746f20636f6e7472696275746500000000000000006044820152606401610224565b60018254610100900460ff1660048111156109ed576109ed6123ca565b14610a0a5760405162461bcd60e51b81526004016102249061240d565b60405163d8f8e99160e01b815260048101849052600090309063d8f8e99190602401602060405180830381865afa158015610a49573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610a6d91906123f0565b9050610a788461159f565b610a83846002611768565b600083600101805480602002602001604051908101604052809291908181526020018280548015610add57602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311610abf575b50508351600489015494955093925060009150505b82811015610caf576000848281518110610b0e57610b0e61249d565b60200260200101519050856001600160a01b0316816001600160a01b03161480610b5c57506000838152600c8901602090815260408083206001600160a01b038516845290915290205460ff165b15610b6a5750600101610af2565b6001600160a01b038116600090815260078901602052604090205460ff1615610be5576001600160a01b038116600090815260068901602052604090205460ff1615610bc357610bbd88600f0182611847565b50610bd2565b610bd088600d0182611847565b505b610bdf8860110182611863565b50610ca6565b610bf28860110182611878565b610ca65760405163d7992e5b60e01b8152600481018a90526001600160a01b0387166024820152309063d7992e5b90604401602060405180830381865afa158015610c41573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610c6591906124b3565b15610c9c576001600160a01b038116600090815260068901602052604090205460ff1615610c9757610c97898261189a565b610ca6565b610ca6898261189a565b50600101610af2565b50610cba8686611970565b856014015486600401541061049d5761049d87611d4c565b610cdb81611dea565b50565b600060008051602061276e83398151915260008481526020919091526040808220905163d8f8e99160e01b815260048101869052909250309063d8f8e99190602401602060405180830381865afa158015610d3d573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610d6191906123f0565b905060018254610100900460ff166004811115610d8057610d806123ca565b14610d9d5760405162461bcd60e51b81526004016102249061240d565b6001600160a01b038316600090815260058301602052604090205460ff16610dfb5760405162461bcd60e51b8152602060048201526011602482015270139bdd0818481c185c9d1a58da5c185b9d607a1b6044820152606401610224565b826001600160a01b0316816001600160a01b031603610e565760405162461bcd60e51b815260206004820152601760248201527642656e656669636961727920646f65736e27742070617960481b6044820152606401610224565b6001600160a01b038316600090815260078301602052604090205460ff1615610eba5760405162461bcd60e51b8152602060048201526016602482015275416c7265616479207061696420666f72206379636c6560501b6044820152606401610224565b60048201546000908152600c8301602090815260408083206001600160a01b038716845290915290205460ff1615610f045760405162461bcd60e51b815260040161022490612432565b610f0f84338561137f565b50505050565b600082815260008051602061276e833981519152602090815260408083206001600160a01b038516845260060190915290205460ff165b92915050565b60008181527f35fa70a6f9ae8a4d427ebe0c1be62ffd2870fecc1df41c6fda0bf5803e5628886020908152604080832060008051602061276e83398151915283528184203385526004820190935292205460ff16610ff25760405162461bcd60e51b815260206004820152601d60248201527f50617920636f6c6c61746572616c2073656375726974792066697273740000006044820152606401610224565b336000818152600883016020526040808220805460ff81161560ff199091168117909155905190928392909187917f8bd3cffd2d87eca262a8e2d638c1ff3d3b61c604208115af6295b089acaf72b991a450505050565b600060008051602061276e8339815191526000848152602091825260408082206001600160a01b0386811684526009820190945281832054815492516370a0823160e01b81523060048201529195509362010000909204909116906370a0823190602401602060405180830381865afa1580156110ca573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906110ee91906124ff565b90508181101561111b5760405163cf47918160e01b81526004810182905260248101839052604401610224565b6001600160a01b0384811660008181526009860160205260408082208290558654905163a9059cbb60e01b8152600481019390935260248301869052909262010000909104169063a9059cbb906044016020604051808303816000875af115801561118a573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906111ae91906124b3565b9050806111ef5760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b6044820152606401610224565b5081846001600160a01b0316867f31b332de0dccb2d0ed351b3d65a9e10b099b3e3c63f4a6f5ea1810b4d757795c60405160405180910390a45050505050565b60808301805160009081527f35fa70a6f9ae8a4d427ebe0c1be62ffd2870fecc1df41c6fda0bf5803e56288860205260408082209251905163f0d826e760e01b815260048101919091529091908290309063f0d826e790602401602060405180830381865afa1580156112a6573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906112ca91906124ff565b9050600060646112db83606e6124e8565b6112e59190612518565b6001600160a01b0386166000908152600585016020526040902054909150811115611334576001600160a01b0385166000908152600a870160205260409020805460ff19166001179055611357565b6001600160a01b0385166000908152600a870160205260409020805460ff191690555b505050506001600160a01b03166000908152600a91909101602052604090205460ff16919050565b600083815260008051602061276e8339815191526020908152604080832060008051602061278e83398151915290925282206006810154919290916113c790620f42406124e8565b83546040516323b872dd60e01b81526001600160a01b0388811660048301523060248301526044820184905292935060009262010000909204909116906323b872dd906064016020604051808303816000875af115801561142c573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061145091906124b3565b9050806114ba5760405162461bcd60e51b815260206004820152603260248201527f436f6e747269627574696f6e206661696c65642c2064696420796f7520617070604482015271726f766520737461626c6520746f6b656e3f60701b6064820152608401610224565b6001600160a01b0385166000818152600786016020526040808220805460ff19166001179055600487015490519092918a917fe1122b3cea22012386ebf236fc23dd8a783b91c046d5dec812901846464624ae9190a450505050505050565b600081815260008051602061278e83398151915260205260409020546001600160a01b0362010000909104163314610cdb5760405162461bcd60e51b8152602060048201526024808201527f5465726d4f776e61626c653a2063616c6c6572206973206e6f7420746865206f6044820152633bb732b960e11b6064820152608401610224565b600060008051602061276e83398151915260008381526020919091526040808220905163d8f8e99160e01b815260048101859052909250309063d8f8e99190602401602060405180830381865afa1580156115fe573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061162291906123f0565b905060008260010180548060200260200160405190810160405280929190818152602001828054801561167e57602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311611660575b505083519394506000925050505b8181101561049f5760008382815181106116a8576116a861249d565b60200260200101519050806001600160a01b0316856001600160a01b0316036116d4575060010161168c565b6001600160a01b038116600090815260088701602052604090205460ff16801561171957506001600160a01b038116600090815260078701602052604090205460ff16155b801561174f575060048601546000908152600c8701602090815260408083206001600160a01b038516845290915290205460ff16155b1561175f5761175f878283611f80565b5060010161168c565b600082815260008051602061276e833981519152602052604090208054600490610100900460ff16818111156117a0576117a06123ca565b036117db5760405162461bcd60e51b815260206004820152600b60248201526a119d5b990818db1bdcd95960aa1b6044820152606401610224565b80548290829061ff0019166101008360048111156117fb576117fb6123ca565b0217905550816004811115611812576118126123ca565b600482015460405185907fe515107ce875160b9ed93bfd1367820d3ffbf412cd63d05140f6bc5535b51de390600090a4505050565b600061185c836001600160a01b0384166120b0565b9392505050565b600061185c836001600160a01b0384166120ff565b6001600160a01b0381166000908152600183016020526040812054151561185c565b600082815260008051602061276e83398151915260205260408120906118c3600d830184611863565b9050806118da576118d782600f0184611863565b90505b806119205760405162461bcd60e51b815260206004820152601660248201527521b0b713ba103932b6b7bb32903232b330bab63a32b960511b6044820152606401610224565b61192d8260110184611847565b50826001600160a01b03168260040154857f482c1cb26174abc97f4629d6f41ab133dbda268210ea1ced6c07c27857469a0360405160405180910390a450505050565b600281015460405163d8f8e99160e01b8152600091309163d8f8e9919161199d9160040190815260200190565b602060405180830381865afa1580156119ba573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906119de91906123f0565b905060006119ee846011016121f2565b1115611ae857600030632081c1af84611a09601188016121fc565b6040518363ffffffff1660e01b8152600401611a269291906125a0565b6000604051808303816000875af1158015611a45573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052611a6d9190810190612662565b805190915060005b81811015611ae45760006001600160a01b0316838281518110611a9a57611a9a61249d565b60200260200101516001600160a01b031603611ab857600101611a75565b611adc8686858481518110611acf57611acf61249d565b6020026020010151612209565b600101611a75565b5050505b611af583600d0182611863565b15611b0957611b0783600f0182611847565b505b6001600160a01b03811660009081526006840160209081526040808320805460ff19166001908117909155860180548251818502810185019093528083528493830182828015611b8257602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311611b64575b505083519394506000925050505b81811015611bf257866007016000848381518110611bb057611bb061249d565b6020908102919091018101516001600160a01b031682528101919091526040016000205460ff1615611bea5783611be681612727565b9450505b600101611b90565b50604080516101608101909152855460ff80821615158352611cb69291889160208401916101009004166003811115611c2d57611c2d6123ca565b6003811115611c3e57611c3e6123ca565b815281546001600160a01b036201000090910481166020830152600183015460408301526002830154606083015260038301546080830152600483015460a0830152600583015460c0830152600683015460e0830152600783015461010083015260089092015490911661012090910152878661122f565b50828560060154611cc791906124e8565b611cd490620f42406124e8565b6001600160a01b038516600090815260098801602052604081208054909190611cfe90849061248a565b909155505060028501546040516001600160a01b03861691907f1f2267669c1e46109302869b7cd09b21fd5ac4d2da01a6bbc086c1fe7b997fa390600090a361049f85600201546003611768565b600081815260008051602061276e8339815191526020908152604080832060008051602061278e833981519152909252909120426003830155805461ff001916610300178155611d9d836004611768565b6040516339007b7760e01b81526004810184905230906339007b7790602401600060405180830381600087803b158015611dd657600080fd5b505af115801561049d573d6000803e3d6000fd5b600081815260008051602061276e8339815191526020908152604080832060008051602061278e833981519152909252909120600282015460048301546005830154611e3691906124e8565b611e40919061248a565b4211611e8e5760405162461bcd60e51b815260206004820152601c60248201527f546f6f206561726c7920746f207374617274206e6577206379636c65000000006044820152606401610224565b60008254610100900460ff166004811115611eab57611eab6123ca565b1480611ed1575060038254610100900460ff166004811115611ecf57611ecf6123ca565b145b611eed5760405162461bcd60e51b81526004016102249061240d565b8160040160008154611efe90612727565b90915550600182015460005b81811015611f6b576000846007016000866001018481548110611f2f57611f2f61249d565b6000918252602080832091909101546001600160a01b031683528201929092526040019020805460ff1916911515919091179055600101611f0a565b50611f77846001611768565b610f0f8461159f565b600083815260008051602061276e8339815191526020908152604080832060008051602061278e8339815191529092528220600681015491929091611fc890620f42406124e8565b83546040516323b872dd60e01b81526001600160a01b0388811660048301523060248301526044820184905292935062010000909104909116906323b872dd906064016020604051808303816000875af1925050508015612046575060408051601f3d908101601f19168201909252612043918101906124b3565b60015b1561049f57801561049d576001600160a01b0385166000818152600786016020526040808220805460ff19166001179055600487015490519092918a917fe1122b3cea22012386ebf236fc23dd8a783b91c046d5dec812901846464624ae9190a450505050505050565b60008181526001830160205260408120546120f757508154600181810184556000848152602080822090930184905584548482528286019093526040902091909155610f4c565b506000610f4c565b600081815260018301602052604081205480156121e85760006121236001836124d5565b8554909150600090612137906001906124d5565b905081811461219c5760008660000182815481106121575761215761249d565b906000526020600020015490508087600001848154811061217a5761217a61249d565b6000918252602080832090910192909255918252600188019052604090208390555b85548690806121ad576121ad612740565b600190038181906000526020600020016000905590558560010160008681526020019081526020016000206000905560019350505050610f4c565b6000915050610f4c565b6000610f4c825490565b6060600061185c83612310565b6001600160a01b038116600090815260058401602052604090205460ff16801561223b575061223b8360110182611863565b61227d5760405162461bcd60e51b8152602060048201526013602482015272115e1c195b1b185b9d081b9bdd08199bdd5b99606a1b6044820152606401610224565b6001600160a01b03811660009081526005840160205260408120805460ff191690556004830180549091906122b190612756565b909155506013830180546000906122c790612727565b90915550600483015460028301546040516001600160a01b0384169291907f75072bae902443c91c7fe516bbb4da2a101e088aa10737ec2ecb7aa3beb023d190600090a4505050565b60608160000180548060200260200160405190810160405280929190818152602001828054801561236057602002820191906000526020600020905b81548152602001906001019080831161234c575b50505050509050919050565b60006020828403121561237e57600080fd5b5035919050565b6001600160a01b0381168114610cdb57600080fd5b600080604083850312156123ad57600080fd5b8235915060208301356123bf81612385565b809150509250929050565b634e487b7160e01b600052602160045260246000fd5b80516123eb81612385565b919050565b60006020828403121561240257600080fd5b815161185c81612385565b6020808252600b908201526a57726f6e6720737461746560a81b604082015260600190565b60208082526022908201527f5061727469636970616e74206973206578656d707465642074686973206379636040820152616c6560f01b606082015260800190565b634e487b7160e01b600052601160045260246000fd5b80820180821115610f4c57610f4c612474565b634e487b7160e01b600052603260045260246000fd5b6000602082840312156124c557600080fd5b8151801515811461185c57600080fd5b81810381811115610f4c57610f4c612474565b8082028115828204841417610f4c57610f4c612474565b60006020828403121561251157600080fd5b5051919050565b60008261253557634e487b7160e01b600052601260045260246000fd5b500490565b6004811061255857634e487b7160e01b600052602160045260246000fd5b9052565b600081518084526020808501945080840160005b838110156125955781516001600160a01b031687529582019590820190600101612570565b509495945050505050565b600061018084546125b58460ff831615159052565b6125c86020850160ff8360081c1661253a565b60101c6001600160a01b0390811660408501526001860154606085015260028601546080850152600386015460a0850152600486015460c0850152600586015460e08501526006860154610100850152600786015461012085015260088601541661014084015261016083018190526126438184018561255c565b95945050505050565b634e487b7160e01b600052604160045260246000fd5b6000602080838503121561267557600080fd5b825167ffffffffffffffff8082111561268d57600080fd5b818501915085601f8301126126a157600080fd5b8151818111156126b3576126b361264c565b8060051b604051601f19603f830116810181811085821117156126d8576126d861264c565b6040529182528482019250838101850191888311156126f657600080fd5b938501935b8285101561271b5761270c856123e0565b845293850193928501926126fb565b98975050505050505050565b60006001820161273957612739612474565b5060010190565b634e487b7160e01b600052603160045260246000fd5b60008161276557612765612474565b50600019019056fe6751f7e27cecf86d7136f5749c224248cae80a39fafb59f8f6bf12c52816307c87101b21d556417ad2b8e8f2700dbad90721d5d50a1f435f2dee0b9dc981ac8aa26469706673582212202356159e32b8144e8dc9fe08e1f2ca55c7c91d179797d23866d5f8088f09d47764736f6c63430008120033",
  "deployedBytecode": "0x608060405234801561001057600080fd5b50600436106100935760003560e01c80637be2ecea116100665780637be2ecea146100e657806384431629146100f9578063e9783e601461010c578063ea28b9bb14610134578063f7af18f61461014757600080fd5b80630cee1725146100985780632009844b146100ad5780634b5c9c80146100c057806358733dec146100d3575b600080fd5b6100ab6100a636600461236c565b61015d565b005b6100ab6100bb36600461236c565b6104a7565b6100ab6100ce36600461236c565b6106b9565b6100ab6100e136600461236c565b610911565b6100ab6100f436600461236c565b610cd2565b6100ab61010736600461239a565b610cde565b61011f61011a36600461239a565b610f15565b60405190151581526020015b60405180910390f35b6100ab61014236600461236c565b610f52565b61014f600281565b60405190815260200161012b565b600081815260008051602061276e833981519152602090815260408083207f35fa70a6f9ae8a4d427ebe0c1be62ffd2870fecc1df41c6fda0bf5803e5628889092529091208154600490610100900460ff16818111156101bf576101bf6123ca565b14806101dc575033600090815260068301602052604090205460ff165b61022d5760405162461bcd60e51b815260206004820152601960248201527f596f75206d75737420626520612062656e65666963696172790000000000000060448201526064015b60405180910390fd5b336000908152600983016020908152604080832054600a8601835281842054600686019093529220549115159160ff909116901515828061026b5750815b806102735750805b6102b55760405162461bcd60e51b81526020600482015260136024820152724e6f7468696e6720746f20776974686472617760681b6044820152606401610224565b82156102c5576102c58633611049565b80156103235760405163ae483d0760e01b815260048101879052336024820152309063ae483d0790604401600060405180830381600087803b15801561030a57600080fd5b505af115801561031e573d6000803e3d6000fd5b505050505b811561049f57600086815260008051602061278e8339815191526020908152604080832081516101608101909252805460ff8082161515845261040394840191610100900416600381111561037a5761037a6123ca565b600381111561038b5761038b6123ca565b815281546001600160a01b036201000090910481166020830152600183015460408301526002830154606083015260038301546080830152600483015460a0830152600583015460c0830152600683015460e0830152600783015461010083015260089092015490911661012090910152873361122f565b905060048654610100900460ff166004811115610422576104226123ca565b146104935780156104935760405162461bcd60e51b815260206004820152603560248201527f4e656564206174206c6561737420312e3152434320636f6c6c61746572616c206044820152741d1bc81d5b999c99595e99481e5bdd5c88199d5b99605a1b6064820152608401610224565b61049d8733611049565b505b505050505050565b600060008051602061276e83398151915260008381526020919091526040808220905163d8f8e99160e01b815260048101859052909250309063d8f8e99190602401602060405180830381865afa158015610506573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061052a91906123f0565b905060018254610100900460ff166004811115610549576105496123ca565b146105665760405162461bcd60e51b81526004016102249061240d565b33600090815260058301602052604090205460ff166105bb5760405162461bcd60e51b8152602060048201526011602482015270139bdd0818481c185c9d1a58da5c185b9d607a1b6044820152606401610224565b336001600160a01b0382160361060d5760405162461bcd60e51b815260206004820152601760248201527642656e656669636961727920646f65736e27742070617960481b6044820152606401610224565b33600090815260078301602052604090205460ff16156106685760405162461bcd60e51b8152602060048201526016602482015275416c7265616479207061696420666f72206379636c6560501b6044820152606401610224565b60048201546000908152600c83016020908152604080832033845290915290205460ff16156106a95760405162461bcd60e51b815260040161022490612432565b6106b483333361137f565b505050565b806106c381611519565b600082815260008051602061276e833981519152602052604090208054600490610100900460ff16818111156106fb576106fb6123ca565b148015610718575060038101546107159062ed4e0061248a565b42115b6107565760405162461bcd60e51b815260206004820152600f60248201526e10d85b89dd08195b5c1d1e481e595d608a1b6044820152606401610224565b6001810154600090815b818110156108475760008460090160008660010184815481106107855761078561249d565b60009182526020808320909101546001600160a01b03168352820192909252604001902054111561083f578360090160008560010183815481106107cb576107cb61249d565b60009182526020808320909101546001600160a01b031683528201929092526040019020546107fa908461248a565b925060008460090160008660010184815481106108195761081961249d565b60009182526020808320909101546001600160a01b031683528201929092526040019020555b600101610760565b50811561090a57825460405163a9059cbb60e01b8152336004820152602481018490526000916201000090046001600160a01b03169063a9059cbb906044016020604051808303816000875af11580156108a5573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906108c991906124b3565b90508061049f5760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b6044820152606401610224565b5050505050565b600081815260008051602061276e8339815191526020908152604080832060008051602061278e83398151915290925290912060078101546002830154600484015461095f906001906124d5565b836005015461096e91906124e8565b610978919061248a565b610982919061248a565b42116109d05760405162461bcd60e51b815260206004820152601860248201527f5374696c6c2074696d6520746f20636f6e7472696275746500000000000000006044820152606401610224565b60018254610100900460ff1660048111156109ed576109ed6123ca565b14610a0a5760405162461bcd60e51b81526004016102249061240d565b60405163d8f8e99160e01b815260048101849052600090309063d8f8e99190602401602060405180830381865afa158015610a49573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610a6d91906123f0565b9050610a788461159f565b610a83846002611768565b600083600101805480602002602001604051908101604052809291908181526020018280548015610add57602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311610abf575b50508351600489015494955093925060009150505b82811015610caf576000848281518110610b0e57610b0e61249d565b60200260200101519050856001600160a01b0316816001600160a01b03161480610b5c57506000838152600c8901602090815260408083206001600160a01b038516845290915290205460ff165b15610b6a5750600101610af2565b6001600160a01b038116600090815260078901602052604090205460ff1615610be5576001600160a01b038116600090815260068901602052604090205460ff1615610bc357610bbd88600f0182611847565b50610bd2565b610bd088600d0182611847565b505b610bdf8860110182611863565b50610ca6565b610bf28860110182611878565b610ca65760405163d7992e5b60e01b8152600481018a90526001600160a01b0387166024820152309063d7992e5b90604401602060405180830381865afa158015610c41573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610c6591906124b3565b15610c9c576001600160a01b038116600090815260068901602052604090205460ff1615610c9757610c97898261189a565b610ca6565b610ca6898261189a565b50600101610af2565b50610cba8686611970565b856014015486600401541061049d5761049d87611d4c565b610cdb81611dea565b50565b600060008051602061276e83398151915260008481526020919091526040808220905163d8f8e99160e01b815260048101869052909250309063d8f8e99190602401602060405180830381865afa158015610d3d573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610d6191906123f0565b905060018254610100900460ff166004811115610d8057610d806123ca565b14610d9d5760405162461bcd60e51b81526004016102249061240d565b6001600160a01b038316600090815260058301602052604090205460ff16610dfb5760405162461bcd60e51b8152602060048201526011602482015270139bdd0818481c185c9d1a58da5c185b9d607a1b6044820152606401610224565b826001600160a01b0316816001600160a01b031603610e565760405162461bcd60e51b815260206004820152601760248201527642656e656669636961727920646f65736e27742070617960481b6044820152606401610224565b6001600160a01b038316600090815260078301602052604090205460ff1615610eba5760405162461bcd60e51b8152602060048201526016602482015275416c7265616479207061696420666f72206379636c6560501b6044820152606401610224565b60048201546000908152600c8301602090815260408083206001600160a01b038716845290915290205460ff1615610f045760405162461bcd60e51b815260040161022490612432565b610f0f84338561137f565b50505050565b600082815260008051602061276e833981519152602090815260408083206001600160a01b038516845260060190915290205460ff165b92915050565b60008181527f35fa70a6f9ae8a4d427ebe0c1be62ffd2870fecc1df41c6fda0bf5803e5628886020908152604080832060008051602061276e83398151915283528184203385526004820190935292205460ff16610ff25760405162461bcd60e51b815260206004820152601d60248201527f50617920636f6c6c61746572616c2073656375726974792066697273740000006044820152606401610224565b336000818152600883016020526040808220805460ff81161560ff199091168117909155905190928392909187917f8bd3cffd2d87eca262a8e2d638c1ff3d3b61c604208115af6295b089acaf72b991a450505050565b600060008051602061276e8339815191526000848152602091825260408082206001600160a01b0386811684526009820190945281832054815492516370a0823160e01b81523060048201529195509362010000909204909116906370a0823190602401602060405180830381865afa1580156110ca573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906110ee91906124ff565b90508181101561111b5760405163cf47918160e01b81526004810182905260248101839052604401610224565b6001600160a01b0384811660008181526009860160205260408082208290558654905163a9059cbb60e01b8152600481019390935260248301869052909262010000909104169063a9059cbb906044016020604051808303816000875af115801561118a573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906111ae91906124b3565b9050806111ef5760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b6044820152606401610224565b5081846001600160a01b0316867f31b332de0dccb2d0ed351b3d65a9e10b099b3e3c63f4a6f5ea1810b4d757795c60405160405180910390a45050505050565b60808301805160009081527f35fa70a6f9ae8a4d427ebe0c1be62ffd2870fecc1df41c6fda0bf5803e56288860205260408082209251905163f0d826e760e01b815260048101919091529091908290309063f0d826e790602401602060405180830381865afa1580156112a6573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906112ca91906124ff565b9050600060646112db83606e6124e8565b6112e59190612518565b6001600160a01b0386166000908152600585016020526040902054909150811115611334576001600160a01b0385166000908152600a870160205260409020805460ff19166001179055611357565b6001600160a01b0385166000908152600a870160205260409020805460ff191690555b505050506001600160a01b03166000908152600a91909101602052604090205460ff16919050565b600083815260008051602061276e8339815191526020908152604080832060008051602061278e83398151915290925282206006810154919290916113c790620f42406124e8565b83546040516323b872dd60e01b81526001600160a01b0388811660048301523060248301526044820184905292935060009262010000909204909116906323b872dd906064016020604051808303816000875af115801561142c573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061145091906124b3565b9050806114ba5760405162461bcd60e51b815260206004820152603260248201527f436f6e747269627574696f6e206661696c65642c2064696420796f7520617070604482015271726f766520737461626c6520746f6b656e3f60701b6064820152608401610224565b6001600160a01b0385166000818152600786016020526040808220805460ff19166001179055600487015490519092918a917fe1122b3cea22012386ebf236fc23dd8a783b91c046d5dec812901846464624ae9190a450505050505050565b600081815260008051602061278e83398151915260205260409020546001600160a01b0362010000909104163314610cdb5760405162461bcd60e51b8152602060048201526024808201527f5465726d4f776e61626c653a2063616c6c6572206973206e6f7420746865206f6044820152633bb732b960e11b6064820152608401610224565b600060008051602061276e83398151915260008381526020919091526040808220905163d8f8e99160e01b815260048101859052909250309063d8f8e99190602401602060405180830381865afa1580156115fe573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061162291906123f0565b905060008260010180548060200260200160405190810160405280929190818152602001828054801561167e57602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311611660575b505083519394506000925050505b8181101561049f5760008382815181106116a8576116a861249d565b60200260200101519050806001600160a01b0316856001600160a01b0316036116d4575060010161168c565b6001600160a01b038116600090815260088701602052604090205460ff16801561171957506001600160a01b038116600090815260078701602052604090205460ff16155b801561174f575060048601546000908152600c8701602090815260408083206001600160a01b038516845290915290205460ff16155b1561175f5761175f878283611f80565b5060010161168c565b600082815260008051602061276e833981519152602052604090208054600490610100900460ff16818111156117a0576117a06123ca565b036117db5760405162461bcd60e51b815260206004820152600b60248201526a119d5b990818db1bdcd95960aa1b6044820152606401610224565b80548290829061ff0019166101008360048111156117fb576117fb6123ca565b0217905550816004811115611812576118126123ca565b600482015460405185907fe515107ce875160b9ed93bfd1367820d3ffbf412cd63d05140f6bc5535b51de390600090a4505050565b600061185c836001600160a01b0384166120b0565b9392505050565b600061185c836001600160a01b0384166120ff565b6001600160a01b0381166000908152600183016020526040812054151561185c565b600082815260008051602061276e83398151915260205260408120906118c3600d830184611863565b9050806118da576118d782600f0184611863565b90505b806119205760405162461bcd60e51b815260206004820152601660248201527521b0b713ba103932b6b7bb32903232b330bab63a32b960511b6044820152606401610224565b61192d8260110184611847565b50826001600160a01b03168260040154857f482c1cb26174abc97f4629d6f41ab133dbda268210ea1ced6c07c27857469a0360405160405180910390a450505050565b600281015460405163d8f8e99160e01b8152600091309163d8f8e9919161199d9160040190815260200190565b602060405180830381865afa1580156119ba573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906119de91906123f0565b905060006119ee846011016121f2565b1115611ae857600030632081c1af84611a09601188016121fc565b6040518363ffffffff1660e01b8152600401611a269291906125a0565b6000604051808303816000875af1158015611a45573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052611a6d9190810190612662565b805190915060005b81811015611ae45760006001600160a01b0316838281518110611a9a57611a9a61249d565b60200260200101516001600160a01b031603611ab857600101611a75565b611adc8686858481518110611acf57611acf61249d565b6020026020010151612209565b600101611a75565b5050505b611af583600d0182611863565b15611b0957611b0783600f0182611847565b505b6001600160a01b03811660009081526006840160209081526040808320805460ff19166001908117909155860180548251818502810185019093528083528493830182828015611b8257602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311611b64575b505083519394506000925050505b81811015611bf257866007016000848381518110611bb057611bb061249d565b6020908102919091018101516001600160a01b031682528101919091526040016000205460ff1615611bea5783611be681612727565b9450505b600101611b90565b50604080516101608101909152855460ff80821615158352611cb69291889160208401916101009004166003811115611c2d57611c2d6123ca565b6003811115611c3e57611c3e6123ca565b815281546001600160a01b036201000090910481166020830152600183015460408301526002830154606083015260038301546080830152600483015460a0830152600583015460c0830152600683015460e0830152600783015461010083015260089092015490911661012090910152878661122f565b50828560060154611cc791906124e8565b611cd490620f42406124e8565b6001600160a01b038516600090815260098801602052604081208054909190611cfe90849061248a565b909155505060028501546040516001600160a01b03861691907f1f2267669c1e46109302869b7cd09b21fd5ac4d2da01a6bbc086c1fe7b997fa390600090a361049f85600201546003611768565b600081815260008051602061276e8339815191526020908152604080832060008051602061278e833981519152909252909120426003830155805461ff001916610300178155611d9d836004611768565b6040516339007b7760e01b81526004810184905230906339007b7790602401600060405180830381600087803b158015611dd657600080fd5b505af115801561049d573d6000803e3d6000fd5b600081815260008051602061276e8339815191526020908152604080832060008051602061278e833981519152909252909120600282015460048301546005830154611e3691906124e8565b611e40919061248a565b4211611e8e5760405162461bcd60e51b815260206004820152601c60248201527f546f6f206561726c7920746f207374617274206e6577206379636c65000000006044820152606401610224565b60008254610100900460ff166004811115611eab57611eab6123ca565b1480611ed1575060038254610100900460ff166004811115611ecf57611ecf6123ca565b145b611eed5760405162461bcd60e51b81526004016102249061240d565b8160040160008154611efe90612727565b90915550600182015460005b81811015611f6b576000846007016000866001018481548110611f2f57611f2f61249d565b6000918252602080832091909101546001600160a01b031683528201929092526040019020805460ff1916911515919091179055600101611f0a565b50611f77846001611768565b610f0f8461159f565b600083815260008051602061276e8339815191526020908152604080832060008051602061278e8339815191529092528220600681015491929091611fc890620f42406124e8565b83546040516323b872dd60e01b81526001600160a01b0388811660048301523060248301526044820184905292935062010000909104909116906323b872dd906064016020604051808303816000875af1925050508015612046575060408051601f3d908101601f19168201909252612043918101906124b3565b60015b1561049f57801561049d576001600160a01b0385166000818152600786016020526040808220805460ff19166001179055600487015490519092918a917fe1122b3cea22012386ebf236fc23dd8a783b91c046d5dec812901846464624ae9190a450505050505050565b60008181526001830160205260408120546120f757508154600181810184556000848152602080822090930184905584548482528286019093526040902091909155610f4c565b506000610f4c565b600081815260018301602052604081205480156121e85760006121236001836124d5565b8554909150600090612137906001906124d5565b905081811461219c5760008660000182815481106121575761215761249d565b906000526020600020015490508087600001848154811061217a5761217a61249d565b6000918252602080832090910192909255918252600188019052604090208390555b85548690806121ad576121ad612740565b600190038181906000526020600020016000905590558560010160008681526020019081526020016000206000905560019350505050610f4c565b6000915050610f4c565b6000610f4c825490565b6060600061185c83612310565b6001600160a01b038116600090815260058401602052604090205460ff16801561223b575061223b8360110182611863565b61227d5760405162461bcd60e51b8152602060048201526013602482015272115e1c195b1b185b9d081b9bdd08199bdd5b99606a1b6044820152606401610224565b6001600160a01b03811660009081526005840160205260408120805460ff191690556004830180549091906122b190612756565b909155506013830180546000906122c790612727565b90915550600483015460028301546040516001600160a01b0384169291907f75072bae902443c91c7fe516bbb4da2a101e088aa10737ec2ecb7aa3beb023d190600090a4505050565b60608160000180548060200260200160405190810160405280929190818152602001828054801561236057602002820191906000526020600020905b81548152602001906001019080831161234c575b50505050509050919050565b60006020828403121561237e57600080fd5b5035919050565b6001600160a01b0381168114610cdb57600080fd5b600080604083850312156123ad57600080fd5b8235915060208301356123bf81612385565b809150509250929050565b634e487b7160e01b600052602160045260246000fd5b80516123eb81612385565b919050565b60006020828403121561240257600080fd5b815161185c81612385565b6020808252600b908201526a57726f6e6720737461746560a81b604082015260600190565b60208082526022908201527f5061727469636970616e74206973206578656d707465642074686973206379636040820152616c6560f01b606082015260800190565b634e487b7160e01b600052601160045260246000fd5b80820180821115610f4c57610f4c612474565b634e487b7160e01b600052603260045260246000fd5b6000602082840312156124c557600080fd5b8151801515811461185c57600080fd5b81810381811115610f4c57610f4c612474565b8082028115828204841417610f4c57610f4c612474565b60006020828403121561251157600080fd5b5051919050565b60008261253557634e487b7160e01b600052601260045260246000fd5b500490565b6004811061255857634e487b7160e01b600052602160045260246000fd5b9052565b600081518084526020808501945080840160005b838110156125955781516001600160a01b031687529582019590820190600101612570565b509495945050505050565b600061018084546125b58460ff831615159052565b6125c86020850160ff8360081c1661253a565b60101c6001600160a01b0390811660408501526001860154606085015260028601546080850152600386015460a0850152600486015460c0850152600586015460e08501526006860154610100850152600786015461012085015260088601541661014084015261016083018190526126438184018561255c565b95945050505050565b634e487b7160e01b600052604160045260246000fd5b6000602080838503121561267557600080fd5b825167ffffffffffffffff8082111561268d57600080fd5b818501915085601f8301126126a157600080fd5b8151818111156126b3576126b361264c565b8060051b604051601f19603f830116810181811085821117156126d8576126d861264c565b6040529182528482019250838101850191888311156126f657600080fd5b938501935b8285101561271b5761270c856123e0565b845293850193928501926126fb565b98975050505050505050565b60006001820161273957612739612474565b5060010190565b634e487b7160e01b600052603160045260246000fd5b60008161276557612765612474565b50600019019056fe6751f7e27cecf86d7136f5749c224248cae80a39fafb59f8f6bf12c52816307c87101b21d556417ad2b8e8f2700dbad90721d5d50a1f435f2dee0b9dc981ac8aa26469706673582212202356159e32b8144e8dc9fe08e1f2ca55c7c91d179797d23866d5f8088f09d47764736f6c63430008120033",
  "devdoc": {
    "author": "Mohammed Haddouti",
    "details": "v3.0 (Diamond)",
    "errors": {
      "InsufficientBalance(uint256,uint256)": [
        {
          "params": {
            "available": "balance available.",
            "required": "requested amount to transfer."
          }
        }
      ]
    },
    "kind": "dev",
    "methods": {
      "closeFundingPeriod(uint256)": {
        "params": {
          "termId": "the id of the term"
        }
      },
      "emptyFundAfterEnd(uint256)": {
        "params": {
          "termId": "the id of the term"
        }
      },
      "isBeneficiary(uint256,address)": {
        "params": {
          "beneficiary": "the address of the participant to check",
          "termId": "the id of the term"
        },
        "returns": {
          "_0": "true if the participant is a beneficiary"
        }
      },
      "payContribution(uint256)": {
        "params": {
          "termId": "the id of the term"
        }
      },
      "payContributionOnBehalfOf(uint256,address)": {
        "params": {
          "participant": "the address the msg.sender is paying for, the address must be part of the fund",
          "termId": "the id of the term"
        }
      },
      "startNewCycle(uint256)": {
        "params": {
          "termId": "the id of the term"
        }
      },
      "toggleAutoPay(uint256)": {
        "params": {
          "termId": "the id of the term"
        }
      },
      "withdrawFund(uint256)": {
        "details": "This follows the pull-over-push pattern.",
        "params": {
          "termId": "the id of the term"
        }
      }
    },
    "title": "Takaturn Fund",
    "version": 1
  },
  "userdoc": {
    "errors": {
      "InsufficientBalance(uint256,uint256)": [
        {
          "notice": "Insufficient balance for transfer. Needed `required` but only `available` available."
        }
      ]
    },
    "kind": "user",
    "methods": {
      "closeFundingPeriod(uint256)": {
        "notice": "Must be called at the end of the contribution period after the time has passed by the owner"
      },
      "emptyFundAfterEnd(uint256)": {
        "notice": "allow the owner to empty the fund if there's any excess fund left after 180 days,         this with the assumption that beneficiaries can't claim it themselves due to losing their keys for example,         and prevent the fund to be stuck in limbo"
      },
      "payContribution(uint256)": {
        "notice": "This is the function participants call to pay the contribution"
      },
      "payContributionOnBehalfOf(uint256,address)": {
        "notice": "This function is here to give the possibility to pay using a different wallet"
      },
      "startNewCycle(uint256)": {
        "notice": "starts a new cycle manually called by the owner. Only the first cycle starts automatically upon deploy"
      },
      "toggleAutoPay(uint256)": {
        "notice": "function to enable/disable autopay"
      },
      "withdrawFund(uint256)": {
        "notice": "Called by the beneficiary to withdraw the fund"
      }
    },
    "notice": "This is used to operate the Takaturn fund",
    "version": 1
  },
  "storageLayout": {
    "storage": [],
    "types": null
  }
}