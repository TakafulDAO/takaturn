{
  "address": "0x7e7603503De57d338923D2c3942392E6D23FFF95",
  "abi": [
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "available",
          "type": "uint256"
        },
        {
          "internalType": "uint256",
          "name": "required",
          "type": "uint256"
        }
      ],
      "name": "InsufficientBalance",
      "type": "error"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "participant",
          "type": "address"
        },
        {
          "indexed": true,
          "internalType": "bool",
          "name": "enabled",
          "type": "bool"
        }
      ],
      "name": "OnAutoPayToggled",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "beneficiary",
          "type": "address"
        }
      ],
      "name": "OnBeneficiarySelected",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "expellant",
          "type": "address"
        }
      ],
      "name": "OnDefaulterExpelled",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "enum LibFundV2.FundStates",
          "name": "newState",
          "type": "uint8"
        }
      ],
      "name": "OnFundStateChanged",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "claimant",
          "type": "address"
        },
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "amount",
          "type": "uint256"
        }
      ],
      "name": "OnFundWithdrawn",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "payer",
          "type": "address"
        },
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "currentCycle",
          "type": "uint256"
        }
      ],
      "name": "OnPaidContribution",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "defaulter",
          "type": "address"
        }
      ],
      "name": "OnParticipantDefaulted",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "undefaulter",
          "type": "address"
        }
      ],
      "name": "OnParticipantUndefaulted",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        }
      ],
      "name": "OnTermStart",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        },
        {
          "indexed": true,
          "internalType": "uint256",
          "name": "newLength",
          "type": "uint256"
        }
      ],
      "name": "OnTotalParticipantsUpdated",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "address",
          "name": "previousTermOwner",
          "type": "address"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "newTermOwner",
          "type": "address"
        }
      ],
      "name": "TermOwnershipTransferred",
      "type": "event"
    },
    {
      "inputs": [],
      "name": "FUND_VERSION",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "",
          "type": "uint256"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "id",
          "type": "uint256"
        }
      ],
      "name": "closeFund",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "id",
          "type": "uint256"
        }
      ],
      "name": "closeFundingPeriod",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "id",
          "type": "uint256"
        }
      ],
      "name": "emptyFundAfterEnd",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "termId",
          "type": "uint256"
        }
      ],
      "name": "initFund",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "id",
          "type": "uint256"
        },
        {
          "internalType": "address",
          "name": "beneficiary",
          "type": "address"
        }
      ],
      "name": "isBeneficiary",
      "outputs": [
        {
          "internalType": "bool",
          "name": "",
          "type": "bool"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "id",
          "type": "uint256"
        }
      ],
      "name": "payContribution",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "id",
          "type": "uint256"
        },
        {
          "internalType": "address",
          "name": "participant",
          "type": "address"
        }
      ],
      "name": "payContributionOnBehalfOf",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "id",
          "type": "uint256"
        }
      ],
      "name": "selectBeneficiary",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "id",
          "type": "uint256"
        }
      ],
      "name": "startNewCycle",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "id",
          "type": "uint256"
        }
      ],
      "name": "toggleAutoPay",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "uint256",
          "name": "id",
          "type": "uint256"
        }
      ],
      "name": "withdrawFund",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    }
  ],
  "transactionHash": "0xb04656870d19882f1d65a6f57818de8b65cf6cf971287ab07f3f921ffd06c079",
  "receipt": {
    "to": "0x4e59b44847b379578588920cA78FbF26c0B4956C",
    "from": "0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266",
    "contractAddress": null,
    "transactionIndex": 0,
    "gasUsed": "2116651",
    "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    "blockHash": "0xe8471d7d571ae5e1b71a842358b544866f64e932cb939bc0e3e7720e024e83a2",
    "transactionHash": "0xb04656870d19882f1d65a6f57818de8b65cf6cf971287ab07f3f921ffd06c079",
    "logs": [],
    "blockNumber": 104233359,
    "cumulativeGasUsed": "2116651",
    "status": 1,
    "byzantium": true
  },
  "args": [],
  "numDeployments": 1,
  "solcInputHash": "be7b57ce45c34b546ad2dd923dcb09b5",
  "metadata": "{\"compiler\":{\"version\":\"0.8.18+commit.87f61d96\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"available\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"required\",\"type\":\"uint256\"}],\"name\":\"InsufficientBalance\",\"type\":\"error\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"participant\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"bool\",\"name\":\"enabled\",\"type\":\"bool\"}],\"name\":\"OnAutoPayToggled\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"beneficiary\",\"type\":\"address\"}],\"name\":\"OnBeneficiarySelected\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"expellant\",\"type\":\"address\"}],\"name\":\"OnDefaulterExpelled\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"enum LibFundV2.FundStates\",\"name\":\"newState\",\"type\":\"uint8\"}],\"name\":\"OnFundStateChanged\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"claimant\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"OnFundWithdrawn\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"payer\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"currentCycle\",\"type\":\"uint256\"}],\"name\":\"OnPaidContribution\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"defaulter\",\"type\":\"address\"}],\"name\":\"OnParticipantDefaulted\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"undefaulter\",\"type\":\"address\"}],\"name\":\"OnParticipantUndefaulted\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"}],\"name\":\"OnTermStart\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"newLength\",\"type\":\"uint256\"}],\"name\":\"OnTotalParticipantsUpdated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"previousTermOwner\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"newTermOwner\",\"type\":\"address\"}],\"name\":\"TermOwnershipTransferred\",\"type\":\"event\"},{\"inputs\":[],\"name\":\"FUND_VERSION\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"id\",\"type\":\"uint256\"}],\"name\":\"closeFund\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"id\",\"type\":\"uint256\"}],\"name\":\"closeFundingPeriod\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"id\",\"type\":\"uint256\"}],\"name\":\"emptyFundAfterEnd\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"termId\",\"type\":\"uint256\"}],\"name\":\"initFund\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"id\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"beneficiary\",\"type\":\"address\"}],\"name\":\"isBeneficiary\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"id\",\"type\":\"uint256\"}],\"name\":\"payContribution\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"id\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"participant\",\"type\":\"address\"}],\"name\":\"payContributionOnBehalfOf\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"id\",\"type\":\"uint256\"}],\"name\":\"selectBeneficiary\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"id\",\"type\":\"uint256\"}],\"name\":\"startNewCycle\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"id\",\"type\":\"uint256\"}],\"name\":\"toggleAutoPay\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"id\",\"type\":\"uint256\"}],\"name\":\"withdrawFund\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}],\"devdoc\":{\"author\":\"Mohammed Haddouti\",\"details\":\"v3.0 (Diamond)\",\"errors\":{\"InsufficientBalance(uint256,uint256)\":[{\"params\":{\"available\":\"balance available.\",\"required\":\"requested amount to transfer.\"}}]},\"kind\":\"dev\",\"methods\":{\"closeFund(uint256)\":{\"params\":{\"id\":\"the id of the term\"}},\"closeFundingPeriod(uint256)\":{\"params\":{\"id\":\"the id of the term\"}},\"emptyFundAfterEnd(uint256)\":{\"params\":{\"id\":\"the id of the term\"}},\"initFund(uint256)\":{\"params\":{\"termId\":\"the id of the term\"}},\"isBeneficiary(uint256,address)\":{\"params\":{\"beneficiary\":\"the address of the participant to check\",\"id\":\"the id of the term\"},\"returns\":{\"_0\":\"true if the participant is a beneficiary\"}},\"payContribution(uint256)\":{\"params\":{\"id\":\"the id of the term\"}},\"payContributionOnBehalfOf(uint256,address)\":{\"params\":{\"id\":\"the id of the term\",\"participant\":\"the address the msg.sender is paying for, the address must be part of the fund\"}},\"selectBeneficiary(uint256)\":{\"details\":\"This shouldn't happen, but is here in case there's an edge-case we didn't take into account, can possibly be removed in the future\",\"params\":{\"id\":\"the id of the term\"}},\"startNewCycle(uint256)\":{\"params\":{\"id\":\"the id of the term\"}},\"toggleAutoPay(uint256)\":{\"params\":{\"id\":\"the id of the term\"}},\"withdrawFund(uint256)\":{\"details\":\"This follows the pull-over-push pattern.\",\"params\":{\"id\":\"the id of the term\"}}},\"title\":\"Takaturn Fund\",\"version\":1},\"userdoc\":{\"errors\":{\"InsufficientBalance(uint256,uint256)\":[{\"notice\":\"Insufficient balance for transfer. Needed `required` but only `available` available.\"}]},\"kind\":\"user\",\"methods\":{\"closeFund(uint256)\":{\"notice\":\"called by the owner to close the fund for emergency reasons.\"},\"closeFundingPeriod(uint256)\":{\"notice\":\"Must be called at the end of the contribution period after the time has passed by the owner\"},\"emptyFundAfterEnd(uint256)\":{\"notice\":\"allow the owner to empty the fund if there's any excess fund left after 180 days,         this with the assumption that beneficiaries can't claim it themselves due to losing their keys for example,         and prevent the fund to be stuck in limbo\"},\"initFund(uint256)\":{\"notice\":\"called by the term to init the fund\"},\"payContribution(uint256)\":{\"notice\":\"This is the function participants call to pay the contribution\"},\"payContributionOnBehalfOf(uint256,address)\":{\"notice\":\"This function is here to give the possibility to pay using a different wallet\"},\"selectBeneficiary(uint256)\":{\"notice\":\"Fallback function, if the internal call fails somehow and the state gets stuck, allow owner to call the function again manually\"},\"startNewCycle(uint256)\":{\"notice\":\"starts a new cycle manually called by the owner. Only the first cycle starts automatically upon deploy\"},\"toggleAutoPay(uint256)\":{\"notice\":\"function to enable/disable autopay\"},\"withdrawFund(uint256)\":{\"notice\":\"Called by the beneficiary to withdraw the fund\"}},\"notice\":\"This is used to operate the Takaturn fund\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/version-2/facets/FundFacetV2.sol\":\"FundFacetV2\"},\"evmVersion\":\"paris\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\",\"useLiteralContent\":true},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[]},\"sources\":{\"@openzeppelin/contracts/token/ERC20/IERC20.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n// OpenZeppelin Contracts (last updated v4.9.0) (token/ERC20/IERC20.sol)\\n\\npragma solidity ^0.8.0;\\n\\n/**\\n * @dev Interface of the ERC20 standard as defined in the EIP.\\n */\\ninterface IERC20 {\\n    /**\\n     * @dev Emitted when `value` tokens are moved from one account (`from`) to\\n     * another (`to`).\\n     *\\n     * Note that `value` may be zero.\\n     */\\n    event Transfer(address indexed from, address indexed to, uint256 value);\\n\\n    /**\\n     * @dev Emitted when the allowance of a `spender` for an `owner` is set by\\n     * a call to {approve}. `value` is the new allowance.\\n     */\\n    event Approval(address indexed owner, address indexed spender, uint256 value);\\n\\n    /**\\n     * @dev Returns the amount of tokens in existence.\\n     */\\n    function totalSupply() external view returns (uint256);\\n\\n    /**\\n     * @dev Returns the amount of tokens owned by `account`.\\n     */\\n    function balanceOf(address account) external view returns (uint256);\\n\\n    /**\\n     * @dev Moves `amount` tokens from the caller's account to `to`.\\n     *\\n     * Returns a boolean value indicating whether the operation succeeded.\\n     *\\n     * Emits a {Transfer} event.\\n     */\\n    function transfer(address to, uint256 amount) external returns (bool);\\n\\n    /**\\n     * @dev Returns the remaining number of tokens that `spender` will be\\n     * allowed to spend on behalf of `owner` through {transferFrom}. This is\\n     * zero by default.\\n     *\\n     * This value changes when {approve} or {transferFrom} are called.\\n     */\\n    function allowance(address owner, address spender) external view returns (uint256);\\n\\n    /**\\n     * @dev Sets `amount` as the allowance of `spender` over the caller's tokens.\\n     *\\n     * Returns a boolean value indicating whether the operation succeeded.\\n     *\\n     * IMPORTANT: Beware that changing an allowance with this method brings the risk\\n     * that someone may use both the old and the new allowance by unfortunate\\n     * transaction ordering. One possible solution to mitigate this race\\n     * condition is to first reduce the spender's allowance to 0 and set the\\n     * desired value afterwards:\\n     * https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729\\n     *\\n     * Emits an {Approval} event.\\n     */\\n    function approve(address spender, uint256 amount) external returns (bool);\\n\\n    /**\\n     * @dev Moves `amount` tokens from `from` to `to` using the\\n     * allowance mechanism. `amount` is then deducted from the caller's\\n     * allowance.\\n     *\\n     * Returns a boolean value indicating whether the operation succeeded.\\n     *\\n     * Emits a {Transfer} event.\\n     */\\n    function transferFrom(address from, address to, uint256 amount) external returns (bool);\\n}\\n\",\"keccak256\":\"0x287b55befed2961a7eabd7d7b1b2839cbca8a5b80ef8dcbb25ed3d4c2002c305\",\"license\":\"MIT\"},\"@openzeppelin/contracts/utils/Context.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n// OpenZeppelin Contracts v4.4.1 (utils/Context.sol)\\n\\npragma solidity ^0.8.0;\\n\\n/**\\n * @dev Provides information about the current execution context, including the\\n * sender of the transaction and its data. While these are generally available\\n * via msg.sender and msg.data, they should not be accessed in such a direct\\n * manner, since when dealing with meta-transactions the account sending and\\n * paying for execution may not be the actual sender (as far as an application\\n * is concerned).\\n *\\n * This contract is only required for intermediate, library-like contracts.\\n */\\nabstract contract Context {\\n    function _msgSender() internal view virtual returns (address) {\\n        return msg.sender;\\n    }\\n\\n    function _msgData() internal view virtual returns (bytes calldata) {\\n        return msg.data;\\n    }\\n}\\n\",\"keccak256\":\"0xe2e337e6dde9ef6b680e07338c493ebea1b5fd09b43424112868e9cc1706bca7\",\"license\":\"MIT\"},\"@openzeppelin/contracts/utils/structs/EnumerableSet.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n// OpenZeppelin Contracts (last updated v4.9.0) (utils/structs/EnumerableSet.sol)\\n// This file was procedurally generated from scripts/generate/templates/EnumerableSet.js.\\n\\npragma solidity ^0.8.0;\\n\\n/**\\n * @dev Library for managing\\n * https://en.wikipedia.org/wiki/Set_(abstract_data_type)[sets] of primitive\\n * types.\\n *\\n * Sets have the following properties:\\n *\\n * - Elements are added, removed, and checked for existence in constant time\\n * (O(1)).\\n * - Elements are enumerated in O(n). No guarantees are made on the ordering.\\n *\\n * ```solidity\\n * contract Example {\\n *     // Add the library methods\\n *     using EnumerableSet for EnumerableSet.AddressSet;\\n *\\n *     // Declare a set state variable\\n *     EnumerableSet.AddressSet private mySet;\\n * }\\n * ```\\n *\\n * As of v3.3.0, sets of type `bytes32` (`Bytes32Set`), `address` (`AddressSet`)\\n * and `uint256` (`UintSet`) are supported.\\n *\\n * [WARNING]\\n * ====\\n * Trying to delete such a structure from storage will likely result in data corruption, rendering the structure\\n * unusable.\\n * See https://github.com/ethereum/solidity/pull/11843[ethereum/solidity#11843] for more info.\\n *\\n * In order to clean an EnumerableSet, you can either remove all elements one by one or create a fresh instance using an\\n * array of EnumerableSet.\\n * ====\\n */\\nlibrary EnumerableSet {\\n    // To implement this library for multiple types with as little code\\n    // repetition as possible, we write it in terms of a generic Set type with\\n    // bytes32 values.\\n    // The Set implementation uses private functions, and user-facing\\n    // implementations (such as AddressSet) are just wrappers around the\\n    // underlying Set.\\n    // This means that we can only create new EnumerableSets for types that fit\\n    // in bytes32.\\n\\n    struct Set {\\n        // Storage of set values\\n        bytes32[] _values;\\n        // Position of the value in the `values` array, plus 1 because index 0\\n        // means a value is not in the set.\\n        mapping(bytes32 => uint256) _indexes;\\n    }\\n\\n    /**\\n     * @dev Add a value to a set. O(1).\\n     *\\n     * Returns true if the value was added to the set, that is if it was not\\n     * already present.\\n     */\\n    function _add(Set storage set, bytes32 value) private returns (bool) {\\n        if (!_contains(set, value)) {\\n            set._values.push(value);\\n            // The value is stored at length-1, but we add 1 to all indexes\\n            // and use 0 as a sentinel value\\n            set._indexes[value] = set._values.length;\\n            return true;\\n        } else {\\n            return false;\\n        }\\n    }\\n\\n    /**\\n     * @dev Removes a value from a set. O(1).\\n     *\\n     * Returns true if the value was removed from the set, that is if it was\\n     * present.\\n     */\\n    function _remove(Set storage set, bytes32 value) private returns (bool) {\\n        // We read and store the value's index to prevent multiple reads from the same storage slot\\n        uint256 valueIndex = set._indexes[value];\\n\\n        if (valueIndex != 0) {\\n            // Equivalent to contains(set, value)\\n            // To delete an element from the _values array in O(1), we swap the element to delete with the last one in\\n            // the array, and then remove the last element (sometimes called as 'swap and pop').\\n            // This modifies the order of the array, as noted in {at}.\\n\\n            uint256 toDeleteIndex = valueIndex - 1;\\n            uint256 lastIndex = set._values.length - 1;\\n\\n            if (lastIndex != toDeleteIndex) {\\n                bytes32 lastValue = set._values[lastIndex];\\n\\n                // Move the last value to the index where the value to delete is\\n                set._values[toDeleteIndex] = lastValue;\\n                // Update the index for the moved value\\n                set._indexes[lastValue] = valueIndex; // Replace lastValue's index to valueIndex\\n            }\\n\\n            // Delete the slot where the moved value was stored\\n            set._values.pop();\\n\\n            // Delete the index for the deleted slot\\n            delete set._indexes[value];\\n\\n            return true;\\n        } else {\\n            return false;\\n        }\\n    }\\n\\n    /**\\n     * @dev Returns true if the value is in the set. O(1).\\n     */\\n    function _contains(Set storage set, bytes32 value) private view returns (bool) {\\n        return set._indexes[value] != 0;\\n    }\\n\\n    /**\\n     * @dev Returns the number of values on the set. O(1).\\n     */\\n    function _length(Set storage set) private view returns (uint256) {\\n        return set._values.length;\\n    }\\n\\n    /**\\n     * @dev Returns the value stored at position `index` in the set. O(1).\\n     *\\n     * Note that there are no guarantees on the ordering of values inside the\\n     * array, and it may change when more values are added or removed.\\n     *\\n     * Requirements:\\n     *\\n     * - `index` must be strictly less than {length}.\\n     */\\n    function _at(Set storage set, uint256 index) private view returns (bytes32) {\\n        return set._values[index];\\n    }\\n\\n    /**\\n     * @dev Return the entire set in an array\\n     *\\n     * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed\\n     * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that\\n     * this function has an unbounded cost, and using it as part of a state-changing function may render the function\\n     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.\\n     */\\n    function _values(Set storage set) private view returns (bytes32[] memory) {\\n        return set._values;\\n    }\\n\\n    // Bytes32Set\\n\\n    struct Bytes32Set {\\n        Set _inner;\\n    }\\n\\n    /**\\n     * @dev Add a value to a set. O(1).\\n     *\\n     * Returns true if the value was added to the set, that is if it was not\\n     * already present.\\n     */\\n    function add(Bytes32Set storage set, bytes32 value) internal returns (bool) {\\n        return _add(set._inner, value);\\n    }\\n\\n    /**\\n     * @dev Removes a value from a set. O(1).\\n     *\\n     * Returns true if the value was removed from the set, that is if it was\\n     * present.\\n     */\\n    function remove(Bytes32Set storage set, bytes32 value) internal returns (bool) {\\n        return _remove(set._inner, value);\\n    }\\n\\n    /**\\n     * @dev Returns true if the value is in the set. O(1).\\n     */\\n    function contains(Bytes32Set storage set, bytes32 value) internal view returns (bool) {\\n        return _contains(set._inner, value);\\n    }\\n\\n    /**\\n     * @dev Returns the number of values in the set. O(1).\\n     */\\n    function length(Bytes32Set storage set) internal view returns (uint256) {\\n        return _length(set._inner);\\n    }\\n\\n    /**\\n     * @dev Returns the value stored at position `index` in the set. O(1).\\n     *\\n     * Note that there are no guarantees on the ordering of values inside the\\n     * array, and it may change when more values are added or removed.\\n     *\\n     * Requirements:\\n     *\\n     * - `index` must be strictly less than {length}.\\n     */\\n    function at(Bytes32Set storage set, uint256 index) internal view returns (bytes32) {\\n        return _at(set._inner, index);\\n    }\\n\\n    /**\\n     * @dev Return the entire set in an array\\n     *\\n     * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed\\n     * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that\\n     * this function has an unbounded cost, and using it as part of a state-changing function may render the function\\n     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.\\n     */\\n    function values(Bytes32Set storage set) internal view returns (bytes32[] memory) {\\n        bytes32[] memory store = _values(set._inner);\\n        bytes32[] memory result;\\n\\n        /// @solidity memory-safe-assembly\\n        assembly {\\n            result := store\\n        }\\n\\n        return result;\\n    }\\n\\n    // AddressSet\\n\\n    struct AddressSet {\\n        Set _inner;\\n    }\\n\\n    /**\\n     * @dev Add a value to a set. O(1).\\n     *\\n     * Returns true if the value was added to the set, that is if it was not\\n     * already present.\\n     */\\n    function add(AddressSet storage set, address value) internal returns (bool) {\\n        return _add(set._inner, bytes32(uint256(uint160(value))));\\n    }\\n\\n    /**\\n     * @dev Removes a value from a set. O(1).\\n     *\\n     * Returns true if the value was removed from the set, that is if it was\\n     * present.\\n     */\\n    function remove(AddressSet storage set, address value) internal returns (bool) {\\n        return _remove(set._inner, bytes32(uint256(uint160(value))));\\n    }\\n\\n    /**\\n     * @dev Returns true if the value is in the set. O(1).\\n     */\\n    function contains(AddressSet storage set, address value) internal view returns (bool) {\\n        return _contains(set._inner, bytes32(uint256(uint160(value))));\\n    }\\n\\n    /**\\n     * @dev Returns the number of values in the set. O(1).\\n     */\\n    function length(AddressSet storage set) internal view returns (uint256) {\\n        return _length(set._inner);\\n    }\\n\\n    /**\\n     * @dev Returns the value stored at position `index` in the set. O(1).\\n     *\\n     * Note that there are no guarantees on the ordering of values inside the\\n     * array, and it may change when more values are added or removed.\\n     *\\n     * Requirements:\\n     *\\n     * - `index` must be strictly less than {length}.\\n     */\\n    function at(AddressSet storage set, uint256 index) internal view returns (address) {\\n        return address(uint160(uint256(_at(set._inner, index))));\\n    }\\n\\n    /**\\n     * @dev Return the entire set in an array\\n     *\\n     * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed\\n     * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that\\n     * this function has an unbounded cost, and using it as part of a state-changing function may render the function\\n     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.\\n     */\\n    function values(AddressSet storage set) internal view returns (address[] memory) {\\n        bytes32[] memory store = _values(set._inner);\\n        address[] memory result;\\n\\n        /// @solidity memory-safe-assembly\\n        assembly {\\n            result := store\\n        }\\n\\n        return result;\\n    }\\n\\n    // UintSet\\n\\n    struct UintSet {\\n        Set _inner;\\n    }\\n\\n    /**\\n     * @dev Add a value to a set. O(1).\\n     *\\n     * Returns true if the value was added to the set, that is if it was not\\n     * already present.\\n     */\\n    function add(UintSet storage set, uint256 value) internal returns (bool) {\\n        return _add(set._inner, bytes32(value));\\n    }\\n\\n    /**\\n     * @dev Removes a value from a set. O(1).\\n     *\\n     * Returns true if the value was removed from the set, that is if it was\\n     * present.\\n     */\\n    function remove(UintSet storage set, uint256 value) internal returns (bool) {\\n        return _remove(set._inner, bytes32(value));\\n    }\\n\\n    /**\\n     * @dev Returns true if the value is in the set. O(1).\\n     */\\n    function contains(UintSet storage set, uint256 value) internal view returns (bool) {\\n        return _contains(set._inner, bytes32(value));\\n    }\\n\\n    /**\\n     * @dev Returns the number of values in the set. O(1).\\n     */\\n    function length(UintSet storage set) internal view returns (uint256) {\\n        return _length(set._inner);\\n    }\\n\\n    /**\\n     * @dev Returns the value stored at position `index` in the set. O(1).\\n     *\\n     * Note that there are no guarantees on the ordering of values inside the\\n     * array, and it may change when more values are added or removed.\\n     *\\n     * Requirements:\\n     *\\n     * - `index` must be strictly less than {length}.\\n     */\\n    function at(UintSet storage set, uint256 index) internal view returns (uint256) {\\n        return uint256(_at(set._inner, index));\\n    }\\n\\n    /**\\n     * @dev Return the entire set in an array\\n     *\\n     * WARNING: This operation will copy the entire storage to memory, which can be quite expensive. This is designed\\n     * to mostly be used by view accessors that are queried without any gas fees. Developers should keep in mind that\\n     * this function has an unbounded cost, and using it as part of a state-changing function may render the function\\n     * uncallable if the set grows to a point where copying to memory consumes too much gas to fit in a block.\\n     */\\n    function values(UintSet storage set) internal view returns (uint256[] memory) {\\n        bytes32[] memory store = _values(set._inner);\\n        uint256[] memory result;\\n\\n        /// @solidity memory-safe-assembly\\n        assembly {\\n            result := store\\n        }\\n\\n        return result;\\n    }\\n}\\n\",\"keccak256\":\"0x9f4357008a8f7d8c8bf5d48902e789637538d8c016be5766610901b4bba81514\",\"license\":\"MIT\"},\"contracts/version-2/access/TermOwnable.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\r\\n// Copied from OpenZeppelin Contracts (last updated v4.9.0) (access/Ownable.sol)\\r\\n\\r\\npragma solidity 0.8.18;\\r\\n\\r\\nimport \\\"@openzeppelin/contracts/utils/Context.sol\\\";\\r\\n\\r\\nimport {LibTermV2} from \\\"../libraries/LibTermV2.sol\\\";\\r\\n\\r\\n/**\\r\\n * @dev Contract module which provides a basic access control mechanism, where\\r\\n * there is an account (an owner) that can be granted exclusive access to\\r\\n * specific functions.\\r\\n *\\r\\n * By default, the owner account will be the one that starts a new term. This\\r\\n * can later be changed with {transferOwnership}.\\r\\n *\\r\\n * This module is used through inheritance. It will make available the modifier\\r\\n * `onlyTermOwner`, which can be applied to your functions to restrict their use to\\r\\n * the owner.\\r\\n */\\r\\ncontract TermOwnable is Context {\\r\\n    event TermOwnershipTransferred(address indexed previousTermOwner, address indexed newTermOwner);\\r\\n\\r\\n    /**\\r\\n     * @dev Throws if called by any account other than the owner.\\r\\n     */\\r\\n    modifier onlyTermOwner(uint termId) {\\r\\n        _checkTermOwner(termId);\\r\\n        _;\\r\\n    }\\r\\n\\r\\n    /**\\r\\n     * @dev Returns the address of the current owner.\\r\\n     */\\r\\n    function _termOwner(uint termId) internal view virtual returns (address) {\\r\\n        return LibTermV2._termStorage().terms[termId].termOwner;\\r\\n    }\\r\\n\\r\\n    /**\\r\\n     * @dev Throws if the sender is not the owner.\\r\\n     */\\r\\n    function _checkTermOwner(uint termId) internal view virtual {\\r\\n        require(_termOwner(termId) == _msgSender(), \\\"TermOwnable: caller is not the owner\\\");\\r\\n    }\\r\\n\\r\\n    /**\\r\\n     * @dev Leaves the contract without owner. It will not be possible to call\\r\\n     * `onlyTermOwner` functions. Can only be called by the current owner.\\r\\n     *\\r\\n     * NOTE: Renouncing ownership will leave the contract without an owner,\\r\\n     * thereby disabling any functionality that is only available to the owner.\\r\\n     */\\r\\n    function _renounceTermOwnership(uint termId) internal virtual onlyTermOwner(termId) {\\r\\n        _transferTermOwnership(termId, address(0));\\r\\n    }\\r\\n\\r\\n    /**\\r\\n     * @dev Transfers ownership of the contract to a new account (`newOwner`).\\r\\n     * Can only be called by the current owner.\\r\\n     */\\r\\n    // function transferTermOwnership(\\r\\n    //     uint termId,\\r\\n    //     address newTermOwner\\r\\n    // ) internal virtual onlyTermOwner(termId) {\\r\\n    //     require(newTermOwner != address(0), \\\"Ownable: new owner is the zero address\\\");\\r\\n    //     _transferTermOwnership(termId, newTermOwner);\\r\\n    // }\\r\\n\\r\\n    /**\\r\\n     * @dev Transfers ownership of the contract to a new account (`newOwner`).\\r\\n     * Internal function without access restriction.\\r\\n     */\\r\\n    function _transferTermOwnership(\\r\\n        uint termId,\\r\\n        address newTermOwner\\r\\n    ) internal virtual onlyTermOwner(termId) {\\r\\n        require(newTermOwner != address(0), \\\"Ownable: new owner is the zero address\\\");\\r\\n        LibTermV2.Term storage term = LibTermV2._termStorage().terms[termId];\\r\\n        address oldOwner = term.termOwner;\\r\\n        term.termOwner = newTermOwner;\\r\\n        emit TermOwnershipTransferred(oldOwner, newTermOwner);\\r\\n    }\\r\\n}\\r\\n\",\"keccak256\":\"0xd10285b92b744da7681cf625c5551f9eaf1331d5054e45c79ad88f83f15a9920\",\"license\":\"MIT\"},\"contracts/version-2/facets/FundFacetV2.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0\\r\\n\\r\\npragma solidity 0.8.18;\\r\\n\\r\\nimport {IERC20} from \\\"@openzeppelin/contracts/token/ERC20/IERC20.sol\\\";\\r\\nimport {IFundV2} from \\\"../interfaces/IFundV2.sol\\\";\\r\\nimport {ICollateralV2} from \\\"../interfaces/ICollateralV2.sol\\\";\\r\\nimport {IGettersV2} from \\\"../interfaces/IGettersV2.sol\\\";\\r\\n\\r\\nimport {EnumerableSet} from \\\"@openzeppelin/contracts/utils/structs/EnumerableSet.sol\\\";\\r\\nimport {LibCollateralV2} from \\\"../libraries/LibCollateralV2.sol\\\";\\r\\nimport {LibFundV2} from \\\"../libraries/LibFundV2.sol\\\";\\r\\nimport {LibTermV2} from \\\"../libraries/LibTermV2.sol\\\";\\r\\n\\r\\nimport {TermOwnable} from \\\"../access/TermOwnable.sol\\\";\\r\\n\\r\\n/// @title Takaturn Fund\\r\\n/// @author Mohammed Haddouti\\r\\n/// @notice This is used to operate the Takaturn fund\\r\\n/// @dev v3.0 (Diamond)\\r\\ncontract FundFacetV2 is IFundV2, TermOwnable {\\r\\n    using EnumerableSet for EnumerableSet.AddressSet;\\r\\n\\r\\n    uint public constant FUND_VERSION = 2; // The version of the contract\\r\\n\\r\\n    event OnTermStart(uint indexed termId); // Emits when a new term starts, this also marks the start of the first cycle\\r\\n    event OnFundStateChanged(uint indexed termId, LibFundV2.FundStates indexed newState); // Emits when state has updated\\r\\n    event OnPaidContribution(uint indexed termId, address indexed payer, uint indexed currentCycle); // Emits when participant pays the contribution\\r\\n    event OnBeneficiarySelected(uint indexed termId, address indexed beneficiary); // Emits when beneficiary is selected for this cycle\\r\\n    event OnFundWithdrawn(uint indexed termId, address indexed claimant, uint indexed amount); // Emits when a chosen beneficiary claims their fund\\r\\n    event OnParticipantDefaulted(uint indexed termId, address indexed defaulter); // Emits when a participant didn't pay this cycle's contribution\\r\\n    event OnParticipantUndefaulted(uint indexed termId, address indexed undefaulter); // Emits when a participant was a defaulter before but started paying on time again for this cycle\\r\\n    event OnDefaulterExpelled(uint indexed termId, address indexed expellant); // Emits when a defaulter can't compensate with the collateral\\r\\n    event OnTotalParticipantsUpdated(uint indexed termId, uint indexed newLength); // Emits when the total participants lengths has changed from its initial value\\r\\n    event OnAutoPayToggled(uint indexed termId, address indexed participant, bool indexed enabled); // Emits when a participant succesfully toggles autopay\\r\\n\\r\\n    /// Insufficient balance for transfer. Needed `required` but only\\r\\n    /// `available` available.\\r\\n    /// @param available balance available.\\r\\n    /// @param required requested amount to transfer.\\r\\n    error InsufficientBalance(uint available, uint required);\\r\\n\\r\\n    /// @notice called by the term to init the fund\\r\\n    /// @param termId the id of the term\\r\\n    function initFund(uint termId) external {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[termId];\\r\\n        uint participantsArrayLength = fund.beneficiariesOrder.length;\\r\\n        // Set and track participants\\r\\n        for (uint i; i < participantsArrayLength; ) {\\r\\n            EnumerableSet.add(fund._participants, fund.beneficiariesOrder[i]);\\r\\n            fund.isParticipant[fund.beneficiariesOrder[i]] = true;\\r\\n            unchecked {\\r\\n                ++i;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        // Starts the first cycle\\r\\n        _startNewCycle(termId);\\r\\n\\r\\n        // Set timestamp of deployment, which will be used to determine cycle times\\r\\n        // We do this after starting the first cycle to make sure the first cycle starts smoothly\\r\\n        fund.fundStart = block.timestamp;\\r\\n        //emit LibFundV2.OnTermStart(termId);\\r\\n        emit OnTermStart(termId);\\r\\n    }\\r\\n\\r\\n    /// @notice starts a new cycle manually called by the owner. Only the first cycle starts automatically upon deploy\\r\\n    /// @param id the id of the term\\r\\n    function startNewCycle(uint id) external onlyTermOwner(id) {\\r\\n        _startNewCycle(id);\\r\\n    }\\r\\n\\r\\n    /// @notice Must be called at the end of the contribution period after the time has passed by the owner\\r\\n    /// @param id the id of the term\\r\\n    function closeFundingPeriod(uint id) external onlyTermOwner(id) {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[id];\\r\\n        LibTermV2.Term storage term = LibTermV2._termStorage().terms[id];\\r\\n        // Current cycle minus 1 because we use the previous cycle time as start point then add contribution period\\r\\n        require(\\r\\n            block.timestamp >\\r\\n                term.cycleTime * (fund.currentCycle - 1) + fund.fundStart + term.contributionPeriod,\\r\\n            \\\"Still time to contribute\\\"\\r\\n        );\\r\\n        require(fund.currentState == LibFundV2.FundStates.AcceptingContributions, \\\"Wrong state\\\");\\r\\n\\r\\n        // We attempt to make the autopayers pay their contribution right away\\r\\n        _autoPay(id);\\r\\n\\r\\n        // Only then start choosing beneficiary\\r\\n        _setState(id, LibFundV2.FundStates.ChoosingBeneficiary);\\r\\n\\r\\n        // We must check who hasn't paid and default them, check all participants based on beneficiariesOrder\\r\\n        // To maintain the order and to properly push defaulters to the back based on that same order\\r\\n        // And we make sure that existing defaulters are ignored\\r\\n        address[] memory currentParticipants = fund.beneficiariesOrder;\\r\\n\\r\\n        uint currentParticipantsLength = currentParticipants.length;\\r\\n\\r\\n        for (uint i; i < currentParticipantsLength; ) {\\r\\n            address p = currentParticipants[i];\\r\\n            if (fund.paidThisCycle[p]) {\\r\\n                // check where to restore the defaulter to, participants or beneficiaries\\r\\n                if (fund.isBeneficiary[p]) {\\r\\n                    EnumerableSet.add(fund._beneficiaries, p);\\r\\n                } else {\\r\\n                    EnumerableSet.add(fund._participants, p);\\r\\n                }\\r\\n\\r\\n                if (EnumerableSet.remove(fund._defaulters, p)) {\\r\\n                    emit OnParticipantUndefaulted(id, p);\\r\\n                }\\r\\n            } else if (!EnumerableSet.contains(fund._defaulters, p)) {\\r\\n                _defaultParticipant(id, p);\\r\\n            }\\r\\n            unchecked {\\r\\n                ++i;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        // Once we decided who defaulted and who paid, we can select the beneficiary for this cycle\\r\\n\\r\\n        _selectBeneficiary(id);\\r\\n        if (!(fund.currentCycle < fund.totalAmountOfCycles)) {\\r\\n            // If all cycles have passed, and the last cycle's time has passed, close the fund\\r\\n            _closeFund(id);\\r\\n            return;\\r\\n        }\\r\\n    }\\r\\n\\r\\n    /// @notice Fallback function, if the internal call fails somehow and the state gets stuck, allow owner to call the function again manually\\r\\n    /// @dev This shouldn't happen, but is here in case there's an edge-case we didn't take into account, can possibly be removed in the future\\r\\n    /// @param id the id of the term\\r\\n    function selectBeneficiary(uint id) external onlyTermOwner(id) {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[id];\\r\\n        require(fund.currentState == LibFundV2.FundStates.ChoosingBeneficiary, \\\"Wrong state\\\");\\r\\n        _selectBeneficiary(id);\\r\\n    }\\r\\n\\r\\n    /// @notice called by the owner to close the fund for emergency reasons.\\r\\n    /// @param id the id of the term\\r\\n    function closeFund(uint id) external onlyTermOwner(id) {\\r\\n        //require (!(currentCycle < totalAmountOfCycles), \\\"Not all cycles have happened yet\\\");\\r\\n        _closeFund(id);\\r\\n    }\\r\\n\\r\\n    /// @notice allow the owner to empty the fund if there's any excess fund left after 180 days,\\r\\n    ///         this with the assumption that beneficiaries can't claim it themselves due to losing their keys for example,\\r\\n    ///         and prevent the fund to be stuck in limbo\\r\\n    /// @param id the id of the term\\r\\n    function emptyFundAfterEnd(uint id) external onlyTermOwner(id) {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[id];\\r\\n        require(\\r\\n            fund.currentState == LibFundV2.FundStates.FundClosed &&\\r\\n                block.timestamp > fund.fundEnd + 180 days,\\r\\n            \\\"Can't empty yet\\\"\\r\\n        );\\r\\n\\r\\n        uint balance = fund.stableToken.balanceOf(address(this));\\r\\n        if (balance > 0) {\\r\\n            bool success = fund.stableToken.transfer(msg.sender, balance);\\r\\n            require(success, \\\"Transfer failed\\\");\\r\\n        }\\r\\n    }\\r\\n\\r\\n    /// @notice function to enable/disable autopay\\r\\n    /// @param id the id of the term\\r\\n    function toggleAutoPay(uint id) external {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[id];\\r\\n        require(fund.isParticipant[msg.sender], \\\"Not a participant\\\");\\r\\n        bool enabled = !fund.autoPayEnabled[msg.sender];\\r\\n        fund.autoPayEnabled[msg.sender] = enabled;\\r\\n\\r\\n        emit OnAutoPayToggled(id, msg.sender, enabled);\\r\\n    }\\r\\n\\r\\n    /// @notice This is the function participants call to pay the contribution\\r\\n    /// @param id the id of the term\\r\\n    function payContribution(uint id) external {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[id];\\r\\n        require(fund.currentState == LibFundV2.FundStates.AcceptingContributions, \\\"Wrong state\\\");\\r\\n        require(fund.isParticipant[msg.sender], \\\"Not a participant\\\");\\r\\n        require(!fund.paidThisCycle[msg.sender], \\\"Already paid for cycle\\\");\\r\\n        _payContribution(id, msg.sender, msg.sender);\\r\\n    }\\r\\n\\r\\n    /// @notice This function is here to give the possibility to pay using a different wallet\\r\\n    /// @param id the id of the term\\r\\n    /// @param participant the address the msg.sender is paying for, the address must be part of the fund\\r\\n    function payContributionOnBehalfOf(uint id, address participant) external {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[id];\\r\\n        require(fund.currentState == LibFundV2.FundStates.AcceptingContributions, \\\"Wrong state\\\");\\r\\n        require(fund.isParticipant[participant], \\\"Not a participant\\\");\\r\\n        require(!fund.paidThisCycle[participant], \\\"Already paid for cycle\\\");\\r\\n        _payContribution(id, msg.sender, participant);\\r\\n    }\\r\\n\\r\\n    /// @notice Called by the beneficiary to withdraw the fund\\r\\n    /// @dev This follows the pull-over-push pattern.\\r\\n    /// @param id the id of the term\\r\\n    function withdrawFund(uint id) external {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[id];\\r\\n        require(\\r\\n            fund.currentState == LibFundV2.FundStates.FundClosed || fund.paidThisCycle[msg.sender],\\r\\n            \\\"You must pay your cycle before withdrawing\\\"\\r\\n        );\\r\\n\\r\\n        bool hasFundPool = fund.beneficiariesPool[msg.sender] > 0;\\r\\n        (, , uint collateralPool) = IGettersV2(address(this)).getDepositorCollateralSummary(\\r\\n            msg.sender,\\r\\n            id\\r\\n        );\\r\\n        bool hasCollateralPool = collateralPool > 0;\\r\\n        require(hasFundPool || hasCollateralPool, \\\"Nothing to withdraw\\\");\\r\\n\\r\\n        if (hasFundPool) {\\r\\n            // Get the amount this beneficiary can withdraw\\r\\n            uint transferAmount = fund.beneficiariesPool[msg.sender];\\r\\n            uint contractBalance = fund.stableToken.balanceOf(address(this));\\r\\n            if (contractBalance < transferAmount) {\\r\\n                revert InsufficientBalance({available: contractBalance, required: transferAmount});\\r\\n            } else {\\r\\n                fund.beneficiariesPool[msg.sender] = 0;\\r\\n                bool success = fund.stableToken.transfer(msg.sender, transferAmount);\\r\\n                require(success, \\\"Transfer failed\\\");\\r\\n            }\\r\\n            emit OnFundWithdrawn(id, msg.sender, transferAmount);\\r\\n        }\\r\\n\\r\\n        if (hasCollateralPool) {\\r\\n            ICollateralV2(address(this)).withdrawReimbursement(id, msg.sender);\\r\\n        }\\r\\n    }\\r\\n\\r\\n    /// @param id the id of the term\\r\\n    /// @param beneficiary the address of the participant to check\\r\\n    /// @return true if the participant is a beneficiary\\r\\n    function isBeneficiary(uint id, address beneficiary) external view returns (bool) {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[id];\\r\\n        return fund.isBeneficiary[beneficiary];\\r\\n    }\\r\\n\\r\\n    /// @notice updates the state according to the input and makes sure the state can't be changed if the fund is closed. Also emits an event that this happened\\r\\n    /// @param _id The id of the term\\r\\n    /// @param _newState The new state of the fund\\r\\n    function _setState(uint _id, LibFundV2.FundStates _newState) internal {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[_id];\\r\\n        require(fund.currentState != LibFundV2.FundStates.FundClosed, \\\"Fund closed\\\");\\r\\n        fund.currentState = _newState;\\r\\n        emit OnFundStateChanged(_id, _newState);\\r\\n    }\\r\\n\\r\\n    /// @notice This starts the new cycle and can only be called internally. Used upon deploy\\r\\n    /// @param _id The id of the term\\r\\n    function _startNewCycle(uint _id) internal {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[_id];\\r\\n        LibTermV2.Term storage term = LibTermV2._termStorage().terms[_id];\\r\\n        // currentCycle is 0 when this is called for the first time\\r\\n        require(\\r\\n            block.timestamp > term.cycleTime * fund.currentCycle + fund.fundStart,\\r\\n            \\\"Too early to start new cycle\\\"\\r\\n        );\\r\\n        require(\\r\\n            fund.currentState == LibFundV2.FundStates.InitializingFund ||\\r\\n                fund.currentState == LibFundV2.FundStates.CycleOngoing,\\r\\n            \\\"Wrong state\\\"\\r\\n        );\\r\\n\\r\\n        ++fund.currentCycle;\\r\\n        uint length = fund.beneficiariesOrder.length;\\r\\n        for (uint i; i < length; ) {\\r\\n            fund.paidThisCycle[fund.beneficiariesOrder[i]] = false;\\r\\n            unchecked {\\r\\n                ++i;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        _setState(_id, LibFundV2.FundStates.AcceptingContributions);\\r\\n\\r\\n        // We attempt to make the autopayers pay their contribution right away\\r\\n        _autoPay(_id);\\r\\n    }\\r\\n\\r\\n    /// @notice function to attempt to make autopayers pay their contribution\\r\\n    /// @param _id the id of the term\\r\\n    function _autoPay(uint _id) internal {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[_id];\\r\\n        address[] memory autoPayers = fund.beneficiariesOrder; // use beneficiariesOrder because it is a single array with all participants\\r\\n        uint length = autoPayers.length;\\r\\n        for (uint i; i < length; ) {\\r\\n            if (fund.autoPayEnabled[autoPayers[i]] && !fund.paidThisCycle[autoPayers[i]]) {\\r\\n                _payContributionSafe(_id, autoPayers[i], autoPayers[i]);\\r\\n            }\\r\\n            unchecked {\\r\\n                ++i;\\r\\n            }\\r\\n        }\\r\\n    }\\r\\n\\r\\n    /// @notice function to pay the actual contribution for the cycle, used for autopay to prevent reverts\\r\\n    /// @param _id the id of the term\\r\\n    /// @param _payer the address that's paying\\r\\n    /// @param _participant the (participant) address that's being paid for\\r\\n    function _payContributionSafe(uint _id, address _payer, address _participant) internal {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[_id];\\r\\n        LibTermV2.Term storage term = LibTermV2._termStorage().terms[_id];\\r\\n\\r\\n        // Get the amount and do the actual transfer\\r\\n        // This will only succeed if the sender approved this contract address beforehand\\r\\n        uint amount = term.contributionAmount * 10 ** 6;\\r\\n        try fund.stableToken.transferFrom(_payer, address(this), amount) returns (bool success) {\\r\\n            if (success) {\\r\\n                // Finish up, set that the participant paid for this cycle and emit an event that it's been done\\r\\n                fund.paidThisCycle[_participant] = true;\\r\\n                emit OnPaidContribution(_id, _participant, fund.currentCycle);\\r\\n            }\\r\\n        } catch {}\\r\\n    }\\r\\n\\r\\n    /// @notice function to pay the actual contribution for the cycle\\r\\n    /// @param _id the id of the term\\r\\n    /// @param _payer the address that's paying\\r\\n    /// @param _participant the (participant) address that's being paid for\\r\\n    function _payContribution(uint _id, address _payer, address _participant) internal {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[_id];\\r\\n        LibTermV2.Term storage term = LibTermV2._termStorage().terms[_id];\\r\\n\\r\\n        // Get the amount and do the actual transfer\\r\\n        // This will only succeed if the sender approved this contract address beforehand\\r\\n        uint amount = term.contributionAmount * 10 ** 6;\\r\\n\\r\\n        bool success = fund.stableToken.transferFrom(_payer, address(this), amount);\\r\\n        require(success, \\\"Contribution failed, did you approve stable token?\\\");\\r\\n\\r\\n        // Finish up, set that the participant paid for this cycle and emit an event that it's been done\\r\\n        fund.paidThisCycle[_participant] = true;\\r\\n        emit OnPaidContribution(_id, _participant, fund.currentCycle);\\r\\n    }\\r\\n\\r\\n    /// @notice Default the participant/beneficiary by checking the mapping first, then remove them from the appropriate array\\r\\n    /// @param _id The id of the term\\r\\n    /// @param _defaulter The participant to default\\r\\n    function _defaultParticipant(uint _id, address _defaulter) internal {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[_id];\\r\\n        // Try removing from participants first\\r\\n        bool success = EnumerableSet.remove(fund._participants, _defaulter);\\r\\n\\r\\n        // If that fails, we try removing from beneficiaries\\r\\n        if (!success) {\\r\\n            success = EnumerableSet.remove(fund._beneficiaries, _defaulter);\\r\\n        }\\r\\n\\r\\n        require(success, \\\"Can't remove defaulter\\\");\\r\\n        EnumerableSet.add(fund._defaulters, _defaulter);\\r\\n\\r\\n        emit OnParticipantDefaulted(_id, _defaulter);\\r\\n    }\\r\\n\\r\\n    /// @notice The beneficiary will be selected here based on the beneficiariesOrder array.\\r\\n    /// @notice It will loop through the array and choose the first in line to be eligible to be beneficiary.\\r\\n    /// @param _id The id of the term\\r\\n    function _selectBeneficiary(uint _id) internal {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[_id];\\r\\n        LibTermV2.Term storage term = LibTermV2._termStorage().terms[_id];\\r\\n        // check if there are any participants left, else use the defaulters\\r\\n        address selectedBeneficiary; // By default initialization is address(0)\\r\\n        address[] memory arrayToCheck = fund.beneficiariesOrder;\\r\\n        uint arrayToCheckLength = arrayToCheck.length;\\r\\n        uint beneficiaryIndex; // By default uint initialization is 0;\\r\\n\\r\\n        for (uint i; i < arrayToCheckLength; ) {\\r\\n            address b = arrayToCheck[i];\\r\\n            if (!fund.isBeneficiary[b]) {\\r\\n                selectedBeneficiary = b;\\r\\n                beneficiaryIndex = i;\\r\\n                break;\\r\\n            }\\r\\n            unchecked {\\r\\n                ++i;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        // If the defaulter didn't pay this cycle, we move the first elligible beneficiary forward and everyone in between forward\\r\\n        if (!fund.paidThisCycle[selectedBeneficiary]) {\\r\\n            // Find the index of the beneficiary to move to the end\\r\\n            for (uint i = beneficiaryIndex; i < arrayToCheckLength; ) {\\r\\n                address b = arrayToCheck[i];\\r\\n                // Find the first eligible beneficiary\\r\\n                if (fund.paidThisCycle[b]) {\\r\\n                    selectedBeneficiary = b;\\r\\n                    address[] memory newOrder = fund.beneficiariesOrder;\\r\\n                    // Move each defaulter between current beneficiary and new beneficiary 1 position forward\\r\\n                    for (uint j = beneficiaryIndex; j < i; ) {\\r\\n                        newOrder[j + 1] = arrayToCheck[j];\\r\\n                        unchecked {\\r\\n                            ++j;\\r\\n                        }\\r\\n                    }\\r\\n                    // Move new beneficiary to original beneficiary's position\\r\\n                    newOrder[beneficiaryIndex] = selectedBeneficiary;\\r\\n                    fund.beneficiariesOrder = newOrder;\\r\\n                    break;\\r\\n                }\\r\\n                unchecked {\\r\\n                    ++i;\\r\\n                }\\r\\n            }\\r\\n        }\\r\\n\\r\\n        // Request contribution from the collateral for those who haven't paid this cycle\\r\\n        if (EnumerableSet.length(fund._defaulters) > 0) {\\r\\n            address[] memory expellants = ICollateralV2(address(this)).requestContribution(\\r\\n                _id,\\r\\n                selectedBeneficiary,\\r\\n                EnumerableSet.values(fund._defaulters)\\r\\n            );\\r\\n\\r\\n            uint expellantsLength = expellants.length;\\r\\n            for (uint i; i < expellantsLength; ) {\\r\\n                if (expellants[i] == address(0)) {\\r\\n                    unchecked {\\r\\n                        ++i;\\r\\n                    }\\r\\n                    continue;\\r\\n                }\\r\\n                _expelDefaulter(_id, expellants[i]);\\r\\n                unchecked {\\r\\n                    ++i;\\r\\n                }\\r\\n            }\\r\\n        }\\r\\n\\r\\n        // Remove participant from participants set..\\r\\n        if (EnumerableSet.remove(fund._participants, selectedBeneficiary)) {\\r\\n            // ..Then add them to the benificiaries set\\r\\n            EnumerableSet.add(fund._beneficiaries, selectedBeneficiary);\\r\\n        } // If this if-statement fails, this means we're dealing with a graced defaulter\\r\\n\\r\\n        // Update the mapping to track who's been beneficiary\\r\\n        fund.isBeneficiary[selectedBeneficiary] = true;\\r\\n\\r\\n        // Get the amount of participants that paid this cycle, and add that amount to the beneficiary's pool\\r\\n        uint paidCount;\\r\\n        address[] memory allParticipants = fund.beneficiariesOrder; // Use beneficiariesOrder here because it contains all active participants in a single array\\r\\n        for (uint i = 0; i < allParticipants.length; i++) {\\r\\n            if (fund.paidThisCycle[allParticipants[i]]) {\\r\\n                paidCount++;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        // Award the beneficiary with the pool and update the lastBeneficiary\\r\\n        // todo: check if this is correct\\r\\n        fund.beneficiariesPool[selectedBeneficiary] = term.contributionAmount * paidCount * 10 ** 6;\\r\\n        fund.lastBeneficiary = selectedBeneficiary;\\r\\n\\r\\n        emit OnBeneficiarySelected(_id, selectedBeneficiary);\\r\\n        _setState(_id, LibFundV2.FundStates.CycleOngoing);\\r\\n    }\\r\\n\\r\\n    /// @notice Called internally to move a defaulter in the beneficiariesOrder to the end, so that people who have paid get chosen first as beneficiary\\r\\n    /// @param _id The id of the term\\r\\n    /// @param _beneficiary The defaulter that could have been beneficiary\\r\\n    function _removeBeneficiaryFromOrder(uint _id, address _beneficiary) internal {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[_id];\\r\\n        address[] memory arrayToCheck = fund.beneficiariesOrder;\\r\\n        uint arrayToCheckLength = arrayToCheck.length;\\r\\n        address[] memory newArray = new address[](arrayToCheck.length - 1);\\r\\n        uint j;\\r\\n        for (uint i; i < arrayToCheckLength; ) {\\r\\n            address b = arrayToCheck[i];\\r\\n            if (b != _beneficiary) {\\r\\n                newArray[j] = b;\\r\\n                unchecked {\\r\\n                    ++j;\\r\\n                }\\r\\n            }\\r\\n            unchecked {\\r\\n                ++i;\\r\\n            }\\r\\n        }\\r\\n\\r\\n        fund.beneficiariesOrder = newArray;\\r\\n    }\\r\\n\\r\\n    /// @notice called internally to expel a participant. It should not be possible to expel non-defaulters, so those arrays are not checked.\\r\\n    /// @param _id The id of the term\\r\\n    /// @param _expellant The address of the defaulter that will be expelled\\r\\n    function _expelDefaulter(uint _id, address _expellant) internal {\\r\\n        LibCollateralV2.Collateral storage collateral = LibCollateralV2\\r\\n            ._collateralStorage()\\r\\n            .collaterals[_id];\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[_id];\\r\\n        LibTermV2.Term storage term = LibTermV2._termStorage().terms[_id];\\r\\n        //require(msg.sender == address(collateral), \\\"Caller is not collateral\\\");\\r\\n        require(\\r\\n            fund.isParticipant[_expellant] && EnumerableSet.remove(fund._defaulters, _expellant),\\r\\n            \\\"Expellant not found\\\"\\r\\n        );\\r\\n\\r\\n        // Expellants should only be in the defauters set so no need to touch the other sets\\r\\n        //require(EnumerableSet.remove(_defaulters, expellant), \\\"Expellant not found\\\");\\r\\n\\r\\n        // Remove expellant from beneficiaries order\\r\\n        // Remove expellants from participants tracker and emit that they've been expelled\\r\\n        // Update the defaulters array\\r\\n        _removeBeneficiaryFromOrder(_id, _expellant);\\r\\n\\r\\n        fund.isParticipant[_expellant] = false;\\r\\n        emit OnDefaulterExpelled(_id, _expellant);\\r\\n\\r\\n        // If the participant is expelled before becoming beneficiary, we lose a cycle, the one which this expellant is becoming beneficiary\\r\\n        if (!fund.isBeneficiary[_expellant]) {\\r\\n            fund.totalAmountOfCycles--;\\r\\n        }\\r\\n\\r\\n        // Lastly, lower the amount of participants with the amount expelled\\r\\n        uint newLength = term.totalParticipants - 1;\\r\\n        term.totalParticipants = newLength;\\r\\n        collateral.isCollateralMember[_expellant] = false;\\r\\n        ++fund.expelledParticipants;\\r\\n\\r\\n        emit OnTotalParticipantsUpdated(_id, newLength);\\r\\n    }\\r\\n\\r\\n    /// @notice Internal function for close fund which is used by _startNewCycle & _chooseBeneficiary to cover some edge-cases\\r\\n    /// @param _id The id of the term\\r\\n    function _closeFund(uint _id) internal {\\r\\n        LibFundV2.Fund storage fund = LibFundV2._fundStorage().funds[_id];\\r\\n        fund.fundEnd = block.timestamp;\\r\\n        _setState(_id, LibFundV2.FundStates.FundClosed);\\r\\n        ICollateralV2(address(this)).releaseCollateral(_id);\\r\\n    }\\r\\n}\\r\\n\",\"keccak256\":\"0x3edb0417fd391fe08232d80b57963a3c289e3d0babc38a195e6c43c6c1ab86b5\",\"license\":\"GPL-3.0\"},\"contracts/version-2/interfaces/ICollateralV2.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0\\r\\n\\r\\npragma solidity 0.8.18;\\r\\n\\r\\n/// @title Takaturn Collateral Interface\\r\\n/// @author Aisha EL Allam\\r\\n/// @notice This is used to allow fund to easily communicate with collateral\\r\\n/// @dev v2.0 (post-deploy)\\r\\n\\r\\nimport {LibCollateralV2} from \\\"../libraries/LibCollateralV2.sol\\\";\\r\\n\\r\\ninterface ICollateralV2 {\\r\\n    // Function cannot be called at this time.\\r\\n    error FunctionInvalidAtThisState();\\r\\n\\r\\n    function setStateOwner(uint id, LibCollateralV2.CollateralStates newState) external;\\r\\n\\r\\n    /// @notice Called from Fund contract when someone defaults\\r\\n    /// @dev Check EnumerableMap (openzeppelin) for arrays that are being accessed from Fund contract\\r\\n    /// @param beneficiary Address that was randomly selected for the current cycle\\r\\n    /// @param defaulters Address that was randomly selected for the current cycle\\r\\n    function requestContribution(\\r\\n        uint id,\\r\\n        address beneficiary,\\r\\n        address[] calldata defaulters\\r\\n    ) external returns (address[] memory);\\r\\n\\r\\n    /// @notice Called by each member after the end of the cycle to withraw collateral\\r\\n    /// @dev This follows the pull-over-push pattern.\\r\\n    function withdrawCollateral(uint id) external;\\r\\n\\r\\n    function withdrawReimbursement(uint id, address participant) external;\\r\\n\\r\\n    function releaseCollateral(uint id) external;\\r\\n\\r\\n    /// @notice Checks if a user has a collateral below 1.0x of total contribution amount\\r\\n    /// @dev This will revert if called during ReleasingCollateral or after\\r\\n    /// @param member The user to check for\\r\\n    /// @return Bool check if member is below 1.0x of collateralDeposit\\r\\n    function isUnderCollaterized(uint id, address member) external view returns (bool);\\r\\n\\r\\n    /// @notice allow the owner to empty the Collateral after 180 days\\r\\n    function emptyCollateralAfterEnd(uint id) external;\\r\\n\\r\\n    // function getDepositorSummary(\\r\\n    //     uint id,\\r\\n    //     address participant\\r\\n    // ) external view returns (uint, uint, bool);\\r\\n}\\r\\n\",\"keccak256\":\"0xae378745b2c3448a774b0e42c35b3346ead1e2417d873c638f55e7f16bd71886\",\"license\":\"GPL-3.0\"},\"contracts/version-2/interfaces/IFundV2.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0\\r\\n\\r\\npragma solidity 0.8.18;\\r\\n\\r\\n/// @title Takaturn Fund Interface\\r\\n/// @author Mohammed Haddouti\\r\\n/// @notice This is used to allow collateral to easily communicate with fund\\r\\n/// @dev v2.0 (post-deploy)\\r\\n\\r\\nimport {LibFundV2} from \\\"../libraries/LibFundV2.sol\\\";\\r\\n\\r\\ninterface IFundV2 {\\r\\n    function initFund(uint termId) external;\\r\\n\\r\\n    /// @notice starts a new cycle manually called by the owner. Only the first cycle starts automatically upon deploy\\r\\n    function startNewCycle(uint termId) external;\\r\\n\\r\\n    /// @notice Must be called at the end of the contribution period after the time has passed by the owner\\r\\n    function closeFundingPeriod(uint termId) external;\\r\\n\\r\\n    /// @notice Fallback function, if the internal call fails somehow and the state gets stuck, allow owner to call the function again manually\\r\\n    /// @dev This shouldn't happen, but is here in case there's an edge-case we didn't take into account, can possibly be removed in the future\\r\\n    function selectBeneficiary(uint termId) external;\\r\\n\\r\\n    /// @notice called by the owner to close the fund for emergency reasons.\\r\\n    function closeFund(uint termId) external;\\r\\n\\r\\n    // @notice allow the owner to empty the fund if there's any excess fund left after 180 days,\\r\\n    //         this with the assumption that beneficiaries can't claim it themselves due to losing their keys for example,\\r\\n    //         and prevent the fund to be stuck in limbo\\r\\n    function emptyFundAfterEnd(uint termId) external;\\r\\n\\r\\n    /// @notice function to enable/disable autopay\\r\\n    function toggleAutoPay(uint termId) external;\\r\\n\\r\\n    /// @notice This is the function participants call to pay the contribution\\r\\n    function payContribution(uint termId) external;\\r\\n\\r\\n    /// @notice This function is here to give the possibility to pay using a different wallet\\r\\n    /// @param participant the address the msg.sender is paying for, the address must be part of the fund\\r\\n    function payContributionOnBehalfOf(uint termId, address participant) external;\\r\\n\\r\\n    /// @notice Called by the beneficiary to withdraw the fund\\r\\n    /// @dev This follows the pull-over-push pattern.\\r\\n    function withdrawFund(uint termId) external;\\r\\n\\r\\n    function isBeneficiary(uint termId, address beneficiary) external view returns (bool);\\r\\n}\\r\\n\",\"keccak256\":\"0x527a02ca0f49170cd471d6f4b67b649631924fd530e854c6d02936117dac063a\",\"license\":\"GPL-3.0\"},\"contracts/version-2/interfaces/IGettersV2.sol\":{\"content\":\"// SPDX-License-Identifier: GPL-3.0\\r\\n\\r\\npragma solidity 0.8.18;\\r\\n\\r\\nimport {IERC20} from \\\"@openzeppelin/contracts/token/ERC20/IERC20.sol\\\";\\r\\n\\r\\nimport {LibTermV2} from \\\"../libraries/LibTermV2.sol\\\";\\r\\nimport {LibCollateralV2} from \\\"../libraries/LibCollateralV2.sol\\\";\\r\\nimport {LibFundV2} from \\\"../libraries/LibFundV2.sol\\\";\\r\\n\\r\\ninterface IGettersV2 {\\r\\n    function getTermsId() external view returns (uint, uint);\\r\\n\\r\\n    function getTermSummary(uint id) external view returns (LibTermV2.Term memory);\\r\\n\\r\\n    function getRemainingCycleTime(uint id) external view returns (uint);\\r\\n\\r\\n    function getDepositorCollateralSummary(\\r\\n        address depositor,\\r\\n        uint id\\r\\n    ) external view returns (bool, uint, uint);\\r\\n\\r\\n    function getCollateralSummary(\\r\\n        uint id\\r\\n    )\\r\\n        external\\r\\n        view\\r\\n        returns (bool, LibCollateralV2.CollateralStates, uint, uint, address[] memory, uint);\\r\\n\\r\\n    function getFundSummary(\\r\\n        uint id\\r\\n    )\\r\\n        external\\r\\n        view\\r\\n        returns (\\r\\n            bool,\\r\\n            LibFundV2.FundStates,\\r\\n            IERC20,\\r\\n            uint,\\r\\n            address[] memory,\\r\\n            uint,\\r\\n            uint,\\r\\n            address,\\r\\n            uint,\\r\\n            uint\\r\\n        );\\r\\n\\r\\n    function getBeneficiariesOrder(uint id) external view returns (address[] memory);\\r\\n\\r\\n    function getParticipantFundSummary(\\r\\n        address participant,\\r\\n        uint id\\r\\n    ) external view returns (bool, bool, bool, bool, uint);\\r\\n\\r\\n    function getRemainingContributionTime(uint id) external view returns (uint);\\r\\n}\\r\\n\",\"keccak256\":\"0x63266fd6ace1f2943aa46c2e5aaa948d74cd382edf97cb75adb6946d32e665a4\",\"license\":\"GPL-3.0\"},\"contracts/version-2/libraries/LibCollateralV2.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\r\\npragma solidity 0.8.18;\\r\\n\\r\\nlibrary LibCollateralV2 {\\r\\n    uint public constant COLLATERAL_VERSION = 1;\\r\\n    bytes32 constant COLLATERAL_STORAGE_POSITION = keccak256(\\\"diamond.standard.collateral.storage\\\");\\r\\n\\r\\n    enum CollateralStates {\\r\\n        AcceptingCollateral, // Initial state where collateral are deposited\\r\\n        CycleOngoing, // Triggered when a fund instance is created, no collateral can be accepted\\r\\n        ReleasingCollateral, // Triggered when the fund closes\\r\\n        Closed // Triggered when all depositors withdraw their collaterals\\r\\n    }\\r\\n\\r\\n    struct Collateral {\\r\\n        bool initialized;\\r\\n        CollateralStates state;\\r\\n        uint firstDepositTime;\\r\\n        uint counterMembers;\\r\\n        address[] depositors;\\r\\n        mapping(address => bool) isCollateralMember; // Determines if a depositor is a valid user\\r\\n        mapping(address => uint) collateralMembersBank; // Users main balance\\r\\n        mapping(address => uint) collateralPaymentBank; // Users reimbursement balance after someone defaults\\r\\n        uint collateralDeposit; // Total value of collateral in USD (1.5x of total fund)\\r\\n    }\\r\\n\\r\\n    struct CollateralStorage {\\r\\n        mapping(uint => Collateral) collaterals; // termId => Collateral struct\\r\\n    }\\r\\n\\r\\n    function _collateralExists(uint termId) internal view returns (bool) {\\r\\n        return _collateralStorage().collaterals[termId].initialized;\\r\\n    }\\r\\n\\r\\n    function _collateralStorage()\\r\\n        internal\\r\\n        pure\\r\\n        returns (CollateralStorage storage collateralStorage)\\r\\n    {\\r\\n        bytes32 position = COLLATERAL_STORAGE_POSITION;\\r\\n        assembly {\\r\\n            collateralStorage.slot := position\\r\\n        }\\r\\n    }\\r\\n}\\r\\n\",\"keccak256\":\"0x37a7f8ba42ff58378122095ca2e5680472012fc86d4ae9b5a699aa605a727708\",\"license\":\"MIT\"},\"contracts/version-2/libraries/LibFundV2.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\r\\npragma solidity 0.8.18;\\r\\n\\r\\nimport {IERC20} from \\\"@openzeppelin/contracts/token/ERC20/IERC20.sol\\\";\\r\\nimport {EnumerableSet} from \\\"@openzeppelin/contracts/utils/structs/EnumerableSet.sol\\\";\\r\\n\\r\\nimport {ICollateralV2} from \\\"../interfaces/ICollateralV2.sol\\\";\\r\\n\\r\\nlibrary LibFundV2 {\\r\\n    using EnumerableSet for EnumerableSet.AddressSet;\\r\\n\\r\\n    uint public constant FUND_VERSION = 1;\\r\\n    bytes32 constant FUND_POSITION = keccak256(\\\"diamond.standard.fund\\\");\\r\\n    bytes32 constant FUND_STORAGE_POSITION = keccak256(\\\"diamond.standard.fund.storage\\\");\\r\\n\\r\\n    enum FundStates {\\r\\n        InitializingFund, // Time before the first cycle has started\\r\\n        AcceptingContributions, // Triggers at the start of a cycle\\r\\n        ChoosingBeneficiary, // Contributions are closed, beneficiary is chosen, people default etc.\\r\\n        CycleOngoing, // Time after beneficiary is chosen, up till the start of the next cycle\\r\\n        FundClosed // Triggers at the end of the last contribution period, no state changes after this\\r\\n    }\\r\\n\\r\\n    struct Fund {\\r\\n        bool initialized;\\r\\n        FundStates currentState; // Variable to keep track of the different FundStates\\r\\n        IERC20 stableToken; // Instance of the stable token\\r\\n        address[] beneficiariesOrder; // The correct order of who gets to be next beneficiary, determined by collateral contract\\r\\n        uint fundStart; // Timestamp of the start of the fund\\r\\n        uint fundEnd; // Timestamp of the end of the fund\\r\\n        uint currentCycle; // Index of current cycle\\r\\n        mapping(address => bool) isParticipant; // Mapping to keep track of who's a participant or not\\r\\n        mapping(address => bool) isBeneficiary; // Mapping to keep track of who's a beneficiary or not\\r\\n        mapping(address => bool) paidThisCycle; // Mapping to keep track of who paid for this cycle\\r\\n        mapping(address => bool) autoPayEnabled; // Wheter to attempt to automate payments at the end of the contribution period\\r\\n        mapping(address => uint) beneficiariesPool; // Mapping to keep track on how much each beneficiary can claim\\r\\n        EnumerableSet.AddressSet _participants; // Those who have not been beneficiaries yet and have not defaulted this cycle\\r\\n        EnumerableSet.AddressSet _beneficiaries; // Those who have been beneficiaries and have not defaulted this cycle\\r\\n        EnumerableSet.AddressSet _defaulters; // Both participants and beneficiaries who have defaulted this cycle\\r\\n        uint expelledParticipants; // Total amount of participants that have been expelled so far\\r\\n        address lastBeneficiary; // The last selected beneficiary, updates with every cycle\\r\\n        uint totalAmountOfCycles;\\r\\n    }\\r\\n\\r\\n    struct FundStorage {\\r\\n        mapping(uint => Fund) funds; // termId => Fund struct\\r\\n    }\\r\\n\\r\\n    function _fundExists(uint termId) internal view returns (bool) {\\r\\n        return _fundStorage().funds[termId].initialized;\\r\\n    }\\r\\n\\r\\n    function _fundStorage() internal pure returns (FundStorage storage fundStorage) {\\r\\n        bytes32 position = FUND_STORAGE_POSITION;\\r\\n        assembly {\\r\\n            fundStorage.slot := position\\r\\n        }\\r\\n    }\\r\\n}\\r\\n\",\"keccak256\":\"0xb7e47f6d9604c73d72205fdc17410d5bba2081fffb77384db0aa6eb6887a6d8b\",\"license\":\"MIT\"},\"contracts/version-2/libraries/LibTermV2.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\r\\npragma solidity 0.8.18;\\r\\n\\r\\nlibrary LibTermV2 {\\r\\n    uint public constant TERM_VERSION = 1;\\r\\n    bytes32 constant TERM_CONSTS_POSITION = keccak256(\\\"diamond.standard.term.consts\\\");\\r\\n    bytes32 constant TERM_STORAGE_POSITION = keccak256(\\\"diamond.standard.term.storage\\\");\\r\\n\\r\\n    struct TermConsts {\\r\\n        uint sequencerStartupTime;\\r\\n        address sequencerUptimeFeedAddress;\\r\\n    }\\r\\n\\r\\n    struct Term {\\r\\n        bool initialized;\\r\\n        address termOwner;\\r\\n        uint creationTime;\\r\\n        uint termId;\\r\\n        uint totalParticipants; // Max number of participants\\r\\n        uint cycleTime; // Time for single cycle (seconds)\\r\\n        uint contributionAmount; // Amount user must pay per cycle (USD)\\r\\n        uint contributionPeriod; // The portion of cycle user must make payment\\r\\n        uint fixedCollateralEth;\\r\\n        address stableTokenAddress;\\r\\n        address aggregatorAddress;\\r\\n    }\\r\\n\\r\\n    struct TermStorage {\\r\\n        uint nextTermId;\\r\\n        mapping(uint => Term) terms; // termId => Term struct\\r\\n    }\\r\\n\\r\\n    function _termExists(uint termId) internal view returns (bool) {\\r\\n        return _termStorage().terms[termId].initialized;\\r\\n    }\\r\\n\\r\\n    function _termConsts() internal pure returns (TermConsts storage termConsts) {\\r\\n        bytes32 position = TERM_CONSTS_POSITION;\\r\\n        assembly {\\r\\n            termConsts.slot := position\\r\\n        }\\r\\n    }\\r\\n\\r\\n    function _termStorage() internal pure returns (TermStorage storage termStorage) {\\r\\n        bytes32 position = TERM_STORAGE_POSITION;\\r\\n        assembly {\\r\\n            termStorage.slot := position\\r\\n        }\\r\\n    }\\r\\n}\\r\\n\",\"keccak256\":\"0xb43c10a301314b64c9711d24884d0ba527e3f47a68b676f03affd947fedfacc4\",\"license\":\"MIT\"}},\"version\":1}",
  "bytecode": "0x608060405234801561001057600080fd5b50612541806100206000396000f3fe608060405234801561001057600080fd5b50600436106100b45760003560e01c80637be2ecea116100715780637be2ecea1461012d5780638443162914610140578063bd241d2014610153578063e9783e6014610166578063ea28b9bb1461018e578063f7af18f6146101a157600080fd5b80630cee1725146100b95780632009844b146100ce5780633df0c406146100e15780634b5c9c80146100f457806358733dec14610107578063609a49701461011a575b600080fd5b6100cc6100c73660046121b3565b6101b7565b005b6100cc6100dc3660046121b3565b610560565b6100cc6100ef3660046121b3565b610650565b6100cc6101023660046121b3565b6106bd565b6100cc6101153660046121b3565b610896565b6100cc6101283660046121b3565b610b47565b6100cc61013b3660046121b3565b610b5a565b6100cc61014e3660046121e1565b610b6d565b6100cc6101613660046121b3565b610c6b565b6101796101743660046121e1565b610d66565b60405190151581526020015b60405180910390f35b6100cc61019c3660046121b3565b610da1565b6101a9600281565b604051908152602001610185565b60006101c1610e3f565b600083815260209190915260409020905060048154610100900460ff1660048111156101ef576101ef612211565b148061020c575033600090815260078201602052604090205460ff165b6102705760405162461bcd60e51b815260206004820152602a60248201527f596f75206d7573742070617920796f7572206379636c65206265666f7265207760448201526969746864726177696e6760b01b60648201526084015b60405180910390fd5b33600081815260098301602052604080822054905163bb91b76d60e01b8152600481019390935260248301859052151591309063bb91b76d90604401606060405180830381865afa1580156102c9573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102ed919061223c565b9250505080151582806102fd5750805b61033f5760405162461bcd60e51b81526020600482015260136024820152724e6f7468696e6720746f20776974686472617760681b6044820152606401610267565b82156104fb5733600090815260098501602052604080822054865491516370a0823160e01b81523060048201529092916201000090046001600160a01b0316906370a0823190602401602060405180830381865afa1580156103a5573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103c99190612271565b9050818110156103f65760405163cf47918160e01b81526004810182905260248101839052604401610267565b3360008181526009880160205260408082208290558854905163a9059cbb60e01b81526004810193909352602483018590529091620100009091046001600160a01b03169063a9059cbb906044016020604051808303816000875af1158015610463573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610487919061228a565b9050806104c85760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b6044820152606401610267565b506040518290339089907f31b332de0dccb2d0ed351b3d65a9e10b099b3e3c63f4a6f5ea1810b4d757795c90600090a450505b80156105595760405163ae483d0760e01b815260048101869052336024820152309063ae483d0790604401600060405180830381600087803b15801561054057600080fd5b505af1158015610554573d6000803e3d6000fd5b505050505b5050505050565b600061056a610e3f565b600083815260209190915260409020905060018154610100900460ff16600481111561059857610598612211565b146105b55760405162461bcd60e51b8152600401610267906122a5565b33600090815260058201602052604090205460ff166105e65760405162461bcd60e51b8152600401610267906122ca565b33600090815260078201602052604090205460ff16156106415760405162461bcd60e51b8152602060048201526016602482015275416c7265616479207061696420666f72206379636c6560501b6044820152606401610267565b61064c823333610e63565b5050565b8061065a81610ff8565b6000610664610e3f565b600084815260209190915260409020905060028154610100900460ff16600481111561069257610692612211565b146106af5760405162461bcd60e51b8152600401610267906122a5565b6106b883611080565b505050565b806106c781610ff8565b60006106d1610e3f565b600084815260209190915260409020905060048154610100900460ff1660048111156106ff576106ff612211565b14801561071c575060038101546107199062ed4e0061230b565b42115b61075a5760405162461bcd60e51b815260206004820152600f60248201526e10d85b89dd08195b5c1d1e481e595d608a1b6044820152606401610267565b80546040516370a0823160e01b81523060048201526000916201000090046001600160a01b0316906370a0823190602401602060405180830381865afa1580156107a8573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906107cc9190612271565b9050801561089057815460405163a9059cbb60e01b8152336004820152602481018390526000916201000090046001600160a01b03169063a9059cbb906044016020604051808303816000875af115801561082b573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061084f919061228a565b9050806105595760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b6044820152606401610267565b50505050565b806108a081610ff8565b60006108aa610e3f565b6000848152602091825260408082206000805160206124ec833981519152909352902060068101546002830154600484015493945091929091906108f09060019061231e565b83600401546108ff9190612331565b610909919061230b565b610913919061230b565b42116109615760405162461bcd60e51b815260206004820152601860248201527f5374696c6c2074696d6520746f20636f6e7472696275746500000000000000006044820152606401610267565b60018254610100900460ff16600481111561097e5761097e612211565b1461099b5760405162461bcd60e51b8152600401610267906122a5565b6109a4846115a4565b6109af8460026116fa565b600082600101805480602002602001604051908101604052809291908181526020018280548015610a0957602002820191906000526020600020905b81546001600160a01b031681526001909101906020018083116109eb575b505083519394506000925050505b81811015610b1d576000838281518110610a3357610a33612348565b6020908102919091018101516001600160a01b03811660009081526007890190925260409091205490915060ff1615610af9576001600160a01b038116600090815260068701602052604090205460ff1615610a9c57610a9686600c01826117d4565b50610aab565b610aa986600a01826117d4565b505b610ab886600e01826117f0565b15610af4576040516001600160a01b0382169089907f164322fe0d1a75eba2830f83779f4daaf9b8dfd5801a3798879708dd8e8ba7cc90600090a35b610b14565b610b0686600e0182611805565b610b1457610b148882611827565b50600101610a17565b50610b2786611080565b8360120154846004015410610b3f57610b3f866118f6565b505050505050565b80610b5181610ff8565b61064c826118f6565b80610b6481610ff8565b61064c8261196f565b6000610b77610e3f565b600084815260209190915260409020905060018154610100900460ff166004811115610ba557610ba5612211565b14610bc25760405162461bcd60e51b8152600401610267906122a5565b6001600160a01b038216600090815260058201602052604090205460ff16610bfc5760405162461bcd60e51b8152600401610267906122ca565b6001600160a01b038216600090815260078201602052604090205460ff1615610c605760405162461bcd60e51b8152602060048201526016602482015275416c7265616479207061696420666f72206379636c6560501b6044820152606401610267565b6106b8833384610e63565b6000610c75610e3f565b6000838152602091909152604081206001810154909250905b81811015610d2657610ccc83600a01846001018381548110610cb257610cb2612348565b6000918252602090912001546001600160a01b03166117d4565b506001836005016000856001018481548110610cea57610cea612348565b6000918252602080832091909101546001600160a01b031683528201929092526040019020805460ff1916911515919091179055600101610c8e565b50610d308361196f565b42600283015560405183907fc3bfb99b88687651f8e660492ae2ee62a50d40e4131ace07f88ed4639b3a4bc390600090a2505050565b600080610d71610e3f565b6000858152602091825260408082206001600160a01b0387168352600601909252205460ff169150505b92915050565b6000610dab610e3f565b6000838152602091825260408082203383526005810190935290205490915060ff16610de95760405162461bcd60e51b8152600401610267906122ca565b336000818152600883016020526040808220805460ff81161560ff199091168117909155905190928392909186917f8bd3cffd2d87eca262a8e2d638c1ff3d3b61c604208115af6295b089acaf72b991a4505050565b7f6751f7e27cecf86d7136f5749c224248cae80a39fafb59f8f6bf12c52816307c90565b6000610e6d610e3f565b6000858152602091825260408082206000805160206124ec8339815191529093528120600581015492935091610ea690620f4240612331565b83546040516323b872dd60e01b81526001600160a01b0388811660048301523060248301526044820184905292935060009262010000909204909116906323b872dd906064016020604051808303816000875af1158015610f0b573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610f2f919061228a565b905080610f995760405162461bcd60e51b815260206004820152603260248201527f436f6e747269627574696f6e206661696c65642c2064696420796f7520617070604482015271726f766520737461626c6520746f6b656e3f60701b6064820152608401610267565b6001600160a01b0385166000818152600786016020526040808220805460ff19166001179055600487015490519092918a917fe1122b3cea22012386ebf236fc23dd8a783b91c046d5dec812901846464624ae9190a450505050505050565b60008181526000805160206124ec83398151915260205260409020546001600160a01b0361010090910416331461107d5760405162461bcd60e51b8152602060048201526024808201527f5465726d4f776e61626c653a2063616c6c6572206973206e6f7420746865206f6044820152633bb732b960e11b6064820152608401610267565b50565b600061108a610e3f565b6000838152602091825260408082206000805160206124ec833981519152845281832060018201805484518188028101880190955280855292965090948493929083018282801561110457602002820191906000526020600020905b81546001600160a01b031681526001909101906020018083116110e6575b505050505090506000815190506000805b8281101561117657600084828151811061113157611131612348565b6020908102919091018101516001600160a01b038116600090815260068b0190925260409091205490915060ff1661116d579450905080611176565b50600101611115565b506001600160a01b038416600090815260078701602052604090205460ff1661130457805b828110156113025760008482815181106111b7576111b7612348565b6020908102919091018101516001600160a01b038116600090815260078b0190925260409091205490915060ff16156112f95780955060008860010180548060200260200160405190810160405280929190818152602001828054801561124757602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311611229575b509394508793505050505b838110156112b25786818151811061126c5761126c612348565b602002602001015182826001611282919061230b565b8151811061129257611292612348565b6001600160a01b0390921660209283029190910190910152600101611252565b50868185815181106112c6576112c6612348565b6001600160a01b0390921660209283029190910182015281516112f19160018c019190840190612139565b505050611302565b5060010161119b565b505b600061131287600e01611b05565b111561140d5760003063e27c3ca2898761132e600e8c01611b0f565b6040518463ffffffff1660e01b815260040161134c9392919061235e565b6000604051808303816000875af115801561136b573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261139391908101906123e0565b805190915060005b818110156114095760006001600160a01b03168382815181106113c0576113c0612348565b60200260200101516001600160a01b0316036113de5760010161139b565b6114018a8483815181106113f4576113f4612348565b6020026020010151611b1c565b60010161139b565b5050505b61141a86600a01856117f0565b1561142e5761142c86600c01856117d4565b505b6001600160a01b03841660009081526006870160209081526040808320805460ff191660019081179091558901805482518185028101850190935280835284938301828280156114a757602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311611489575b5050505050905060005b815181101561151e578860070160008383815181106114d2576114d2612348565b6020908102919091018101516001600160a01b031682528101919091526040016000205460ff161561150c5782611508816124a5565b9350505b80611516816124a5565b9150506114b1565b5081876005015461152f9190612331565b61153c90620f4240612331565b6001600160a01b038716600081815260098b0160205260408082209390935560118b0180546001600160a01b03191683179055915190918b917fe2372b1231b038f66dbcf5151afa5286deed439d6ee45c748f06e5a5ccd612709190a36105548960036116fa565b60006115ae610e3f565b600083815260209182526040808220600181018054835181870281018701909452808452919550929391929183018282801561161357602002820191906000526020600020905b81546001600160a01b031681526001909101906020018083116115f5575b505083519394506000925050505b818110156105595783600801600084838151811061164157611641612348565b6020908102919091018101516001600160a01b031682528101919091526040016000205460ff1680156116b0575083600701600084838151811061168757611687612348565b6020908102919091018101516001600160a01b031682528101919091526040016000205460ff16155b156116f2576116f2858483815181106116cb576116cb612348565b60200260200101518584815181106116e5576116e5612348565b6020026020010151611cfc565b600101611621565b6000611704610e3f565b600084815260209190915260409020905060048154610100900460ff16600481111561173257611732612211565b0361176d5760405162461bcd60e51b815260206004820152600b60248201526a119d5b990818db1bdcd95960aa1b6044820152606401610267565b80548290829061ff00191661010083600481111561178d5761178d612211565b02179055508160048111156117a4576117a4612211565b60405184907fecc339a9dbd454a10bb48d74b40c6ef6e3b22dfc541fc7c16d6114e5763a562890600090a3505050565b60006117e9836001600160a01b038416611e28565b9392505050565b60006117e9836001600160a01b038416611e77565b6001600160a01b038116600090815260018301602052604081205415156117e9565b6000611831610e3f565b600084815260209190915260408120915061184f600a8301846117f0565b9050806118665761186382600c01846117f0565b90505b806118ac5760405162461bcd60e51b815260206004820152601660248201527521b0b713ba103932b6b7bb32903232b330bab63a32b960511b6044820152606401610267565b6118b982600e01846117d4565b506040516001600160a01b0384169085907f59e9bf20dffb9054810c87236063cd66c8aacdecf2167a76c2fc486deb92c72290600090a350505050565b6000611900610e3f565b60008381526020919091526040902042600382015590506119228260046116fa565b6040516339007b7760e01b81526004810183905230906339007b7790602401600060405180830381600087803b15801561195b57600080fd5b505af1158015610b3f573d6000803e3d6000fd5b6000611979610e3f565b6000838152602091825260408082206000805160206124ec8339815191529093529020600282015460048084015490830154939450919290916119bb91612331565b6119c5919061230b565b4211611a135760405162461bcd60e51b815260206004820152601c60248201527f546f6f206561726c7920746f207374617274206e6577206379636c65000000006044820152606401610267565b60008254610100900460ff166004811115611a3057611a30612211565b1480611a56575060038254610100900460ff166004811115611a5457611a54612211565b145b611a725760405162461bcd60e51b8152600401610267906122a5565b8160040160008154611a83906124a5565b90915550600182015460005b81811015611af0576000846007016000866001018481548110611ab457611ab4612348565b6000918252602080832091909101546001600160a01b031683528201929092526040019020805460ff1916911515919091179055600101611a8f565b50611afc8460016116fa565b610890846115a4565b6000610d9b825490565b606060006117e983611f6a565b60008281527f35fa70a6f9ae8a4d427ebe0c1be62ffd2870fecc1df41c6fda0bf5803e5628886020526040812090611b52610e3f565b6000858152602091825260408082206000805160206124ec83398151915284528183206001600160a01b03881684526005820190945291205490925060ff168015611ba55750611ba582600e01856117f0565b611be75760405162461bcd60e51b8152602060048201526013602482015272115e1c195b1b185b9d081b9bdd08199bdd5b99606a1b6044820152606401610267565b611bf18585611fc6565b6001600160a01b0384166000818152600584016020526040808220805460ff191690555187917fffaffc51da9546c32f4d0ddf1c944d8ca87b053b905bb2b694978874b620858391a36001600160a01b038416600090815260068301602052604090205460ff16611c7457601282018054906000611c6e836124be565b91905055505b600060018260030154611c87919061231e565b600383018190556001600160a01b03861660009081526004860160205260408120805460ff1916905560108501805492935091611cc3906124a5565b90915550604051819087907fe817db35ffcfd7ab4de59cd38a99d674f761815667cbc3241bebf20e7da1b6e890600090a3505050505050565b6000611d06610e3f565b6000858152602091825260408082206000805160206124ec8339815191529093528120600581015492935091611d3f90620f4240612331565b83546040516323b872dd60e01b81526001600160a01b0388811660048301523060248301526044820184905292935062010000909104909116906323b872dd906064016020604051808303816000875af1925050508015611dbd575060408051601f3d908101601f19168201909252611dba9181019061228a565b60015b15610b3f578015611e1f576001600160a01b0385166000818152600786016020526040808220805460ff19166001179055600487015490519092918a917fe1122b3cea22012386ebf236fc23dd8a783b91c046d5dec812901846464624ae9190a45b50505050505050565b6000818152600183016020526040812054611e6f57508154600181810184556000848152602080822090930184905584548482528286019093526040902091909155610d9b565b506000610d9b565b60008181526001830160205260408120548015611f60576000611e9b60018361231e565b8554909150600090611eaf9060019061231e565b9050818114611f14576000866000018281548110611ecf57611ecf612348565b9060005260206000200154905080876000018481548110611ef257611ef2612348565b6000918252602080832090910192909255918252600188019052604090208390555b8554869080611f2557611f256124d5565b600190038181906000526020600020016000905590558560010160008681526020019081526020016000206000905560019350505050610d9b565b6000915050610d9b565b606081600001805480602002602001604051908101604052809291908181526020018280548015611fba57602002820191906000526020600020905b815481526020019060010190808311611fa6575b50505050509050919050565b6000611fd0610e3f565b600084815260209182526040808220600181018054835181870281018701909452808452919550929391929183018282801561203557602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311612017575b505083519394506000925061204f9150600190508361231e565b67ffffffffffffffff811115612067576120676123bf565b604051908082528060200260200182016040528015612090578160200160208202803683370190505b5090506000805b838110156121195760008582815181106120b3576120b3612348565b60200260200101519050876001600160a01b0316816001600160a01b03161461211057808484815181106120e9576120e9612348565b60200260200101906001600160a01b031690816001600160a01b0316815250508260010192505b50600101612097565b50815161212f9060018701906020850190612139565b5050505050505050565b82805482825590600052602060002090810192821561218e579160200282015b8281111561218e57825182546001600160a01b0319166001600160a01b03909116178255602090920191600190910190612159565b5061219a92915061219e565b5090565b5b8082111561219a576000815560010161219f565b6000602082840312156121c557600080fd5b5035919050565b6001600160a01b038116811461107d57600080fd5b600080604083850312156121f457600080fd5b823591506020830135612206816121cc565b809150509250929050565b634e487b7160e01b600052602160045260246000fd5b8051801515811461223757600080fd5b919050565b60008060006060848603121561225157600080fd5b61225a84612227565b925060208401519150604084015190509250925092565b60006020828403121561228357600080fd5b5051919050565b60006020828403121561229c57600080fd5b6117e982612227565b6020808252600b908201526a57726f6e6720737461746560a81b604082015260600190565b602080825260119082015270139bdd0818481c185c9d1a58da5c185b9d607a1b604082015260600190565b634e487b7160e01b600052601160045260246000fd5b80820180821115610d9b57610d9b6122f5565b81810381811115610d9b57610d9b6122f5565b8082028115828204841417610d9b57610d9b6122f5565b634e487b7160e01b600052603260045260246000fd5b600060608201858352602060018060a01b038087168286015260606040860152828651808552608087019150838801945060005b818110156123b0578551841683529484019491840191600101612392565b50909998505050505050505050565b634e487b7160e01b600052604160045260246000fd5b8051612237816121cc565b600060208083850312156123f357600080fd5b825167ffffffffffffffff8082111561240b57600080fd5b818501915085601f83011261241f57600080fd5b815181811115612431576124316123bf565b8060051b604051601f19603f83011681018181108582111715612456576124566123bf565b60405291825284820192508381018501918883111561247457600080fd5b938501935b828510156124995761248a856123d5565b84529385019392850192612479565b98975050505050505050565b6000600182016124b7576124b76122f5565b5060010190565b6000816124cd576124cd6122f5565b506000190190565b634e487b7160e01b600052603160045260246000fdfe87101b21d556417ad2b8e8f2700dbad90721d5d50a1f435f2dee0b9dc981ac8aa26469706673582212207bed54c2fc9094712b4c86e9f31696c36ac8fdd270abcd87a35741beee1ded1764736f6c63430008120033",
  "deployedBytecode": "0x608060405234801561001057600080fd5b50600436106100b45760003560e01c80637be2ecea116100715780637be2ecea1461012d5780638443162914610140578063bd241d2014610153578063e9783e6014610166578063ea28b9bb1461018e578063f7af18f6146101a157600080fd5b80630cee1725146100b95780632009844b146100ce5780633df0c406146100e15780634b5c9c80146100f457806358733dec14610107578063609a49701461011a575b600080fd5b6100cc6100c73660046121b3565b6101b7565b005b6100cc6100dc3660046121b3565b610560565b6100cc6100ef3660046121b3565b610650565b6100cc6101023660046121b3565b6106bd565b6100cc6101153660046121b3565b610896565b6100cc6101283660046121b3565b610b47565b6100cc61013b3660046121b3565b610b5a565b6100cc61014e3660046121e1565b610b6d565b6100cc6101613660046121b3565b610c6b565b6101796101743660046121e1565b610d66565b60405190151581526020015b60405180910390f35b6100cc61019c3660046121b3565b610da1565b6101a9600281565b604051908152602001610185565b60006101c1610e3f565b600083815260209190915260409020905060048154610100900460ff1660048111156101ef576101ef612211565b148061020c575033600090815260078201602052604090205460ff165b6102705760405162461bcd60e51b815260206004820152602a60248201527f596f75206d7573742070617920796f7572206379636c65206265666f7265207760448201526969746864726177696e6760b01b60648201526084015b60405180910390fd5b33600081815260098301602052604080822054905163bb91b76d60e01b8152600481019390935260248301859052151591309063bb91b76d90604401606060405180830381865afa1580156102c9573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102ed919061223c565b9250505080151582806102fd5750805b61033f5760405162461bcd60e51b81526020600482015260136024820152724e6f7468696e6720746f20776974686472617760681b6044820152606401610267565b82156104fb5733600090815260098501602052604080822054865491516370a0823160e01b81523060048201529092916201000090046001600160a01b0316906370a0823190602401602060405180830381865afa1580156103a5573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103c99190612271565b9050818110156103f65760405163cf47918160e01b81526004810182905260248101839052604401610267565b3360008181526009880160205260408082208290558854905163a9059cbb60e01b81526004810193909352602483018590529091620100009091046001600160a01b03169063a9059cbb906044016020604051808303816000875af1158015610463573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610487919061228a565b9050806104c85760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b6044820152606401610267565b506040518290339089907f31b332de0dccb2d0ed351b3d65a9e10b099b3e3c63f4a6f5ea1810b4d757795c90600090a450505b80156105595760405163ae483d0760e01b815260048101869052336024820152309063ae483d0790604401600060405180830381600087803b15801561054057600080fd5b505af1158015610554573d6000803e3d6000fd5b505050505b5050505050565b600061056a610e3f565b600083815260209190915260409020905060018154610100900460ff16600481111561059857610598612211565b146105b55760405162461bcd60e51b8152600401610267906122a5565b33600090815260058201602052604090205460ff166105e65760405162461bcd60e51b8152600401610267906122ca565b33600090815260078201602052604090205460ff16156106415760405162461bcd60e51b8152602060048201526016602482015275416c7265616479207061696420666f72206379636c6560501b6044820152606401610267565b61064c823333610e63565b5050565b8061065a81610ff8565b6000610664610e3f565b600084815260209190915260409020905060028154610100900460ff16600481111561069257610692612211565b146106af5760405162461bcd60e51b8152600401610267906122a5565b6106b883611080565b505050565b806106c781610ff8565b60006106d1610e3f565b600084815260209190915260409020905060048154610100900460ff1660048111156106ff576106ff612211565b14801561071c575060038101546107199062ed4e0061230b565b42115b61075a5760405162461bcd60e51b815260206004820152600f60248201526e10d85b89dd08195b5c1d1e481e595d608a1b6044820152606401610267565b80546040516370a0823160e01b81523060048201526000916201000090046001600160a01b0316906370a0823190602401602060405180830381865afa1580156107a8573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906107cc9190612271565b9050801561089057815460405163a9059cbb60e01b8152336004820152602481018390526000916201000090046001600160a01b03169063a9059cbb906044016020604051808303816000875af115801561082b573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061084f919061228a565b9050806105595760405162461bcd60e51b815260206004820152600f60248201526e151c985b9cd9995c8819985a5b1959608a1b6044820152606401610267565b50505050565b806108a081610ff8565b60006108aa610e3f565b6000848152602091825260408082206000805160206124ec833981519152909352902060068101546002830154600484015493945091929091906108f09060019061231e565b83600401546108ff9190612331565b610909919061230b565b610913919061230b565b42116109615760405162461bcd60e51b815260206004820152601860248201527f5374696c6c2074696d6520746f20636f6e7472696275746500000000000000006044820152606401610267565b60018254610100900460ff16600481111561097e5761097e612211565b1461099b5760405162461bcd60e51b8152600401610267906122a5565b6109a4846115a4565b6109af8460026116fa565b600082600101805480602002602001604051908101604052809291908181526020018280548015610a0957602002820191906000526020600020905b81546001600160a01b031681526001909101906020018083116109eb575b505083519394506000925050505b81811015610b1d576000838281518110610a3357610a33612348565b6020908102919091018101516001600160a01b03811660009081526007890190925260409091205490915060ff1615610af9576001600160a01b038116600090815260068701602052604090205460ff1615610a9c57610a9686600c01826117d4565b50610aab565b610aa986600a01826117d4565b505b610ab886600e01826117f0565b15610af4576040516001600160a01b0382169089907f164322fe0d1a75eba2830f83779f4daaf9b8dfd5801a3798879708dd8e8ba7cc90600090a35b610b14565b610b0686600e0182611805565b610b1457610b148882611827565b50600101610a17565b50610b2786611080565b8360120154846004015410610b3f57610b3f866118f6565b505050505050565b80610b5181610ff8565b61064c826118f6565b80610b6481610ff8565b61064c8261196f565b6000610b77610e3f565b600084815260209190915260409020905060018154610100900460ff166004811115610ba557610ba5612211565b14610bc25760405162461bcd60e51b8152600401610267906122a5565b6001600160a01b038216600090815260058201602052604090205460ff16610bfc5760405162461bcd60e51b8152600401610267906122ca565b6001600160a01b038216600090815260078201602052604090205460ff1615610c605760405162461bcd60e51b8152602060048201526016602482015275416c7265616479207061696420666f72206379636c6560501b6044820152606401610267565b6106b8833384610e63565b6000610c75610e3f565b6000838152602091909152604081206001810154909250905b81811015610d2657610ccc83600a01846001018381548110610cb257610cb2612348565b6000918252602090912001546001600160a01b03166117d4565b506001836005016000856001018481548110610cea57610cea612348565b6000918252602080832091909101546001600160a01b031683528201929092526040019020805460ff1916911515919091179055600101610c8e565b50610d308361196f565b42600283015560405183907fc3bfb99b88687651f8e660492ae2ee62a50d40e4131ace07f88ed4639b3a4bc390600090a2505050565b600080610d71610e3f565b6000858152602091825260408082206001600160a01b0387168352600601909252205460ff169150505b92915050565b6000610dab610e3f565b6000838152602091825260408082203383526005810190935290205490915060ff16610de95760405162461bcd60e51b8152600401610267906122ca565b336000818152600883016020526040808220805460ff81161560ff199091168117909155905190928392909186917f8bd3cffd2d87eca262a8e2d638c1ff3d3b61c604208115af6295b089acaf72b991a4505050565b7f6751f7e27cecf86d7136f5749c224248cae80a39fafb59f8f6bf12c52816307c90565b6000610e6d610e3f565b6000858152602091825260408082206000805160206124ec8339815191529093528120600581015492935091610ea690620f4240612331565b83546040516323b872dd60e01b81526001600160a01b0388811660048301523060248301526044820184905292935060009262010000909204909116906323b872dd906064016020604051808303816000875af1158015610f0b573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610f2f919061228a565b905080610f995760405162461bcd60e51b815260206004820152603260248201527f436f6e747269627574696f6e206661696c65642c2064696420796f7520617070604482015271726f766520737461626c6520746f6b656e3f60701b6064820152608401610267565b6001600160a01b0385166000818152600786016020526040808220805460ff19166001179055600487015490519092918a917fe1122b3cea22012386ebf236fc23dd8a783b91c046d5dec812901846464624ae9190a450505050505050565b60008181526000805160206124ec83398151915260205260409020546001600160a01b0361010090910416331461107d5760405162461bcd60e51b8152602060048201526024808201527f5465726d4f776e61626c653a2063616c6c6572206973206e6f7420746865206f6044820152633bb732b960e11b6064820152608401610267565b50565b600061108a610e3f565b6000838152602091825260408082206000805160206124ec833981519152845281832060018201805484518188028101880190955280855292965090948493929083018282801561110457602002820191906000526020600020905b81546001600160a01b031681526001909101906020018083116110e6575b505050505090506000815190506000805b8281101561117657600084828151811061113157611131612348565b6020908102919091018101516001600160a01b038116600090815260068b0190925260409091205490915060ff1661116d579450905080611176565b50600101611115565b506001600160a01b038416600090815260078701602052604090205460ff1661130457805b828110156113025760008482815181106111b7576111b7612348565b6020908102919091018101516001600160a01b038116600090815260078b0190925260409091205490915060ff16156112f95780955060008860010180548060200260200160405190810160405280929190818152602001828054801561124757602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311611229575b509394508793505050505b838110156112b25786818151811061126c5761126c612348565b602002602001015182826001611282919061230b565b8151811061129257611292612348565b6001600160a01b0390921660209283029190910190910152600101611252565b50868185815181106112c6576112c6612348565b6001600160a01b0390921660209283029190910182015281516112f19160018c019190840190612139565b505050611302565b5060010161119b565b505b600061131287600e01611b05565b111561140d5760003063e27c3ca2898761132e600e8c01611b0f565b6040518463ffffffff1660e01b815260040161134c9392919061235e565b6000604051808303816000875af115801561136b573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405261139391908101906123e0565b805190915060005b818110156114095760006001600160a01b03168382815181106113c0576113c0612348565b60200260200101516001600160a01b0316036113de5760010161139b565b6114018a8483815181106113f4576113f4612348565b6020026020010151611b1c565b60010161139b565b5050505b61141a86600a01856117f0565b1561142e5761142c86600c01856117d4565b505b6001600160a01b03841660009081526006870160209081526040808320805460ff191660019081179091558901805482518185028101850190935280835284938301828280156114a757602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311611489575b5050505050905060005b815181101561151e578860070160008383815181106114d2576114d2612348565b6020908102919091018101516001600160a01b031682528101919091526040016000205460ff161561150c5782611508816124a5565b9350505b80611516816124a5565b9150506114b1565b5081876005015461152f9190612331565b61153c90620f4240612331565b6001600160a01b038716600081815260098b0160205260408082209390935560118b0180546001600160a01b03191683179055915190918b917fe2372b1231b038f66dbcf5151afa5286deed439d6ee45c748f06e5a5ccd612709190a36105548960036116fa565b60006115ae610e3f565b600083815260209182526040808220600181018054835181870281018701909452808452919550929391929183018282801561161357602002820191906000526020600020905b81546001600160a01b031681526001909101906020018083116115f5575b505083519394506000925050505b818110156105595783600801600084838151811061164157611641612348565b6020908102919091018101516001600160a01b031682528101919091526040016000205460ff1680156116b0575083600701600084838151811061168757611687612348565b6020908102919091018101516001600160a01b031682528101919091526040016000205460ff16155b156116f2576116f2858483815181106116cb576116cb612348565b60200260200101518584815181106116e5576116e5612348565b6020026020010151611cfc565b600101611621565b6000611704610e3f565b600084815260209190915260409020905060048154610100900460ff16600481111561173257611732612211565b0361176d5760405162461bcd60e51b815260206004820152600b60248201526a119d5b990818db1bdcd95960aa1b6044820152606401610267565b80548290829061ff00191661010083600481111561178d5761178d612211565b02179055508160048111156117a4576117a4612211565b60405184907fecc339a9dbd454a10bb48d74b40c6ef6e3b22dfc541fc7c16d6114e5763a562890600090a3505050565b60006117e9836001600160a01b038416611e28565b9392505050565b60006117e9836001600160a01b038416611e77565b6001600160a01b038116600090815260018301602052604081205415156117e9565b6000611831610e3f565b600084815260209190915260408120915061184f600a8301846117f0565b9050806118665761186382600c01846117f0565b90505b806118ac5760405162461bcd60e51b815260206004820152601660248201527521b0b713ba103932b6b7bb32903232b330bab63a32b960511b6044820152606401610267565b6118b982600e01846117d4565b506040516001600160a01b0384169085907f59e9bf20dffb9054810c87236063cd66c8aacdecf2167a76c2fc486deb92c72290600090a350505050565b6000611900610e3f565b60008381526020919091526040902042600382015590506119228260046116fa565b6040516339007b7760e01b81526004810183905230906339007b7790602401600060405180830381600087803b15801561195b57600080fd5b505af1158015610b3f573d6000803e3d6000fd5b6000611979610e3f565b6000838152602091825260408082206000805160206124ec8339815191529093529020600282015460048084015490830154939450919290916119bb91612331565b6119c5919061230b565b4211611a135760405162461bcd60e51b815260206004820152601c60248201527f546f6f206561726c7920746f207374617274206e6577206379636c65000000006044820152606401610267565b60008254610100900460ff166004811115611a3057611a30612211565b1480611a56575060038254610100900460ff166004811115611a5457611a54612211565b145b611a725760405162461bcd60e51b8152600401610267906122a5565b8160040160008154611a83906124a5565b90915550600182015460005b81811015611af0576000846007016000866001018481548110611ab457611ab4612348565b6000918252602080832091909101546001600160a01b031683528201929092526040019020805460ff1916911515919091179055600101611a8f565b50611afc8460016116fa565b610890846115a4565b6000610d9b825490565b606060006117e983611f6a565b60008281527f35fa70a6f9ae8a4d427ebe0c1be62ffd2870fecc1df41c6fda0bf5803e5628886020526040812090611b52610e3f565b6000858152602091825260408082206000805160206124ec83398151915284528183206001600160a01b03881684526005820190945291205490925060ff168015611ba55750611ba582600e01856117f0565b611be75760405162461bcd60e51b8152602060048201526013602482015272115e1c195b1b185b9d081b9bdd08199bdd5b99606a1b6044820152606401610267565b611bf18585611fc6565b6001600160a01b0384166000818152600584016020526040808220805460ff191690555187917fffaffc51da9546c32f4d0ddf1c944d8ca87b053b905bb2b694978874b620858391a36001600160a01b038416600090815260068301602052604090205460ff16611c7457601282018054906000611c6e836124be565b91905055505b600060018260030154611c87919061231e565b600383018190556001600160a01b03861660009081526004860160205260408120805460ff1916905560108501805492935091611cc3906124a5565b90915550604051819087907fe817db35ffcfd7ab4de59cd38a99d674f761815667cbc3241bebf20e7da1b6e890600090a3505050505050565b6000611d06610e3f565b6000858152602091825260408082206000805160206124ec8339815191529093528120600581015492935091611d3f90620f4240612331565b83546040516323b872dd60e01b81526001600160a01b0388811660048301523060248301526044820184905292935062010000909104909116906323b872dd906064016020604051808303816000875af1925050508015611dbd575060408051601f3d908101601f19168201909252611dba9181019061228a565b60015b15610b3f578015611e1f576001600160a01b0385166000818152600786016020526040808220805460ff19166001179055600487015490519092918a917fe1122b3cea22012386ebf236fc23dd8a783b91c046d5dec812901846464624ae9190a45b50505050505050565b6000818152600183016020526040812054611e6f57508154600181810184556000848152602080822090930184905584548482528286019093526040902091909155610d9b565b506000610d9b565b60008181526001830160205260408120548015611f60576000611e9b60018361231e565b8554909150600090611eaf9060019061231e565b9050818114611f14576000866000018281548110611ecf57611ecf612348565b9060005260206000200154905080876000018481548110611ef257611ef2612348565b6000918252602080832090910192909255918252600188019052604090208390555b8554869080611f2557611f256124d5565b600190038181906000526020600020016000905590558560010160008681526020019081526020016000206000905560019350505050610d9b565b6000915050610d9b565b606081600001805480602002602001604051908101604052809291908181526020018280548015611fba57602002820191906000526020600020905b815481526020019060010190808311611fa6575b50505050509050919050565b6000611fd0610e3f565b600084815260209182526040808220600181018054835181870281018701909452808452919550929391929183018282801561203557602002820191906000526020600020905b81546001600160a01b03168152600190910190602001808311612017575b505083519394506000925061204f9150600190508361231e565b67ffffffffffffffff811115612067576120676123bf565b604051908082528060200260200182016040528015612090578160200160208202803683370190505b5090506000805b838110156121195760008582815181106120b3576120b3612348565b60200260200101519050876001600160a01b0316816001600160a01b03161461211057808484815181106120e9576120e9612348565b60200260200101906001600160a01b031690816001600160a01b0316815250508260010192505b50600101612097565b50815161212f9060018701906020850190612139565b5050505050505050565b82805482825590600052602060002090810192821561218e579160200282015b8281111561218e57825182546001600160a01b0319166001600160a01b03909116178255602090920191600190910190612159565b5061219a92915061219e565b5090565b5b8082111561219a576000815560010161219f565b6000602082840312156121c557600080fd5b5035919050565b6001600160a01b038116811461107d57600080fd5b600080604083850312156121f457600080fd5b823591506020830135612206816121cc565b809150509250929050565b634e487b7160e01b600052602160045260246000fd5b8051801515811461223757600080fd5b919050565b60008060006060848603121561225157600080fd5b61225a84612227565b925060208401519150604084015190509250925092565b60006020828403121561228357600080fd5b5051919050565b60006020828403121561229c57600080fd5b6117e982612227565b6020808252600b908201526a57726f6e6720737461746560a81b604082015260600190565b602080825260119082015270139bdd0818481c185c9d1a58da5c185b9d607a1b604082015260600190565b634e487b7160e01b600052601160045260246000fd5b80820180821115610d9b57610d9b6122f5565b81810381811115610d9b57610d9b6122f5565b8082028115828204841417610d9b57610d9b6122f5565b634e487b7160e01b600052603260045260246000fd5b600060608201858352602060018060a01b038087168286015260606040860152828651808552608087019150838801945060005b818110156123b0578551841683529484019491840191600101612392565b50909998505050505050505050565b634e487b7160e01b600052604160045260246000fd5b8051612237816121cc565b600060208083850312156123f357600080fd5b825167ffffffffffffffff8082111561240b57600080fd5b818501915085601f83011261241f57600080fd5b815181811115612431576124316123bf565b8060051b604051601f19603f83011681018181108582111715612456576124566123bf565b60405291825284820192508381018501918883111561247457600080fd5b938501935b828510156124995761248a856123d5565b84529385019392850192612479565b98975050505050505050565b6000600182016124b7576124b76122f5565b5060010190565b6000816124cd576124cd6122f5565b506000190190565b634e487b7160e01b600052603160045260246000fdfe87101b21d556417ad2b8e8f2700dbad90721d5d50a1f435f2dee0b9dc981ac8aa26469706673582212207bed54c2fc9094712b4c86e9f31696c36ac8fdd270abcd87a35741beee1ded1764736f6c63430008120033",
  "devdoc": {
    "author": "Mohammed Haddouti",
    "details": "v3.0 (Diamond)",
    "errors": {
      "InsufficientBalance(uint256,uint256)": [
        {
          "params": {
            "available": "balance available.",
            "required": "requested amount to transfer."
          }
        }
      ]
    },
    "kind": "dev",
    "methods": {
      "closeFund(uint256)": {
        "params": {
          "id": "the id of the term"
        }
      },
      "closeFundingPeriod(uint256)": {
        "params": {
          "id": "the id of the term"
        }
      },
      "emptyFundAfterEnd(uint256)": {
        "params": {
          "id": "the id of the term"
        }
      },
      "initFund(uint256)": {
        "params": {
          "termId": "the id of the term"
        }
      },
      "isBeneficiary(uint256,address)": {
        "params": {
          "beneficiary": "the address of the participant to check",
          "id": "the id of the term"
        },
        "returns": {
          "_0": "true if the participant is a beneficiary"
        }
      },
      "payContribution(uint256)": {
        "params": {
          "id": "the id of the term"
        }
      },
      "payContributionOnBehalfOf(uint256,address)": {
        "params": {
          "id": "the id of the term",
          "participant": "the address the msg.sender is paying for, the address must be part of the fund"
        }
      },
      "selectBeneficiary(uint256)": {
        "details": "This shouldn't happen, but is here in case there's an edge-case we didn't take into account, can possibly be removed in the future",
        "params": {
          "id": "the id of the term"
        }
      },
      "startNewCycle(uint256)": {
        "params": {
          "id": "the id of the term"
        }
      },
      "toggleAutoPay(uint256)": {
        "params": {
          "id": "the id of the term"
        }
      },
      "withdrawFund(uint256)": {
        "details": "This follows the pull-over-push pattern.",
        "params": {
          "id": "the id of the term"
        }
      }
    },
    "title": "Takaturn Fund",
    "version": 1
  },
  "userdoc": {
    "errors": {
      "InsufficientBalance(uint256,uint256)": [
        {
          "notice": "Insufficient balance for transfer. Needed `required` but only `available` available."
        }
      ]
    },
    "kind": "user",
    "methods": {
      "closeFund(uint256)": {
        "notice": "called by the owner to close the fund for emergency reasons."
      },
      "closeFundingPeriod(uint256)": {
        "notice": "Must be called at the end of the contribution period after the time has passed by the owner"
      },
      "emptyFundAfterEnd(uint256)": {
        "notice": "allow the owner to empty the fund if there's any excess fund left after 180 days,         this with the assumption that beneficiaries can't claim it themselves due to losing their keys for example,         and prevent the fund to be stuck in limbo"
      },
      "initFund(uint256)": {
        "notice": "called by the term to init the fund"
      },
      "payContribution(uint256)": {
        "notice": "This is the function participants call to pay the contribution"
      },
      "payContributionOnBehalfOf(uint256,address)": {
        "notice": "This function is here to give the possibility to pay using a different wallet"
      },
      "selectBeneficiary(uint256)": {
        "notice": "Fallback function, if the internal call fails somehow and the state gets stuck, allow owner to call the function again manually"
      },
      "startNewCycle(uint256)": {
        "notice": "starts a new cycle manually called by the owner. Only the first cycle starts automatically upon deploy"
      },
      "toggleAutoPay(uint256)": {
        "notice": "function to enable/disable autopay"
      },
      "withdrawFund(uint256)": {
        "notice": "Called by the beneficiary to withdraw the fund"
      }
    },
    "notice": "This is used to operate the Takaturn fund",
    "version": 1
  },
  "storageLayout": {
    "storage": [],
    "types": null
  }
}